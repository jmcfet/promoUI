var Library=(function(q){var l=new q.apps.core.Log("Library","Library"),f={},K={},s=null,P=null,N=null,H=null,j=null,O=null,u=30000,g=5000,w=false,r={getTitle:function(V){return Library.getString(V.name);},dataUpdate:function(V,W){V.data=W;}},o=null,Q=function(V){},G=[],S=null,v=q.platform.btv.PVRManager,t=function(){},M=function(){},B=function(){},J=null;function a(){if(o){clearInterval(o);o=null;}}function z(W,V){a();o=setInterval(W,V);}function m(){q.app.PVRUtil.updateHDDProgress(f.hardDriveSpace);}function b(){m();z(m,q.app.constants.MINUTE_IN_MS);}function T(V){if(q.app.PVRCapability.isPVREnabled(true)){b();}else{q.app.ContextHelper.closeContext();}}function D(Y){var aa=Y.title,Z=q.apps.util.Util.formatDate(new Date(Y.startTime),"dd/mm"),X=q.app.epgUtil.getChannelLogoUrl(Y.serviceId),W=q.app.PVRUtil.getVideoConfig(aa,Library.getString("pvr"),0,Z,X,Y),V;W.dontRestartStream=false;W.clearBookmark=Y.clearBookmark||false;W.atEndOfPlayBack=false;W.playingEvent=Y;W.failureCallback=function(ac){var ab;if(!q.platform.btv.PVRManager.isLocalRecording(Y)&&ac.contentErrorInfo){ab=q.platform.btv.PVRManager.getTVName(Y);q.app.DialogueHelper.showWHPVRPlaybackErrorDialogue(ab);}q.app.ContextHelper.closeContext();};if(!q.platform.btv.PVRManager.isLocalRecording(Y)&&W.url.length<"dlna:".length){V=q.platform.btv.PVRManager.getTVName(Y);q.app.DialogueHelper.showWHPVRPlaybackErrorDialogue(V);}else{q.app.ContextHelper.openContext("MEDIAPLAYER",{activationContext:W});}}function p(){if(s){if(s.passivate){s.passivate(true);}s=K.menuState;s.focus();}}function d(Y,W,X){var ab=j,ac,Z,aa,V=P.getSelectedItemIndex();ac=ab[Y].data;aa=ac.length;for(Z=0;Z<aa;Z++){if(ac[Z].eventId===W.eventId){ac.splice(Z,1);break;}}P.setData(ab);P.selectItemAtIndex(V);if(ac.length===0&&!X){p();}m();}function c(){var V=P.getSelectedItemIndex();P.setData(j);P.selectItemAtIndex(V);b();}function h(){return f.settingsPanelWindow.settingsPanelTitle;}function A(V){f.settingsPanelWindow.settingsPanelTitle.setText(q.app.StringUtil.upcaseFirstLetter(V));}function R(V){f.recordingsWindow.hide();f.settingsPanelWindow.show();A(Library.getString(V.name));J.preview(J.getSettingsShortcutObject("menuRecorderPreferences"));}function i(V){f.settingsPanelWindow.hide();f.recordingsWindow.show();if(V.data){c();K.recordingsWindow.preview(P.getSelectedItem());}else{if(V.itemHighlighted){V.itemHighlighted(V);}else{K.recordingsWindow.unPreview();}}}function I(){P.getDataMapper().dataUpdate(P.getData()[0],q.app.FolderUtil.getDataForFolders());P.getDataMapper().dataUpdate(P.getData()[1],q.app.PVRUtil.getScheduledRecordings());K.recordingsWindow.dataUpdate();}function e(){if(s===K.menuState){s.defocus();s=J;}else{if(s===J){s=K.menuState;s.focus();}}}function U(V){if(!f.settingsPanelWindow.isVisible()){R(V);}if(J.activate(J.getSettingsShortcutObject("menuRecorderPreferences"),null)){e();}}function y(V){var W=null;if(V.data&&V.data.length){if(s===K.menuState){N=V;s.defocus();s=K.recordingsWindow;s.activate(V);}}else{if(V.navigationContext){W={navCompleteCallback:I};if(V.navigationContextActivationObj){W.activationContext=V.navigationContextActivationObj;}K.recordingsWindow.unPreview();q.app.ContextHelper.openContext(V.navigationContext,W);}else{if(V.itemSelected&&s===K.menuState){V.itemSelected(V);}}}}function E(){var V=6;P=f.menu;P.setDataMapper(r);P.setItemHighlightedCallback(i);P.setItemSelectedCallback(y);P.setVisibleItemCount(V);P.initialise();f.hardDriveSpace.progressBar.initialise(0,100);m();}function k(){if(G.length===0){G=q.app.PVRCapability.subscribeToPVRCapabilityEvent(T,T,Library);}}function n(){G=q.app.PVRCapability.unSubscribeFromPVRCapabilityEvent(G);}function x(V){S=V;}function L(V){var W;if(q.app.StringUtil.isStringInArray(V,["deleteContentOK","deleteContentFailed","updateEntryOK"])){q.app.PVRUtil.incrementTasksCallbacksFired();}if(S){S(V);W=q.app.PVRUtil.getDataUpdateState()===q.app.PVRUtil.DATA_UPDATE_STATE.NOT_ALLOWED;if(V==="updateEntryOK"&&W){B();}}}function C(){v.addEventListener("updateEntryOK",L);v.addEventListener("deleteContentOK",L);v.addEventListener("onTasksChanged",L);v.addEventListener("onTasksModified",L);v.addEventListener("updateTaskOK",L);v.addEventListener("updateTaskFailed",L);v.addEventListener("onTaskStarted",I);v.addEventListener("onTaskStopped",I);v.addEventListener("stopTaskOK",L);v.addEventListener("stopTaskFailed",L);v.addEventListener("deleteJobOK",L);v.addEventListener("deleteJobFailed",L);}function F(){v.removeEventListener("updateEntryOK",L);v.removeEventListener("deleteContentOK",L);v.removeEventListener("onTasksChanged",L);v.removeEventListener("onTasksModified",L);v.removeEventListener("updateTaskOK",L);v.removeEventListener("updateTaskFailed",L);v.removeEventListener("onTaskStarted",I);v.removeEventListener("onTaskStopped",I);v.removeEventListener("stopTaskOK",L);v.removeEventListener("stopTaskFailed",L);v.removeEventListener("deleteJobOK",L);v.removeEventListener("deleteJobFailed",L);}B=function(){if(O){clearTimeout(O);}O=setTimeout(function(){w=true;M();},u);};t=function(V){l("showWarning","Enter - warningMessage:"+Library.getString(V));var W=f.warningMessage;W.setMessage(Library.getString(V));W.show();W.setBlockUI(true);B();};M=function(){var V=10000,W=f.warningMessage;if(O){clearTimeout(O);}W.hide();W.setBlockUI(false);if(w){w=false;setTimeout(function(){c();},V);}};return{load:function(){q.gui.ResolutionManager.initialiseContext(document);q.apps.core.Language.importLanguageBundleForObject(Library,Library.init,"apps/library/common/","LanguageBundle.js",null,window);},init:function(){q.gui.FrameworkCore.loadGUIFromXML("apps/library/view/library.xml",document.getElementById("content"),f,window);var V=new LibraryWindow(Library,f.recordingsWindow);J=new q.gui.SettingsPanel(Library,f.settingsPanelWindow.settingsPanel,document.getElementById("content"));E();K={menuState:P,recordingsWindow:V};K.recordingsWindow.initialise();q.apps.core.ContextManager.initialisationComplete(Library);},activate:function(V){j=[{name:"recordedRecordings",data:q.app.FolderUtil.getDataForFolders(),noRecordsLabel:Library.getString("noRecordings"),action:D},{name:"scheduledRecordings",data:q.app.PVRUtil.getScheduledRecordings(),noRecordsLabel:Library.getString("noScheduled"),action:Q},{name:"record",data:null,noRecordsLabel:"",navigationContext:"LISTGUIDE",action:Q},{name:"recordTimeBased",data:q.app.ManualRecordingOptionHelper.getManualRecordingsDummyData(),noRecordsLabel:Library.getString("noScheduled"),action:Q},{name:"recordingsPreferences",data:null,noRecordsLabel:"",itemHighlighted:R,itemSelected:U,action:Q},{name:"search",data:null,noRecordsLabel:"",navigationContext:"SEARCH",action:Q,navigationContextActivationObj:{confirmLeftExit:true}}];K.recordingsWindow.unPreview();s=K.menuState;P.setData(j);P.displayData();P.focus();q.app.BrandHelper.show(q.app.BrandHelper.AGORA_BACKGROUND_ID);q.app.ClockDisplay.show();b();k();q.app.PVRCapability.subscribeWHPvrDeviceUpdate(T);C();},passivate:function(V){q.app.BrandHelper.hideAll();q.app.ClockDisplay.hide();if(s===J){J.passivate(true);}s=null;K.recordingsWindow.unPreview();if(H){clearTimeout(H);}n();q.app.PVRCapability.unSubscribeWHPvrDeviceUpdate(T);a();q.app.TimerUtil.stopTimer("recordIcon");q.app.TimerUtil.stopTimer("ManualRecordingMenuHelperClock");F();},focus:function(){if(q.app.PVRCapability.isPVREnabled(true)){q.app.BrandHelper.show(q.app.BrandHelper.AGORA_BACKGROUND_ID);q.app.ClockDisplay.show();b();k();f.recordingsWindow.manualRecordingOptionsList.manualRecordingOptions.registerJobCallbacks();}else{q.app.ContextHelper.closeContext();}},defocus:function(){a();q.app.ClockDisplay.hide();q.app.BrandHelper.hideAll();n();f.recordingsWindow.manualRecordingOptionsList.manualRecordingOptions.unregisterJobCallbacks();},toString:function(){return"LIBRARY";},keyHandler:function(W,V){var X=q.apps.core.KeyInterceptor.getKeyMap(),Y=false;q.app.MemoryUtil.setOrUpdateGarbageCollectTimeoutAndInterval();if(s){Y=s.keyHandler(W,V);}if(!Y){switch(W){case X.KEY_LEFT:q.app.ContextHelper.closeContext();Y=true;break;}}return Y;},isWarningVisible:function(){return f.warningMessage.isVisible();},setHideWarningTimeoutRequired:function(V){w=V;},showWarning:t,hideWarning:M,stopIntervalService:a,restartWarningMessageTimeout:B,itemSelected:y,returnToMenu:p,updateHardDiskUsageCallback:m,PVRStatusUpdateListener:T,setUpdateTaskListenerCallback:x,updateRecordingsData:I,startUpdateHardDiskPercentageInterval:b,switchActiveComponent:e,getSettingsPanelTitle:h,setSettingsPanelTitle:A};}(window.parent.$N));var LibraryWindow=function(B,ap){var ao=window.parent.$N,e=new ao.apps.core.Log("Library","LibraryWindow"),ac=ao.app.DateTimeUtil,ar=ao.platform.btv.PVRManager,E=ao.app.constants,ae=ao.app.PVRUtil,U=1,aa=U,r=ao.app.ManualRecordingOptionHelper,aO,k=false,aJ=null,o=false,aE="",aw=true,P=true,b=false,K=false,ak=false,al=false,aq=false,aA=null,t,aN={recordingsMenu:ap.recordingsList.recordingsMenu,scheduledMenu:ap.recordingsList.scheduledMenu},s=null,am=null,D=false,L=null,v=[],f=false,H={getIcon:function(aR){var aS=ao.app.FolderUtil.isInFolder(aR),aP=null,aQ=null,aT=aR&&aR.isAuthorized;if(aS&&!aE){return"../../../customise/resources/images/720p/icons/DVR_pasta_menor.png";}aP=ao.app.epgUtil.getServiceById(aR.serviceId);b=ao.app.ParentalControlUtil.isChannelLocked(aP);K=ao.app.ParentalControlUtil.isProgramLocked(aR);ak=ae.isTaskBlocked(aR);if(b||K||ak){if(aT){return"../../../customise/resources/images/720p/icons/DVR_controle_parental_sml.png";}else{return"../../../customise/resources/images/720p/icons/DVR_controle_parental_sml_grey.png";}}if(ar.isRecordingProtected(aR)){if(aT){return"../../../customise/resources/images/720p/icons/DVR_cadeado_item_protegido.png";}else{return"../../../customise/resources/images/720p/icons/DVR_cadeado_item_protegido_grey.png";}}return null;},getNovoIcon:function(aP){var aR,aQ=aP&&aP.isAuthorized;if(!ae.isTaskPlayed(aP)){aR=ao.platform.system.Preferences.get(ao.app.constants.PREF_LANGUAGE);if(aQ){return"../../../customise/resources/images/net/DVR_label_new_"+aR+".png";}else{return"../../../customise/resources/images/net/DVR_label_new_"+aR+"_grey.png";}}return"";},getEventId:function(aP){return(aP&&aP.eventId)?aP.eventId:null;},getUniqueEventId:function(aP){return(aP)?aP.uniqueEventId||null:null;},getSeriesEpisodeTitle:function(aR){var aQ=aR.title,aP=aR.netEpisodeName||aR.netEpisodeOriginalName||"";if(aQ&&aP&&aQ!==aP){return aQ+": "+aP;}return aQ||"";},getSeriesTitle:function(aP){return aP?aP.title:"";},getRecordDate:function(aP){return ao.apps.util.Util.formatDate(new Date(aP.startTime),"dd/mm");},getRecordTime:function(aP){return ao.apps.util.Util.formatTime(new Date(aP.startTime),"HH:MM");},getSeasonEpisodeShort:function(aP){return ao.app.PVRUtil.getRecordedSeasonEpisodeShort(aP);},getFolderName:function(aP){return aP?ao.app.FolderUtil.getFolderName(aP):"";},isFolderUserGenerated:function(aP){var aQ=ao.app.FolderUtil.getFolderName(aP);return ao.app.FolderUtil.isFolderUserGenerated(aQ);},isFolder:function(aP){var aQ=ao.app.FolderUtil.getFolderName(aP);return aQ&&!aE;},getEventTitle:function(aP){var aQ=ao.app.FolderUtil.getFolderName(aP);if((aQ&&!aE)&&(t===aN.recordingsMenu)){return aQ;}if(aP.netDisplaySeasonEpisode){return this.getSeriesEpisodeTitle(aP)+" "+this.getSeasonEpisodeShort(aP);}else{return this.getSeriesEpisodeTitle(aP);}},getDisplaySeasonEpisode:function(aP){return aP.netDisplaySeasonEpisode;},getTitle:function(aS){var aV=ao.app.FolderUtil.getFolderName(aS),aU="",aW=(aS.recordingType===ao.data.Recording.RECORDING_TYPE.SERIES),aQ=aS.netEpisodeName,aP=aS.netEpisodeOriginalName,aT=this.getSeasonEpisodeShort(aS),aR=aS.netDisplaySeasonEpisode;if(aV&&!aE){return aV;}if(aW){if(aR){aU=aT+" ";}if(aQ||aP){if(aP&&!aQ){aU+=aP;}else{aU+=aQ;}}else{aU=this.getSeriesTitle(aS);if(aR){aU+=" "+aT;}}return aU;}if(aR){return this.getSeriesTitle(aS)+" "+aT;}else{return this.getSeriesTitle(aS);}},getSortTitle:function(aS){var aV=ao.app.FolderUtil.getFolderName(aS),aU="",aW=(aS.recordingType===ao.data.Recording.RECORDING_TYPE.SERIES),aQ=aS.netEpisodeName,aP=aS.netEpisodeOriginalName,aT=this.getSeasonEpisodeShort(aS),aR=aS.netDisplaySeasonEpisode;if(aV&&!aE){return aV;}if(aW){if(aQ||aP){if(aP&&!aQ){aU+=aP;}else{aU+=aQ;}}else{aU=this.getSeriesTitle(aS);if(aR){aU+=" "+aT;}}return aU;}return this.getSeriesTitle(aS);},getNumberOfEpisodes:function(aP){var aQ=ao.app.FolderUtil.getFolderName(aP);if(aQ&&!aE){return"("+ao.app.FolderUtil.getNumberOfEpisodes(aQ)+")";}},getKeepState:function(aP){return ao.app.KeepUtil.getKeepState(aP);},getAuthorizationStatus:function(aP){var aQ=ao.app.FolderUtil.isInFolder(aP);if(aQ&&!aE){return true;}if(aP&&aP.isAuthorized){return true;}return false;}};function aF(){return(t===aN.scheduledMenu);}function ah(){return(t===aN.recordingsMenu);}function ab(){return(am.name==="recordTimeBased");}function Q(){t.displayData(true,true);t.show();t.focus();}function l(aP){if(!ao.app.PVRCapability.isPVREnabled(true)){B.returnToMenu();}}function w(aT){var aP=1,aS=this,aU=2,aR=[{name:B.getString("resumeRecordingDialogueWatch"),action:aP},{name:B.getString("resumeRecordingDialogueRestart"),action:aU}],aV=function(aW){if(aW&&(aW.action===aU||aW.action===aP)){if(aW.action===aU){ar.saveBookmark(aT,0,0);aT.clearBookmark=true;}am.action(aT);}},aQ=new ao.apps.dialog.ConfirmationDialogue("ResumeRecordingDialog",H.getSeriesTitle(aT)+" "+H.getSeasonEpisodeShort(aT),B.getString("resumeRecordingDialogueSubTitle"),aR,aV,null,null,"VERTICAL");aQ.customise({defaultButton:aP});ao.app.DialogueHelper.displayDialogue(aQ,ao.app.DialogueHelper.LIBRARY_RESUME_RECORDING);}function aD(aQ,aP){if(isNaN(parseInt(aP,10))&&aP!==ao.apps.core.KeyInterceptor.getKeyMap().KEY_LEFT&&aP!==ao.apps.core.KeyInterceptor.getKeyMap().KEY_OK){if(L){L.hideDialog();}}}function aM(){ap.manualRecordingOptionsList.ManualRecordingOptions.passivate();aq=false;}function S(){var aT=r.manualRecordingChanneldata(),aQ=r.getManualRecordingsFolderOptionData(),aU=r.getManualRecordingsFrequencyOptionData(),aP=r.resetManualRecordingproperties(),aR=r.getAllManualRecordingProperties(),aS=[{title:B.getString("manualRecordingStartTime"),secondTitle:B.getString("manualRecordingStopTime"),getStartTime:function(){var aV=aR.startTime;return aV;},getStopTime:function(){var aV=aR.stopTime;return aV;},menuType:"timeKeypad",menuData:{title:B.getString("manualRecordingStartTime"),successCallback:function(aW){var aV=ap.manualRecordingOptionsList.ManualRecordingOptions.getActualSelectedItem();if(aW.startTime!==null){aV.setFirstSubTitle(aW.startTime);r.setManualRecordingProperty("startTime",aW.startTime);}if(aW.stopTime!==null){aV.setSecondSubTitle(aW.stopTime);r.setManualRecordingProperty("stopTime",aW.stopTime);}r.setManualRecordingProperty("isTimeOrDateModified",true);},exitCallback:aM}},{title:B.getString("manualRecordingDate"),getStartDate:function(){var aV=aR.date;return aV;},menuType:"dateKeyPad",menuData:{title:B.getString("manualRecordingDate"),successCallback:function(aW){var aV=ap.manualRecordingOptionsList.ManualRecordingOptions.getActualSelectedItem();if(aW.startRecordingDate!==null){aV.setFirstSubTitle(aW.startRecordingDate);r.setManualRecordingProperty("date",aW.startRecordingDate);}r.setManualRecordingProperty("isTimeOrDateModified",true);}}},{title:B.getString("manualRecordingFrequency"),subtitle:B.getString("manualRecordingFrequencyOnce"),menuType:"confirmation",menuData:{title:B.getString("manualRecordingFrequency"),options:aU,successCallback:function(aV){if(aV.value!==null){r.setManualRecordingProperty("frequency",aV.value);}}}},{title:B.getString("manualRecordingChannel"),subtitle:aR.channel,menuType:"confirmation",isUpDownPageable:true,menuData:{title:B.getString("manualRecordingChannelListTitle"),options:aT,successCallback:function(aV){if(aV.channelNumber!==null){r.setManualRecordingProperty("channel",aV.channelNumber+" "+aV.title);r.setManualRecordingProperty("channelInfo",aV);}}}},{title:B.getString("optionsFolderTitle"),subtitle:ao.app.FolderUtil.getString("pvrSettingsRecordingHighlights"),menuType:"folder",menuData:{title:B.getString("optionsMoveToFolder"),options:aQ,successCallback:function(aV){if(aV.value!==null){if(aV.value===""||aV.title===B.getString("pvrSettingsRecordingHighlights")||aV.value===ao.app.constants.LEGACY_DEFAULT_NON_EPISODIC_FOLDER_NAME){aV.value=ao.app.FolderUtil.getNonEpisodicDefaultFolder();}r.setManualRecordingProperty("folder",aV.value);}}}},{title:B.getString("optionsKeepTitle"),subtitle:ae.getString("pvrSpaceNeeded"),menuType:"confirmation",menuData:{title:B.getString("optionsKeepTitle"),options:[{title:ae.getString("pvrManualDelete"),value:E.KEEP_UNTIL_OPTION_MANUAL_DELETE,selected:false},{title:ae.getString("pvrSpaceNeeded"),value:E.KEEP_UNTIL_OPTION_SPACE_NEEDED,selected:true}],successCallback:function(aV){if(aV.value!==null){r.setManualRecordingProperty("keepUntill",aV.value);}}}}];return aS;}function n(){ap.manualRecordingOptionsList.ManualRecordingOptions.activate(S());aq=true;ap.show();}aA=function(){var aP=r.getManualRecordingProperty("isTimeOrDateModified"),aQ=ap.manualRecordingOptionsList.ManualRecordingOptions.isSubmenuActive();if(!aP&&!aQ){r.setManualRecordingProperty("startTime",r.manualRecordingStartTime());r.setManualRecordingProperty("StopTime",r.manualRecordingStopTime());r.setManualRecordingProperty("date",r.getValidDate());ap.manualRecordingOptionsList.ManualRecordingOptions.refreshMenuData(S());}};function C(aP){if(aw){if(am.name==="scheduledRecordings"||aE){aP.sort(ao.app.SortUtil.sortByDateAsc);}else{aP.sort(ao.app.SortUtil.sortByIsFolderThenDate);}}else{if(am.name==="scheduledRecordings"||aE){aP.sort(ao.app.SortUtil.sortBySortTitleThenEpisodeId);}else{aP.sort(ao.app.SortUtil.sortByFolderThenTitle);}}}function aH(){var aR=true,aQ=U,aP=t.getSize();if(!aE){if(aa>aP){aQ=aP;}else{aQ=aa;}t.selectItemAtIndex(aQ,aR);}}function z(aP){if(aP.length&&!aP[0].sortTitle){aP.forEach(function(aQ){aQ.sortTitle=H.getSortTitle(aQ);});}}function av(aQ){var aP=am.name;if(aP==="recordTimeBased"){ap.manualRecordingOptionsList.title.setText(B.getString("recordTimeBasedMenuTitle"));ap.manualRecordingOptionsList.ManualRecordingOptions.preview(S());}else{z(aQ);C(aQ);t.setData(aQ);ap.recordingsList.upArrow.hide();ap.recordingsList.downArrow.setVisible(aQ.length>t.getVisibleItemCount());if(aQ.length>0){t.displayData(true);aH();aO.hide();t.show();}else{t.hide();aO.setText(am.noRecordsLabel);aO.show();B.returnToMenu();}}if(aE){ap.recordingsList.title.setText(H.getFolderName(aQ[0]));}else{ap.recordingsList.title.setText(B.getString(aP+"Title"));}}function ad(){if(aE){am.data=ao.app.FolderUtil.getDataForFolders();aE="";av(am.data);t.focus();aa=U;}}function au(){var aP=t.getActualSelectedRowIndex(),aQ=t.getVisibleItemCount();if(am.name==="recordedRecordings"){if(aE){am.data=ao.app.FolderUtil.getPlayableRecordingsByFolderName(aE);}else{am.data=ao.app.FolderUtil.getDataForFolders();}}else{if(am.name==="scheduledRecordings"){am.data=ae.getScheduledRecordings();}else{if(am.name==="recordTimeBased"){B.updateRecordingsData();}}}if(aE&&am.data&&am.data.length===0){ad();}else{av(am.data);if(am.name!=="recordTimeBased"&&f===true){t.focus();if(aP>aQ){ap.recordingsList.upArrow.show();}if(aP&&aP<=am.data.length){t.selectActualItemAtIndex(aP);}}}}function ay(){var aP=250,aQ=null;au();aQ=ae.getDataUpdateState();if(aQ===ae.DATA_UPDATE_STATE.NOT_ALLOWED){B.restartWarningMessageTimeout();return;}else{if(aQ===ae.DATA_UPDATE_STATE.ALLOWED){window.setTimeout(function(){au();B.hideWarning();B.startUpdateHardDiskPercentageInterval();},aP);}else{B.hideWarning();B.startUpdateHardDiskPercentageInterval();}}}function A(){if(aJ){clearTimeout(aJ);aJ=null;}}function F(){var aP=1000;A();aJ=window.setTimeout(ay,aP);}function R(){if(L){L.hideDialog();}}function d(aR){var aP,aQ=false;if(ao.platform.btv.PVRManager.isLocalRecording(aR)){aP=ao.platform.btv.PVRManager.getTask(aR.taskId,ao.platform.btv.PVRManager.WIDE_TASK_FIELD_FILTER,aQ);}else{aP=aR;}if(aP&&aP.bookmark){w(aP);}else{am.action(aP);}}function Y(){if(!ab()){F();}}function aC(aP,aQ){if(aP){ap.recordingsList.upArrow.hide();}else{ap.recordingsList.upArrow.show();}if(aQ){ap.recordingsList.downArrow.hide();}else{ap.recordingsList.downArrow.show();}}function m(aP){am.data=ao.app.FolderUtil.getPlayableRecordingsByFolderName(aP);aE=aP;av(am.data);t.focus();}function q(aR,aP){var aS=ao.app.constants.DLG_ACTIONS,aQ=(aR&&aR.key&&aR.key.action)?aR.key.action:aS.EXIT_OPTION;if(aQ!==aS.EXIT_OPTION){B.stopIntervalService();B.showWarning(aP);}}function u(aQ){var aP=function(aR){q(aR,"cancellingSchedule");};if(ae.isTaskActiveOrScheduled(aQ)){ae.cancelTask(aQ,aP);}}function aI(aQ){var aU=ao.app.FolderUtil.isFolderRootFolder(aQ.uiFolder),aT=(H.isFolder(aQ)&&!aE&&!aU),aW=(aT)?ao.app.FolderUtil.getPlayableRecordingsByFolderName(aQ.uiFolder):[aQ],aP=(aT)?"deleteFolder":"deleteRecording",aV=(aT)?H.getFolderName(aQ):aQ.title,aS={dialogObjectConfigParam:{title:B.getString(aP),message:B.getString("messageDelete")+' "'+aV+'".'}},aR=function(aX){q(aX,"deleting");};ae.showDialogueAndDeleteTasks(aW,aR,aS);}function aj(aQ){var aP=ao.app.epgUtil.getMappedEventById(aQ.eventId);aQ.promoImage=(aP)?aP.promoImage:"";if(ae.isTaskBlockedSynopsis(aQ)){ao.app.ParentalControlUtil.parentalDialog(aQ,function(){ae.navigateToSynopsis(aQ,ay);},R,aD);}else{ae.navigateToSynopsis(aQ,ay);}}function a(aR){var aS=ao.app.FolderUtil.getFolderName(aR),aQ=[{name:B.getString("ok"),action:1}],aP=null;if(!aE&&aS&&ah()){aa=t.getSelectedItemIndex();m(aS);}else{if(aF()){if(t&&t.getSelectedItem()){aj(t.getSelectedItem());}}else{if(ab()){aq=true;}else{if(ar.getTaskAuthorizationStatus(aR)){if(!ao.app.ManualRecordingHelper.isManualRecordingTask(aR)&&(ae.isTaskBlockedPlaying(aR)||ae.isTaskBlocked(aR))){ao.app.ParentalControlUtil.parentalDialog(aR,d,R,aD);}else{d(aR);}}else{ao.app.DialogueHelper.createAndShowDialogue(ao.app.constants.DLG_UNAUTHORISED_RECORDING,B.getString("unauthorizedRecordingTitle"),B.getString("unauthorizedRecordingText"),aQ);}}}}}function aK(aP){am=aP;ao.app.TimerUtil.stopTimer("recordIcon");if(am.name==="recordedRecordings"){aM();ap.manualRecordingOptionsList.hide();ap.recordingsList.show();ao.app.StandardTimers.minuteTimer.disable("ManualRecordingMenuHelperClock");t.hide();t=aN.recordingsMenu;t.show();}else{if(am.name==="scheduledRecordings"){aM();ap.manualRecordingOptionsList.hide();ap.recordingsList.show();ao.app.StandardTimers.minuteTimer.disable("ManualRecordingMenuHelperClock");t.hide();t=aN.scheduledMenu;t.show();ao.app.TimerUtil.startTimer("recordIcon");}else{if(am.name==="recordTimeBased"){ap.manualRecordingOptionsList.show();ap.recordingsList.hide();ao.app.StandardTimers.minuteTimer.enable("ManualRecordingMenuHelperClock");t.hide();}}}}function ax(aP){ao.app.GeneralUtil.mixin(H,ao.app.DataMappers.getServiceDataMapper());aP.setDataMapper(H);aP.setItemSelectedCallback(a);aP.setListPagedCallback(aC);aP.setUpDownPageable(true);aP.initialise();}function V(){return aw?B.getString("titleSort"):B.getString("dateSort");}function G(){return am.name==="scheduledRecordings"?B.getString("cancel"):B.getString("remove");}function ai(aP){if(am.name==="scheduledRecordings"){return B.getString("optionsCancelTitle");}if(aP){return B.getString("optionsDeleteFolderTitle");}return B.getString("optionsDeleteTitle");}function c(aP){if(am.name==="scheduledRecordings"){return B.getString("optionsCancelSubMenuTitle");}if(aP){return B.getString("optionsDeleteSubMenuFolderTitle");}return B.getString("optionsDeleteSubMenuTitle");}function I(){var aP=ap.recordingsOptionsFooter;aP.redSelectLabel.setText(B.getString("info"));aP.greenSelectLabel.setText(V());aP.yellowSelectLabel.setText(G());aP.blueSelectLabel.setText(B.getString("options"));}function j(){var aP=ap.recordingsOptionsFooter;aP.hide();if(aF()||ah()){aP.redKey.setX(22.5);aP.redSelectLabel.setX(76.5);aP.yellowKey.setX(763.5);aP.yellowSelectLabel.setX(817.5);aP.blueKey.setX(1168.5);aP.blueSelectLabel.setX(1222.5);aP.greenKey.show();aP.greenSelectLabel.show();}aP.show();}function T(){ap.recordingsOptionsFooter.hide();}function X(aP){if(aP){m(aP);}ap.libraryOptions.passivate();ap.recordingsList.show();j();k=false;}function aB(){Q();X();ay();al=false;if(ao.app.PVRUtil.getDataUpdateState()===ao.app.PVRUtil.DATA_UPDATE_STATE.ALLOWED){B.hideWarning();}}function aG(aP){if(aP==="stopTaskFailed"||aP==="deleteJobFailed"){B.setHideWarningTimeoutRequired(true);}if(al){aB();}else{F();}}function aL(aP){var aS=ao.app.constants.ACTIVE_INFO_BUTTON_PATH,aR=ao.app.constants.INACTIVE_INFO_BUTTON_PATH,aT=ap.recordingsOptionsFooter,aQ=aP?aS:aR;aT.redKey.setHref(aQ);}function O(aT){var aR=B.getString("none"),aW=B.getString("pinLock"),aQ=ae.isTaskBlocked(aT),aV=aQ?aW:aR,aU=1,aS=2,aP=ap.libraryOptions.getActualSelectedItem();return{title:B.getString("optionsBlockTitle"),subtitle:aV,menuType:"confirmation",menuData:{title:B.getString("optionsBlockSubMenuTitle"),options:[{title:aR,value:aU,selected:!aQ},{title:aW,value:aS,selected:aQ}],successCallback:function(aZ){aQ=ae.isTaskBlocked(aT);var aX=(aZ===aS&&!aQ),a0=(aZ===aU&&aQ),aY=function(){if(!aE&&!ao.app.FolderUtil.isFolderRootFolder(aT.uiFolder)){ao.app.FolderUtil.updateBlockedStateForFolder(aT.uiFolder,!aQ);}else{ae.updateBlockedState(aT.taskId,!aQ);}aP.setFirstSubTitle(aX?aW:aR);ap.libraryOptions.subMenuExit();Q();};if(aX||a0){aP.setFirstSubTitle(aV);ao.app.ParentalControlUtil.parentalDialog(aT,aY,R,aD,aX);}else{ap.libraryOptions.subMenuExit();Q();}}}};}function h(aR){var aQ=!aE&&!ao.app.FolderUtil.isFolderRootFolder(aR.uiFolder),aP=H.getKeepState(aR),aS=ao.app.KeepUtil.KEEP_UNTIL_MANUAL_DELETE===aP;return{title:B.getString("optionsKeepTitle"),subtitle:aS?ae.getString("pvrManualDelete"):ae.getString("pvrSpaceNeeded"),menuType:"confirmation",menuData:{title:B.getString("optionsKeepTitle"),options:[{title:ae.getString("pvrManualDelete"),value:"KEEP_UNTIL",selected:aS},{title:ae.getString("pvrSpaceNeeded"),value:"SPACE_NEEDED",selected:!aS}],successCallback:function(aU){var aT=aU==="KEEP_UNTIL"?ao.app.KeepUtil.KEEP_UNTIL_MANUAL_DELETE:ao.app.KeepUtil.KEEP_UNTIL_SPACE_NEEDED;if(aQ){ao.app.FolderUtil.updateKeepForFolder(aR.uiFolder,aT);}else{ae.updateRecordingByTask(aR,{keep:aT});}ap.libraryOptions.subMenuExit();Q();}}};}function ag(aQ){var aP=aF()?"optionsFolderTitle":"optionsRenameFolderTitle",aR=H.getFolderName(aQ);return{title:B.getString(aP),subtitle:aR,menuType:"keyboard",menuData:{title:B.getString("optionsRenameFolderSubTitle"),labelText:aR.toUpperCase(),greenIconText:B.getString("optionsRenameFolderTitle"),successCallback:function(aS){if(ao.app.FolderUtil.isFolderUserGenerated(aS)){ao.app.DialogueHelper.createAndShowDialogue(ao.app.constants.DLG_DVR_DUPLICATE_FOLDER_ERROR,B.getString("warningDialogueTypeLabel"),B.getString("warningDuplicateFolderName"));}else{al=true;ao.app.FolderUtil.renameFolder(aR,aS);B.showWarning("renameFolder");}},exitCallback:X}};}o=function(aS,aT){aT=aT||"";var aP,aR,aQ=[ao.app.constants.LEGACY_DEFAULT_NON_EPISODIC_FOLDER_NAME,""];if(aT.length&&!ao.app.FolderUtil.isFolderRootFolder(aT)){for(aP=0;aP<aS.length;aP++){aS[aP]=ao.app.StringUtil.addLeadingForwardSlash(aS[aP]);}aR=aS.indexOf(ao.app.StringUtil.addLeadingForwardSlash(aT));}else{for(aP=0;aP<aQ.length;aP++){aR=aS.indexOf(aQ[aP]);if(aR>-1){break;}}}return aR;};function J(aT){var aU=H.getFolderName(aT),aP=H.isFolder(aT),aS,aR=[],aQ;aR=ao.platform.system.Preferences.get(ao.app.constants.PVR_NON_EPISODIC_FOLDER_LIST);aS=o(aR,aU);aR=ao.app.FormatUtils.formatRecordingsFolderListData(aR,aU);if(ao.app.FolderUtil.isFolderRootFolder(aU)){aR[0].selected=true;}else{if(aS>-1){aR[aS].selected=true;}for(aQ=1;(aQ<(aR.length-1));aQ++){if(aU===aR[aQ].title&&!aR[aQ].selected){aR[aQ].selected=true;aR[aQ-1].selected=false;break;}}}aR=ao.app.FolderUtil.sortFolderList(aR);return{title:B.getString("optionsFolderTitle"),subtitle:aU||ao.app.FolderUtil.getString("pvrSettingsRecordingHighlights"),menuType:"folder",menuData:{title:B.getString("optionsMoveToFolder"),options:aR,successCallback:function(aV){ae.updateRecordingByTask(aT,{uiFolder:ao.app.StringUtil.addLeadingForwardSlash(aV)});ap.libraryOptions.subMenuExit();Q();am.data=ao.app.FolderUtil.getPlayableRecordingsByFolderName(aV);aE=aV;av(am.data);}}};}function y(aQ){var aP=t.getSelectedItem(),aR=(aQ)?ao.app.FolderUtil.getPlayableRecordingsByFolderName(aP.uiFolder):[aP];return{title:ai(aQ),subtitle:ae.isTaskBlockedTitle(aP)?ae.getString("adultContent"):H.getEventTitle(aP),menuType:"confirmation",menuData:{title:c(aQ),options:[{title:B.getString("yes"),value:true},{title:B.getString("no"),value:false}],successCallback:function(){if(aF()){B.showWarning("cancellingSchedule");ao.platform.btv.PVRManager.cancelRecordingByTask(aP);X();}else{X();B.stopIntervalService();B.showWarning("deleting");ae.deleteTasks(aR);}}}};}function an(){return{title:B.getString("paddingBeforeEpisodic"),secondTitle:B.getString("paddingAfterEpisodic"),getPaddingBefore:function(){var aP=t.getSelectedItem().softPrepaddingDuration/ao.app.constants.MINUTE_IN_MS;return(!isNaN(aP)?aP:0)+" "+ac.getMinutesString(aP);},getPaddingAfter:function(){var aP=t.getSelectedItem().softPostpaddingDuration/ao.app.constants.MINUTE_IN_MS;return(!isNaN(aP)?aP:0)+" "+ac.getMinutesString(aP);},menuType:"keypad",menuData:{title:B.getString("paddingBeforeEpisodic"),successCallback:function(aR){var aP=aN.scheduledMenu.getSelectedItem(),aQ=ap.libraryOptions.getActualSelectedItem();if(aR.paddingBefore!==null){aQ.setFirstSubTitle(parseInt(aR.paddingBefore,10)+" "+ac.getMinutesString(aR.paddingBefore));}if(aR.paddingAfter!==null){aQ.setSecondSubTitle(parseInt(aR.paddingAfter,10)+" "+ac.getMinutesString(aR.paddingAfter));}if(aR.paddingBefore!==null&&aR.paddingAfter!==null){ae.updateRecording(aP.taskId,{softPrepaddingDuration:ac.convertMinutesToMs(aR.paddingBefore),softPostpaddingDuration:ac.convertMinutesToMs(aR.paddingAfter)});}},exitCallback:X}};}function g(){var aS=t.getSelectedItem(),aQ=!aE&&!ao.app.FolderUtil.isFolderRootFolder(aS.uiFolder),aP=[y(aQ)],aT=(aS&&aS._data&&aS._data.scheduleType&&aS._data.scheduleType==="SERIES"),aV=ah()&&aQ&&!aT,aU=(aF()&&(aS.eventId!==null)),aR=!aT&&!aV;if(aV){aP.push(ag(aS));}if(aU){aP.push(an());}if(aR){aP.push(J(aS));}aP.push(h(aS));aP.push(O(aS));return aP;}function az(){T();ap.recordingsList.hide();ap.libraryOptions.activate(g());k=true;}function af(){if(v.length===0){v=ao.app.PVRCapability.subscribeToPVRCapabilityEvent(l,l,LibraryWindow);}}function x(){v=ao.app.PVRCapability.unSubscribeFromPVRCapabilityEvent(v);}function N(){aw=!aw;ap.recordingsOptionsFooter.greenSelectLabel.setText(V());av(t.getData());t.focus();}function at(){ax(aN.recordingsMenu);ax(aN.scheduledMenu);t=aN.recordingsMenu;aO=ap.recordingsList.noRecordingsLabel;ap.libraryOptions.setDataMapper({getFirstTitle:function(aP){return aP.title;},getFirstSubTitle:function(aP){if(aP.getPaddingBefore){return aP.getPaddingBefore();}return aP.subtitle;},getSecondTitle:function(aP){return aP.secondTitle;},getSecondSubTitle:function(aP){if(aP.getPaddingBefore){return aP.getPaddingAfter();}return aP.secondSubtitle;},getSubMenuType:function(aP){return aP.menuType;},getSubMenuData:function(aP){return aP.menuData;}});ap.libraryOptions.initialise();ap.manualRecordingOptionsList.ManualRecordingOptions.setDataMapper({getFirstTitle:function(aP){return aP.title;},getFirstSubTitle:function(aP){if(aP.getStartTime){return aP.getStartTime();}else{if(aP.getStartDate){return aP.getStartDate();}}return aP.subtitle;},getSecondTitle:function(aP){return aP.secondTitle;},getSecondSubTitle:function(aP){if(aP.getStopTime){return aP.getStopTime();}return aP.secondSubtitle;},getSubMenuType:function(aP){return aP.menuType;},getSubMenuData:function(aP){return aP.menuData;}});ap.manualRecordingOptionsList.ManualRecordingOptions.initialise();ao.app.StandardTimers.minuteTimer.register("ManualRecordingMenuHelperClock",aA);B.setUpdateTaskListenerCallback(aG);}function Z(aP){if(k){X();}if(am!==aP){aK(aP);av(am.data);}s=s||1;t.selectItemAtIndex(s,false);ap.show();D=true;ao.platform.ca.ParentalControl.setUserChangedCallback(Q);}function W(aP){if(!D||am!==aP){Z(aP);}if(am.name==="recordTimeBased"){n();}else{ap.recordingsList.background.setCssClass("recordingsWindowBackgroundActivated");t.focus();I();j();af();}ao.app.PVRCapability.subscribeWHPvrDeviceUpdate(l);f=true;}function i(aP){A();if(am&&am.name==="recordTimeBased"){ap.manualRecordingOptionsList.ManualRecordingOptions.preview(S());aq=false;}else{ap.recordingsList.background.setCssClass("recordingsWindowBackgroundPassivated");B.hideWarning();T();t.defocus();s=null;x();}if(!aP){D=false;ap.hide();ao.platform.ca.ParentalControl.setUserChangedCallback(function(){});}B.setHideWarningTimeoutRequired(false);ao.app.PVRCapability.unSubscribeWHPvrDeviceUpdate(l);f=false;}function M(){aw=true;ad();i();}function p(aR,aQ){var aS=ao.apps.core.KeyInterceptor.getKeyMap(),aU=false,aT=t.getSelectedItem(),aP=am.name==="recordedRecordings"&&H.isFolder(aT);if(B.isWarningVisible()){return true;}if(aq){aU=ap.manualRecordingOptionsList.ManualRecordingOptions.keyHandler(aR,aQ);}if(aT&&!aU){aL(!aP);s=t.getSelectedItemIndex();if(k){aU=ap.libraryOptions.keyHandler(aR,aQ);}else{aU=t.keyHandler(aR,aQ);}}if(!aU){switch(aR){case aS.KEY_YELLOW:if(!k&&aT){if(aF()){u(aT);}else{aI(aT);}aU=true;}break;case aS.KEY_BLUE:if(k){X();}else{az();}break;case aS.KEY_GREEN:if(!k&&!aq){N();}if(aq){B.returnToMenu();}aU=true;break;case aS.KEY_RED:case aS.KEY_INFO:if(!k&&!aP){aj(aT);aU=true;}break;case aS.KEY_PLAY:case aS.KEY_PAUSE:case aS.KEY_PLAY_PAUSE:a(aT);break;case aS.KEY_STOP:if(aT&&ar.isTaskRecordingNow(aT.taskId)){u(aT);}aU=true;break;case aS.KEY_LEFT:case aS.KEY_BACK:if(k){X();}else{if(aE){ad();}else{B.returnToMenu();}}aU=true;break;}}return aU;}return{initialise:at,preview:Z,activate:W,passivate:i,unPreview:M,keyHandler:p,dataUpdate:Y};};(function(b){var a=function(d,c){a.superConstructor.call(this,d);this.isFocused=true;this.isHighlighted=false;this._container=new b.gui.Group(d);this._background=new b.gui.Container(d,this._container);this._title=new b.gui.Label(d,this._container);this._subtitle=new b.gui.Label(d,this._container);this._highlight=new b.gui.Container(d,this._container);this._width=660;this._height=96;this.PADDING=22.5;this._container.configure({width:this._width,height:this._height});this._background.configure({width:this._width,height:this._height,cssClass:"menuItemBackgroundFocus",visible:false});this._title.configure({x:this.PADDING,y:34.5,width:this._width-(this.PADDING*2),cssClass:"libraryOptionsMenuText"});this._subtitle.configure({x:this.PADDING,y:81,width:this._width-(this.PADDING*2),cssClass:"libraryOptionsMenuTextBold"});this._highlight.configure({width:this._width,height:this._height,cssClass:"menuItemHighlight",rounding:1,visible:false});this._rootSVGRef=this._container.getRootSVGRef();if(c){c.addChild(this);}};b.gui.Util.extend(a,b.gui.AbstractListItem);a.prototype.setWidth=function(c){this._width=c;this._container.setWidth(c);this._background.setWidth(c);this._highlight.setWidth(c);this._title.setWidth(c-(this.PADDING*2));this._subtitle.setWidth(c-(this.PADDING*2));};a.prototype.setHeight=function(c){this._height=c;this._container.setHeight(c);this._background.setHeight(c);this._highlight.setHeight(c);};a.prototype.updateHighlight=function(){if(this.isHighlighted){if(this.isFocused){this._background.setCssClass("menuItemBackgroundFocus");this._background.show();this._highlight.show();}else{this._highlight.hide();this._background.setCssClass("menuItemBackgroundDefocus");this._background.show();}}else{this._highlight.hide();this._background.hide();}};a.prototype.highlight=function(){this.isHighlighted=true;this.updateHighlight();};a.prototype.unHighlight=function(){this.isHighlighted=false;this.updateHighlight();};a.prototype.focus=function(){this.isFocused=true;this.updateHighlight();};a.prototype.defocus=function(){this.isFocused=false;this.updateHighlight();};a.prototype.update=function(c){this._title.setText(this._dataMapper.getTitle(c));this._subtitle.setText(this._dataMapper.getSubtitle(c));};b.gui.LibraryOptionsMenuItem=a;}(window.parent.$N||{}));(function(b){function a(d,c){a.superConstructor.call(this,d);this._log=new b.apps.core.Log("CommonGUI","LibraryOptionsSubMenu");this._container=new b.gui.Group(this._docRef);this._background=new b.gui.Container(this._docRef,this._container);this._title=new b.gui.Label(d,this._container);this._menu=new b.gui.PageableListWithArrows(this._docRef,this._container);this._width=660;this._height=576;this._container.configure({width:this._width,height:this._height});this._background.configure({width:this._width,height:this._height,cssClass:"menuBackgroundDefocus"});this._title.configure({x:57,y:72,width:546,cssClass:"libraryOptionsSubMenuTitle"});this._menu.configure({x:0,y:105,itemHeight:72,visibleItemCount:6,itemTemplate:"LibraryOptionsSubMenuItem",dataMapper:{getTitle:function(e){return e.title;},getIcon:function(e){return e.href||"";},getChannelNumber:function(e){return e.channelNumber;},getSelected:function(e){return e.selected;}}});this._menu._upArrow.configure({x:610,y:-45,href:"../../../customise/resources/svg/icons.svg#guideUpArrowIcon",visible:false});this._menu._downArrow.configure({x:610,y:435,href:"../../../customise/resources/svg/icons.svg#guideDownArrowIcon",visible:false});this._exitCallback=function(){};this._rootSVGRef=this._container.getRootSVGRef();if(c){c.addChild(this);}}b.gui.Util.extend(a,b.gui.GUIObject);a.prototype.setExitCallback=function(c){this._exitCallback=c;};a.prototype._itemSelected=function(c){throw ("LibraryOptionsSubMenu - _itemSelected: Illegal operation on an abstract method");};a.prototype.initialise=function(){this._menu.setItemSelectedCallback(this._itemSelected.bind(this));this._menu.initialise();};a.prototype._setData=function(c){this._title.setText(c.title);this._menu.setData(c.options);this._menu.displayData(true);};a.prototype.preview=function(c){this._setData(c);};a.prototype.activate=function(){this._background.setCssClass("menuBackgroundFocus");this._menu.focus();this.show();};a.prototype.passivate=function(){this.hide();this._menu.defocus();this._background.setCssClass("menuBackgroundDefocus");};a.prototype.keyHandler=function(c){return this._menu.keyHandler(c);};b.gui.LibraryOptionsSubMenu=a;}(window.parent.$N||{}));(function(b){var a=function(d,c){a.superConstructor.call(this,d);this.isFocused=true;this.isHighlighted=false;this._container=new b.gui.Group(d);this._background=new b.gui.Container(d,this._container);this._title=new b.gui.Label(d,this._container);this._highlight=new b.gui.Container(d,this._container);this._icon=new b.gui.Image(d,this._container);this._channelNumber=new b.gui.Label(d,this._container);this._cursor=new b.gui.Label(d,this._container);this._originalChannelNumber=null;this._width=660;this._height=60;this.PADDING=55.5;this._container.configure({width:this._width,height:this._height});this._background.configure({width:this._width,height:this._height,cssClass:"menuItemBackgroundFocus",visible:false});this._title.configure({x:this.PADDING,y:40.5,width:this._width-(this.PADDING*2),cssClass:"libraryOptionsMenuText"});this._highlight.configure({width:this._width,height:this._height,cssClass:"menuItemHighlight",rounding:1,visible:false});this._icon.configure({x:14,y:12,width:25,height:25,href:"../../../customise/resources/images/%RES/icons/tick_17x17.png",visible:false});this._channelNumber.configure({x:this.PADDING,y:40.5,width:this._width-(this.PADDING*2),cssClass:"libraryOptionsMenuText"});this._cursor.configure({x:24,y:60,width:120,height:52.5,cssClass:"textUbuntuMedium directChannelEntryFeedback"});this._rootSVGRef=this._container.getRootSVGRef();if(c){c.addChild(this);}};b.gui.Util.extend(a,b.gui.AbstractListItem);a.prototype.setWidth=function(c){this._width=c;this._container.setWidth(c);this._background.setWidth(c);this._highlight.setWidth(c);this._title.setWidth(c-(this.PADDING*2));};a.prototype.setHeight=function(c){this._height=c;this._container.setHeight(c);this._background.setHeight(c);this._highlight.setHeight(c);};a.prototype.updateHighlight=function(){if(this.isHighlighted&&this.isFocused){this._background.show();this._highlight.show();}else{this._highlight.hide();this._background.hide();}};a.prototype.highlight=function(){this.isHighlighted=true;this.updateHighlight();};a.prototype.unHighlight=function(){this.isHighlighted=false;this.updateHighlight();};a.prototype.focus=function(){this.isFocused=true;this.updateHighlight();};a.prototype.defocus=function(){this.isFocused=false;this.updateHighlight();};a.prototype.update=function(e){if(e){var c=this._dataMapper.getIcon(e)||this._icon.getHref(),d=this._dataMapper.getSelected(e),f=this._dataMapper.getChannelNumber(e);if(f){this._originalChannelNumber=f;this._channelNumber.setText(f);this._channelNumber.setVisible(true);this._title.setX(this.PADDING+80);}else{this._channelNumber.setVisible(false);if(this._secIcon){this._title.setX(this.PADDING+62);}else{this._title.setX(this.PADDING);}}this._title.setText(this._dataMapper.getTitle(e));if(c){this._icon.setHref(c);this._icon.setVisible(d);}else{this._icon.hide();}}};a.prototype.showIcon=function(){if(this._icon.getHref()){this._icon.show();}};a.prototype.hideIcon=function(){this._icon.hide();};a.prototype.toggleIconVisibility=function(){if(this._icon.isVisible()){this._icon.hide();}else{this._icon.show();}};a.prototype.getOriginalChannelNumber=function(){return this._originalChannelNumber;};a.prototype.updateForChannelEntry=function(){this._channelNumber.setCssClass("textUbuntuMedium directChannelEntryFeedback");};a.prototype.updateForChannelEntryOver=function(){this._channelNumber.setCssClass("libraryOptionsMenuText");};a.prototype.setServiceNumber=function(c){this._channelNumber.setText(c);};b.gui.LibraryOptionsSubMenuItem=a;}(window.parent.$N||{}));(function(a){a.app=a.app||{};a.app.ManualRecordingOptionHelper=(function(){var p=a.app.PVRUtil,v=a.app.constants,f=a.app.StandardTimers.minuteTimer,n={startTime:null,stopTime:null,date:null,frequency:null,channel:null,channelInfo:null,folder:null,keepUntill:null,isTimeOrDateModified:false},j={ONCE:a.platform.btv.PVRManager.Frequency.ONCE,DAILY:a.platform.btv.PVRManager.Frequency.DAILY,WEEKLY:a.platform.btv.PVRManager.Frequency.WEEKLY,WEEKDAYS:a.platform.btv.PVRManager.Frequency.WEEKDAYS,WEEKENDS:a.platform.btv.PVRManager.Frequency.WEEKENDS};function l(z,A){A=A||"";var w,y,x=[a.app.constants.LEGACY_DEFAULT_NON_EPISODIC_FOLDER_NAME,""];if(A.length&&!a.app.FolderUtil.isFolderRootFolder(A)){y=z.indexOf(A);}else{for(w=0;w<x.length;w++){y=z.indexOf(x[w]);if(y>-1){break;}}}return y;}function g(){var x=a.app.DateTimeUtil.getFormattedTimeString(new Date(),v.TWENTY_FOUR_HOUR_TIME_FORMAT),w,y,z=x.split(":");w=Number(z[0]);y=Number(z[1]);if(w===23&&y>=30){w="00";y="00";}else{if(w<=23&&y<30){y="30";}else{w=(w+1).toString();y="00";}}return(w+":"+y);}function d(){var x=g(),w,y,z=x.split(":");w=Number(z[0])+1;y=z[1];w=w.toString();if(w==="24"){w="00";}return(w+":"+y);}function o(){var A=g(),w=a.apps.util.Util.formatDate(new Date(),"dd/mm/yyyy"),y,x,D,z,C,B;if(A==="00:00"){x=a.apps.util.Util.formatDate(new Date(),"yyyy/mm/dd");D=new Date(x+","+A);z=D.getTime();B=(z+(24*60*60*1000));C=a.apps.util.Util.formatDate(new Date(B),"dd/mm/yyyy");y=C;}else{y=w;}return y;}function e(){var z=a.app.ChannelManager.getAllChannelsOrderedByChannelNumber(),w=a.app.FormatUtils.formatFavouriteBlockChannelsData(z),y=a.app.epgUtil.getServiceById(a.app.epgUtil.getChannelFromPrefs()),x;if(w){for(x=0;x<w.length;x++){w[x].value=true;if(y.serviceName===w[x].title){w[x].selected=true;}else{w[x].selected=false;}}}return w;}function u(y){var x=y||a.app.epgUtil.getServiceById(a.app.epgUtil.getChannelFromPrefs()),w=a.app.ChannelManager.getAllChannelsOrderedByChannelNumber(),z;z=(a.app.FormatUtils.formatChannelNumber(x.logicalChannelNum)+" "+x.serviceName);return z;}function b(){var z=a.app.FolderUtil.getString("pvrSettingsRecordingHighlights"),y,w,x=[];x=a.platform.system.Preferences.get(a.app.constants.PVR_NON_EPISODIC_FOLDER_LIST);x=a.app.FormatUtils.formatRecordingsFolderListData(x,z);y=l(x,z);for(w=0;w<x.length;w++){x[w].selected=(z===x[w].title);}x=a.app.FolderUtil.sortFolderList(x);return x;}function s(){var w=[{title:a.app.ManualRecordingOptionHelper.getString("manualRecordingFrequencyOnce"),value:j.ONCE,selected:true},{title:a.app.ManualRecordingOptionHelper.getString("manualRecordingFrequencyDaily"),value:j.DAILY,selected:false},{title:a.app.ManualRecordingOptionHelper.getString("manualRecordingFrequencyWeekly"),value:j.WEEKLY,selected:false},{title:a.app.ManualRecordingOptionHelper.getString("manualRecordingFrequencyWeekDays"),value:j.WEEKDAYS,selected:false},{title:a.app.ManualRecordingOptionHelper.getString("manualRecordingFrequencyWeekend"),value:j.WEEKENDS,selected:false}];return w;}function c(){var C=a.app.epgUtil.getServiceById(a.app.epgUtil.getChannelFromPrefs()),B=e(),x=u(),w=b(),A=g(),z=d(),y=o();n={startTime:A,stopTime:z,date:y,frequency:j.ONCE,channel:x,channelInfo:C,folder:a.app.FolderUtil.getNonEpisodicDefaultFolder(),keepUntill:v.KEEP_UNTIL_OPTION_SPACE_NEEDED,isTimeOrDateModified:false};}function t(x,w){n[x]=w;}function k(w){return n[w];}function h(){return n;}function i(){var w=[{title:"manualRecordingKeepTitle",firstSubTitle:"SPACE NEEDED"}];return w;}function r(w){if(a.apps.core.ContextManager.getActiveContext().getId()==="LIBRARY"){a.app.DialogueHelper.createAndShowDialogue(a.app.constants.DLG_MANUAL_REC_MSG,a.app.ManualRecordingOptionHelper.getString("manualRecordingFailureTitle"),a.app.ManualRecordingOptionHelper.getString("manualRecordingFailureMessage"));a.app.DialogueHelper.updateDialogueTitleAndMessage(a.app.constants.DLG_MANUAL_REC_MSG,a.app.ManualRecordingOptionHelper.getString("manualRecordingFailureTitle"),a.app.ManualRecordingOptionHelper.getString("manualRecordingFailureMessage"));}}function q(y){if(y&&y.jobId&&(a.apps.core.ContextManager.getActiveContext().getId()==="LIBRARY")){var x=a.platform.btv.PVRManager.getJob(y.jobId),w="";if(x.scheduleType==="RPT_TIME"){w=a.app.ManualRecordingOptionHelper.getString("manualRecordingSuccessMessageRepeat");}else{w=a.app.ManualRecordingOptionHelper.getString("manualRecordingSuccessMessageSingle");}a.app.DialogueHelper.createAndShowDialogue(a.app.constants.DLG_MANUAL_REC_MSG,a.app.ManualRecordingOptionHelper.getString("manualRecordingSuccessTitle"),w+'"'+x.title+'".');a.app.DialogueHelper.updateDialogueTitleAndMessage(a.app.constants.DLG_MANUAL_REC_MSG,a.app.ManualRecordingOptionHelper.getString("manualRecordingSuccessTitle"),w+'"'+x.title+'".');}}function m(){var E=h(),y=E.date.replace(/(\d{2})\/(\d{2})\/(\d{4})/,"$3/$2/$1"),A=new Date(y+","+E.startTime),D=A.getTime()/1000,G=new Date(y+","+E.stopTime).getTime()/1000,x=E.frequency,H=E.channelInfo.serviceId,C=E.channelInfo.uri,B=parseInt(E.keepUntill,10),z=E.folder,w={},F=a.app.ManualRecordingOptionHelper.getString("manualRecordingTimeBased")+" - ",I=null;if(E.stopTime<E.startTime){I=new Date(y+","+E.stopTime).getTime();G=(I+(24*60*60*1000))/1000;}switch(x){case a.platform.btv.PVRManager.Frequency.ONCE:F=F+a.app.ManualRecordingOptionHelper.getString("manualRecordingFrequencyOnce");break;case a.platform.btv.PVRManager.Frequency.DAILY:F=F+a.app.ManualRecordingOptionHelper.getString("manualRecordingFrequencyDaily");break;case a.platform.btv.PVRManager.Frequency.WEEKLY:F=F+a.app.ManualRecordingOptionHelper.getString("manualRecordingFrequencyWeekly");break;case a.platform.btv.PVRManager.Frequency.WEEKDAYS:F=F+a.app.ManualRecordingOptionHelper.getString("manualRecordingFrequencyWeekDays");break;case a.platform.btv.PVRManager.Frequency.WEEKENDS:F=F+a.app.ManualRecordingOptionHelper.getString("manualRecordingFrequencyWeekend");break;}w={url:C,uiFolder:a.app.StringUtil.addLeadingForwardSlash(z),title:F,repeatDaysArray:a.platform.btv.PVRManager.getRepeatDaysArrayForFrequency(x,A)};a.platform.btv.PVRManager.requestTimeRecording(D,G,x,H,B,w);}return{manualRecordingStartTime:g,manualRecordingStopTime:d,getValidDate:o,manualRecordingChanneldata:e,getManualRecordingsFolderOptionData:b,getManualRecordingsDummyData:i,getChannelNameWithchannelNumber:u,getManualRecordingsFrequencyOptionData:s,resetManualRecordingproperties:c,setManualRecordingProperty:t,getManualRecordingProperty:k,getAllManualRecordingProperties:h,createManualRecording:m,manualRecordingSetFailedCallback:r,manualRecordingSetOKCallback:q};}());a.apps.core.Language.adornWithGetString(a.app.ManualRecordingOptionHelper);}(window.parent.$N||{}));(function(b){function a(d,c){a.superConstructor.call(this,d);this._log=new b.apps.core.Log("CommonGUI","ManualRecordingOptions");b.apps.core.Language.importLanguageBundleForObject(a,null,"apps/library/common/","LanguageBundle.js",null,window);this._container=new b.gui.Group(this._docRef);this._background=new b.gui.Container(this._docRef,this._container);this._menu=new b.gui.PageableList(this._docRef,this._container);this._legend=new b.gui.Container(this._docRef,this._container);this._legendBack=new b.gui.Label(this._docRef,this._legend);this._legendEnter=new b.gui.Label(this._docRef,this._legend);this._legendSave=new b.gui.Label(this._docRef,this._legend);this._okIcon=new b.gui.Image(this._docRef,this._legend);this._okText=new b.gui.Label(this._docRef,this._legend);this._legendGreenButton=new b.gui.Image(this._docRef,this._legend);this._legendBackArrow=new b.gui.SVGlink(this._docRef,this._legend);this._legendEnterArrow=new b.gui.SVGlink(this._docRef,this._legend);this._upArrow=new b.gui.SVGlink(this._docRef,this._container);this._downArrow=new b.gui.SVGlink(this._docRef,this._container);this._title=new b.gui.SpanLabel(this._docRef,this._container);this._titleArrays=[];this._container.configure({width:1345.5,height:576});this._title.configure({x:-179,y:-168,height:75,FirstWordsOnly:true,cssClass:"libraryTitle",spanCssClass:"libraryTitleGray"});this._background.configure({width:660,height:576,cssClass:"menuBackgroundFocus"});this._menu.configure({x:0,y:63,itemHeight:120,visibleItemCount:4,itemTemplate:"MultipleTitleSubtitleItem"});this._legend.configure({x:0,y:600,width:660,height:72,cssClass:"menuBackgroundDefocus"});this._legendBack.configure({x:61.5,y:45,cssClass:"filterTypeText"});this._legendEnter.configure({x:483,y:45,cssClass:"filterTypeText"});this._legendSave.configure({x:305,y:45,cssClass:"filterTypeText"});this._legendGreenButton.configure({x:250,y:15,href:b.app.constants.ACTIVE_LANGUAGE_BUTTON_PATH});this._legendBackArrow.configure({x:28.5,y:21,href:"../../../customise/resources/svg/icons.svg#guideLeftArrowIcon"});this._legendEnterArrow.configure({x:620,y:21,href:"../../../customise/resources/svg/icons.svg#guideRightArrowIcon"});this._upArrow.configure({x:610,y:20,href:"../../../customise/resources/svg/icons.svg#guideUpArrowIcon",visible:false});this._downArrow.configure({x:610,y:540,href:"../../../customise/resources/svg/icons.svg#guideDownArrowIcon",visible:false});this._okIcon.configure({x:730,y:18,href:"../../../customise/resources/images/%RES/icons/botao_ok_branco.png"});this._okText.configure({x:784,y:46.5,cssClass:"recordingsOptionFooterText"});this.currentSubMenu=null;this.subMenuActive=false;this._subMenu={confirmation:new b.gui.ManualRecordingOptionsSubMenuConfirmation(this._docRef,this._container),dateKeyPad:new b.gui.ManualRecordingDateKeypad(this._docRef,this._container),timeKeypad:new b.gui.ManualRecordingOptionsTimeKeypad(this._docRef,this._container),folder:new b.gui.ManualRecordingOptionsSubMenuFolder(this._docRef,this._container),keyboard:new b.gui.LibraryOptionsSubMenuKeyboard(this._docRef,this._container),keypad:new b.gui.LibraryOptionsSubMenuKeypad(this._docRef,this._container)};this._subMenu.confirmation.configure({x:685.5,y:0,visible:false});this._subMenu.keypad.configure({x:685.5,y:0,visible:false,maxCharacters:3,maxNumericKeypadValue:100});this._subMenu.timeKeypad.configure({x:685.5,y:0,visible:false,maxNumericKeypadValue:100});this._subMenu.dateKeyPad.configure({x:685.5,y:0,visible:false,maxNumericKeypadValue:100});this._subMenu.folder.configure({x:685.5,y:0,visible:false});this._subMenu.keyboard.configure({x:685.5,y:0,visible:false,maxCharacters:30});this._rootSVGRef=this._container.getRootSVGRef();if(c){c.addChild(this);}}b.gui.Util.extend(a,b.gui.GUIObject);a.prototype.focus=function(){this._menu.focus();this._background.setCssClass("menuBackgroundFocus");this._legend.setWidth(660);this._legendEnter.show();this._legendSave.show();this._legendEnter.show();this._legendGreenButton.show();this._legendEnterArrow.show();this._okIcon.hide();this._okText.hide();this.subMenuActive=false;};a.prototype._openSubMenu=function(){this._legendEnter.hide();this._legendEnterArrow.hide();this._legendGreenButton.hide();this._legendSave.hide();this._okIcon.show();this._okText.show();this._okText.setText(a.getString("optionsFolderSelect"));this._legend.setWidth(1345.5);this._background.setCssClass("menuBackgroundDefocus");this._menu.defocus();this._menu.getActualSelectedItem()._highlight.setCssClass("inactiveMenuItemHighlight").show();this.currentSubMenu.activate(this._menu.getActualSelectedItem(),this);this.subMenuActive=true;};a.prototype.getSelectedItem=function(){return this._menu.getSelectedItem();};a.prototype.getActualSelectedItem=function(){return this._menu.getActualSelectedItem();};a.prototype.subMenuExit=function(){this._menu.displayData(true);this.currentSubMenu.passivate();this.focus();};a.prototype._itemHighlighted=function(c){};a.prototype._itemSelected=function(e){var c=this._dataMapper.getSubMenuType(e),d=this._dataMapper.getSubMenuData(e);this.currentSubMenu=null;if(c&&d&&this._subMenu[c]){this.currentSubMenu=this._subMenu[c];this.currentSubMenu.preview(d);}if(this.currentSubMenu){this._openSubMenu();}};a.prototype.registerJobCallbacks=function(){b.app.PVRUtil.registerUIRefreshListener(b.app.ManualRecordingOptionHelper.manualRecordingSetOKCallback,this);CCOM.Scheduler.addEventListener("onAddTaskFailed",b.app.ManualRecordingOptionHelper.manualRecordingSetFailedCallback);};a.prototype.unregisterJobCallbacks=function(){b.app.PVRUtil.unregisterUIRefreshListener(b.app.ManualRecordingOptionHelper.manualRecordingSetOKCallback);CCOM.Scheduler.removeEventListener("onAddTaskFailed",b.app.ManualRecordingOptionHelper.manualRecordingSetFailedCallback,false);};a.prototype.initialise=function(){var e=this,d,c=function(f,g){e._upArrow.setVisible(g);e._downArrow.setVisible(f);};this._menu.setItemHighlightedCallback(this._itemHighlighted.bind(this));this._menu.setItemSelectedCallback(this._itemSelected.bind(this));this._menu.initialise();for(d in this._subMenu){if(this._subMenu.hasOwnProperty(d)){this._subMenu[d].initialise();this._subMenu[d].setExitCallback(this.subMenuExit.bind(this));}}this._menu.setListPagedCallback(c);};a.prototype.setDataMapper=function(c){this._dataMapper=c;this._menu.setDataMapper(c);};a.prototype.isSubmenuActive=function(){return this.subMenuActive;};a.prototype.refreshMenuData=function(d){var c=this._menu.getActualSelectedRowIndex();this._menu.setData(d);this._menu.displayData(false,true);this._menu.selectItemAtIndex(c,true);};a.prototype._validateAndSetRecording=function(){var d=b.app.ManualRecordingOptionHelper.getAllManualRecordingProperties(),c=d.date.replace(/(\d{2})\/(\d{2})\/(\d{4})/,"$3/$2/$1"),f=new Date(c+","+d.startTime).getTime(),e=new Date(c+","+d.stopTime).getTime(),g=new Date().getTime();if((f<g)||(f===e)){b.app.DialogueHelper.createAndShowDialogue(b.app.constants.DLG_MANUAL_REC_FAIL_MSG,b.app.ManualRecordingOptionHelper.getString("manualRecordingFailureTitle"),b.app.ManualRecordingOptionHelper.getString("manualRecordingErrorMessage"));return true;}else{b.app.ManualRecordingOptionHelper.createManualRecording();b.app.ManualRecordingOptionHelper.setManualRecordingProperty("isTimeOrDateModified",false);return false;}};a.prototype.titlePush=function(d){var c=this._titleArrays.join(" ");this._titleArrays.push(d);this._title.setText(this._titleArrays.join(" "));this._title.setSpanOnText(c);};a.prototype.titlePop=function(){var c=this._titleArrays.length;if(!c){return;}this._titleArrays.pop();if(!this._titleArrays.length){return;}else{if(this._titleArrays.length===1){this._title.setText(this._titleArrays[0]);this._title.setSpanOnText("");}else{this._title.setText(this._titleArrays.join(" "));this._title.setSpanOnText(this._titleArrays.slice(0,c-1).join(" "));}}};a.prototype.preview=function(c){this._legend.hide();if(this.currentSubMenu){this.currentSubMenu.passivate();}this._menu.setData(c);this._menu.displayData(true);this._menu.setVisible(true);this._upArrow.setVisible(false);this._downArrow.setVisible(false);this._background.setCssClass("menuBackgroundDefocus");this._background.setVisible(true);this.show();};a.prototype.activate=function(c){this.registerJobCallbacks();this._legend.show();this._legendBack.setText(a.getString("menuSettingsBack"));this._legendEnter.setText(a.getString("menuSettingsForward"));this._legendSave.setText(a.getString("manualRecordingSave"));this._okIcon.hide();this._okText.hide();if(this.currentSubMenu){this.currentSubMenu.passivate();}this._menu.setData(c);this._menu.displayData();this._upArrow.setVisible(false);this._downArrow.setVisible(c.length>this._menu.getVisibleItemCount());this.show();this.focus();};a.prototype.passivate=function(){this.unregisterJobCallbacks();this._legendBack.setText(a.getString("menuSettingsBack"));this._legendEnter.setText(a.getString("menuSettingsForward"));this._legendSave.setText(a.getString("manualRecordingSave"));if(this.subMenuActive){this.subMenuExit();}b.app.ManualRecordingOptionHelper.setManualRecordingProperty("isTimeOrDateModified",false);b.app.StandardTimers.minuteTimer.disable("ManualRecordingMenuHelperClock");this._background.setCssClass("menuBackgroundDefocus");this._menu.defocus();this.titlePop();this.hide();};a.prototype.keyHandler=function(d,c){var e=b.apps.core.KeyInterceptor.getKeyMap(),f=false;if(this.subMenuActive){f=this.currentSubMenu.keyHandler(d,c);}else{f=this._menu.keyHandler(d,c);}if(!f){switch(d){case e.KEY_GREEN:f=this._validateAndSetRecording();break;case e.KEY_BLUE:case e.KEY_RIGHT:case e.KEY_RED:case e.KEY_INFO:case e.KEY_YELLOW:f=true;break;case e.KEY_HOME:case e.KEY_MENU:if(this.subMenuActive){this.subMenuExit();}else{this.passivate();}f=false;break;case e.KEY_LEFT:case e.KEY_BACK:if(this.subMenuActive){this.subMenuExit();f=true;}else{this.passivate();f=false;}break;case e.KEY_EXIT:this.passivate();break;}}return f;};b.gui.ManualRecordingOptions=a;}(window.parent.$N||{}));(function(b){function a(d,c){a.superConstructor.call(this,d,c);this._log=new b.apps.core.Log("CommonGUI","LibraryOptionsSubMenuConfirmation");this._parentItem=null;this._successCallback=function(){};}b.gui.Util.extend(a,b.gui.LibraryOptionsSubMenu);a.prototype._itemSelected=function(f){var e=this._menu.getData(),c=e.length,d;if(f.value){for(d=0;d<c;d++){e[d].selected=false;}f.selected=true;this._menu.displayData();this._parentItem.setFirstSubTitle(f.title);this._successCallback(f.value);}this._exitCallback();};a.prototype._setData=function(c){a.superClass._setData.call(this,c);this._successCallback=c.successCallback;};a.prototype.activate=function(c,d){var e=1;this._parentItem=c;a.superClass.activate.call(this);this._menu.selectItemAtIndex(e,true);};a.prototype.keyHandler=function(c){var d=b.apps.core.KeyInterceptor.getKeyMap();if(c===d.KEY_RIGHT){return false;}return a.superClass.keyHandler.call(this,c);};b.gui.LibraryOptionsSubMenuConfirmation=a;}(window.parent.$N||{}));(function(c){function a(f,e){a.superConstructor.call(this,f,e);this._log=new c.apps.core.Log("CommonGUI","LibraryOptionsSubMenuFolder");this._optionsController=null;this._parentItem=null;this._menuItem=null;this._keypadBackground=new c.gui.Container(this._docRef,this._container);this._keypad=new c.gui.BaseKeypad(this._docRef,this._container);this._menu.configure({itemTemplate:"LibraryOptionsSubMenuIconItem"});this._keypad.configure({x:-685.5});this._keypadBackground.configure({x:-685.5,width:this._width,height:this._height,cssClass:"menuBackgroundDefocus"});this._footer=new c.gui.Group(this._docRef,this._container);this._greenIcon=new c.gui.Image(this._docRef,this._footer);this._greenIconText=new c.gui.Label(this._docRef,this._footer);this._footer.configure({y:601.5});this._greenIcon.configure({x:380,y:18,href:"../../../customise/resources/images/%RES/icons/botao_verde.png"});this._greenIconText.configure({x:430,y:46.5,cssClass:"recordingsOptionFooterText"});this._successCallback=function(){};}c.gui.Util.extend(a,c.gui.LibraryOptionsSubMenu);a.prototype._itemSelected=function(g){var f=this._menu.getData(),e;if(g.selected){this._exitCallback();return;}for(e=0;e<f.length;e++){f[e].selected=false;}g.selected=true;this._menu.displayData();this._parentItem.setFirstSubTitle(g.title);this._successCallback(g.value);this._exitCallback();};a.prototype.hideKeypad=function(){this._keypad.hide();this._keypadBackground.hide();};function b(){this.hideKeypad();this.afterHideKeypad();}function d(e){var k="",j=this._menu.getData(),f=c.platform.system.Preferences.get(c.app.constants.PVR_NON_EPISODIC_FOLDER_LIST),h,g={};if(e){k=e.replace(/^\s\s*/,"").replace(/\s\s*$/,"");}if(!k){c.app.DialogueHelper.createAndShowDialogue(c.app.constants.DLG_INVALID_FOLDER_NAME,c.gui.LibraryOptions.getString("optionsFolderErrorTitle"),c.gui.LibraryOptions.getString("optionsFolderInvalidName"));}else{g={title:k,value:k,selected:false};if(f.indexOf(k)>-1){c.app.DialogueHelper.createAndShowDialogue(c.app.constants.DLG_DUPLICATE_FOLDER_NAME,c.gui.LibraryOptions.getString("optionsFolderErrorTitle"),c.gui.LibraryOptions.getString("optionsFolderDupName"));return;}else{if(this._parentItem._firstSubTitle.getText()!=="---"&&this._parentItem._firstSubTitle.getText()===k){c.app.DialogueHelper.createAndShowDialogue(c.app.constants.DLG_DUPLICATE_FOLDER_NAME,c.gui.LibraryOptions.getString("optionsFolderErrorTitle"),c.gui.LibraryOptions.getString("optionsFolderDupName"));return;}else{f.splice(0,0,k.toString());c.platform.system.Preferences.set(c.app.constants.PVR_NON_EPISODIC_FOLDER_LIST,f);}}j.splice(1,0,g);j=c.app.FolderUtil.sortFolderList(j);this._menu.setData(j);this._menu.displayData();this.hideKeypad();this.afterHideKeypad();this.showList();}}a.prototype._setData=function(e){a.superClass._setData.call(this,e);this._successCallback=e.successCallback;};a.prototype.beforeShowKeypad=function(){this._optionsController.titlePush(c.gui.LibraryOptions.getString("optionsFolderCreate"));this._optionsController._background.hide();this._optionsController._menu.hide();this._optionsController._okIcon.hide();this._optionsController._okText.hide();this._optionsController._upArrow.setHref("");this._optionsController._downArrow.setHref("");this._optionsController._legend.setWidth(660);};a.prototype.afterHideKeypad=function(){this._optionsController.titlePop();this._optionsController._background.show();this._optionsController._menu.show();this._optionsController._okIcon.show();this._optionsController._okText.show();this._optionsController._upArrow.setHref("../../../customise/resources/svg/icons.svg#guideUpArrowIcon");this._optionsController._downArrow.setHref("../../../customise/resources/svg/icons.svg#guideDownArrowIcon");this._optionsController._legend.setWidth(1345.5);};a.prototype.keypadInitialise=function(){this._keypad.resetKeyPadConfig();c.app.KeyboardUtils.setKeypad(this._keypad,c.app.KeyboardType.ALPHA_NUMERIC_UPPERCASE);this._keypad.setMaxCharacters(18);this._keypad.enableCursor();this._keypad.setColorKeyCallbacks({green:d.bind(this)});this._keypad.setExitCallback(b.bind(this));c.app.KeyboardUtils.showKeypad(c.app.KeyboardType.ALPHA_NUMERIC_UPPERCASE);};a.prototype.showKeypad=function(e){this._keypad.setKeypadTitle(e);this._keypad.clearInput();this._keypadBackground.show();this._keypad.show();this._keypad.focus();this.showFooter("keypad");};a.prototype.showList=function(){var e=1;this._background.show();this._title.show();this._menu.show();this._menu.focus();this._menu.selectItemAtIndex(e,true);this.showFooter("list");};a.prototype.hideList=function(){this._background.hide();this._title.hide();this._menu.hide();};a.prototype.showFooter=function(e){if(e==="list"){this._greenIconText.setText(c.gui.LibraryOptions.getString("optionsFolderNew"));this._greenIcon.setX(380);this._greenIconText.setX(430);}else{if(e==="keypad"){this._greenIconText.setText(c.gui.LibraryOptions.getString("optionsFolderCreate"));this._greenIcon.setX(-370);this._greenIconText.setX(-320);}}this._greenIcon.setY(13);};a.prototype.activate=function(e,f){var g=this._menu.getData();this._optionsController=f;this._parentItem=e;this._menuItem=f.getSelectedItem();this.keypadInitialise();if(g.length<0){this.showKeypad(c.gui.LibraryOptions.getString("optionsNewFolderName"));this.hideList();}else{this.showList();this.hideKeypad();}this.show();};a.prototype.initialise=function(){a.superClass.initialise.call(this);this._keypad.initialise();};a.prototype.keyHandler=function(f,e){var h=false,g=c.apps.core.KeyInterceptor.getKeyMap();if(this._keypad.isVisible()){h=this._keypad.keyHandler(f,e);if(!this._keypad.isVisible()){if(!this._menu.getData().length){h=false;}else{this.showList();h=(f!==g.KEY_EXIT);}}}else{if(f===g.KEY_GREEN){this.beforeShowKeypad();this.showKeypad(c.gui.LibraryOptions.getString("optionsNewFolderName"));this.hideList();h=true;}else{h=a.superClass.keyHandler.call(this,f);}}return h;};c.gui.LibraryOptionsSubMenuFolder=a;}(window.parent.$N||{}));(function(b){var a=function(d,c){a.superConstructor.call(this,d);this._secIcon=new b.gui.Image(d,this._container);this._title.configure({x:this.PADDING+62,width:this._width-(this.PADDING*2)-62});this._secIcon.configure({x:this.PADDING,y:12,href:"../../../customise/resources/images/%RES/icons/DVR_pasta_menor.png"});};b.gui.Util.extend(a,b.gui.LibraryOptionsSubMenuItem);b.gui.LibraryOptionsSubMenuIconItem=a;}(window.parent.$N||{}));(function(a){function b(d,c){b.superConstructor.call(this,d,c);a.apps.core.Language.adornWithGetString(b);this._log=new a.apps.core.Log("CommonGUI","LibraryOptionsSubMenuKeyboard");this._menu=new a.gui.BaseKeypad(this._docRef,this._container);this._footer=new a.gui.Group(this._docRef,this._container);this._greenIcon=new a.gui.Image(this._docRef,this._footer);this._greenIconText=new a.gui.Label(this._docRef,this._footer);this._footer.configure({y:601.5});this._greenIcon.configure({x:350,y:18,href:"../../../customise/resources/images/%RES/icons/botao_verde.png"});this._greenIconText.configure({x:400,y:46.5,cssClass:"recordingsOptionFooterText"});this._successCallback=function(){};}a.gui.Util.extend(b,a.gui.LibraryOptionsSubMenu);b.prototype.saveOption=function(c){if(c.value){this._successCallback();}this._exitCallback();};b.prototype.initialise=function(){this._menu.initialise();};b.prototype.setMaxCharacters=function(c){this._menu.setMaxCharacters(Number(c));};b.prototype._setData=function(c){this._menu.setKeypadTitle(c.title);this._menu.setColorKeyCallbacks({green:c.successCallback});this._menu.setInputValue(c.labelText);this._greenIconText.setText(c.greenIconText);this._successCallback=c.successCallback;};b.prototype.activate=function(c){a.app.KeyboardUtils.setKeypad(this._menu,a.app.KeyboardType.ALPHA_NUMERIC_UPPERCASE);this._menu.configure({exitCallback:this._exitCallback.bind(this),textInputAlignment:a.app.KeyboardType.ALIGNMENT.LEFT,maxCharacters:a.app.FolderUtil.FOLDER_NAME_MAX_CHARACTERS,cursorEnable:true});a.app.KeyboardUtils.setSaveCallback(this.saveOption.bind(this));a.app.KeyboardUtils.showKeypad(a.app.KeyboardType.ALPHA_NUMERIC_UPPERCASE);b.superClass.activate.call(this);};b.prototype.passivate=function(){this.hide();this._menu.defocus();};b.prototype.keyHandler=function(d,c){return this._menu.keyHandler(d,c);};a.gui.LibraryOptionsSubMenuKeyboard=b;}(window.parent.$N||{}));(function(a){function b(d,c){b.superConstructor.call(this,d,c);a.apps.core.Language.adornWithGetString(b);this._log=new a.apps.core.Log("CommonGUI","LibraryOptionsSubMenuKeypad");this._returnObj={paddingBefore:null,paddingAfter:null};this._menu=new a.gui.BaseKeypad(this._docRef,this._container);this._successCallback=function(){};}a.gui.Util.extend(b,a.gui.LibraryOptionsSubMenu);b.prototype._resetAndShowKeypad=function(c){this._menu.resetKeyPadConfig();this._menu.setKeypadTitle(c);a.app.KeyboardUtils.setKeypad(this._menu,a.app.KeyboardType.NUMERIC);this._menu.configure({exitCallback:this._exitCallback.bind(this),textInputAlignment:a.app.KeyboardType.ALIGNMENT.CENTRE,maxCharacters:2,maxNumericKeypadValue:99});a.app.KeyboardUtils.setKeypadReturnObject({});a.app.KeyboardUtils.setSaveCallback(this.saveOption.bind(this));this._menu.clearInput();a.app.KeyboardUtils.showKeypad(a.app.KeyboardType.NUMERIC);b.superClass.activate.call(this);};b.prototype.saveOption=function(c){if(c.value){if(this._returnObj.paddingBefore===null){this._returnObj.paddingBefore=c.value;this._resetAndShowKeypad(b.getString("paddingAfterEpisodic"));}else{this._returnObj.paddingAfter=c.value;}this._successCallback(this._returnObj);}if(this._returnObj.paddingAfter!==null){this._exitCallback();}};b.prototype.initialise=function(){this._menu.initialise();};b.prototype.setMaxNumericKeypadValue=function(c){this._menu.setMaxNumericKeypadValue(Number(c));};b.prototype.setMaxCharacters=function(c){this._menu.setMaxCharacters(Number(c));};b.prototype._setData=function(c){this._menu.setKeypadTitle(c.title);this._successCallback=c.successCallback;};b.prototype.activate=function(c){c.setFirstSubTitle("_ _ "+b.getString("minutes"));c.setSecondSubTitle("_ _ "+b.getString("minutes"));this._returnObj.paddingBefore=null;this._returnObj.paddingAfter=null;this._resetAndShowKeypad(b.getString("paddingBeforeEpisodic"));};b.prototype.keyHandler=function(d,c){return this._menu.keyHandler(d,c);};a.gui.LibraryOptionsSubMenuKeypad=b;}(window.parent.$N||{}));(function(a){function b(d,c){b.superConstructor.call(this,d,c);a.apps.core.Language.adornWithGetString(b);this._log=new a.apps.core.Log("CommonGUI","ManualRecordingDateKeypad");this._returnObj={startRecordingDate:null};this._menu=new a.gui.BaseKeypad(this._docRef,this._container);this._successCallback=function(){};}a.gui.Util.extend(b,a.gui.LibraryOptionsSubMenu);b.prototype.setDateKeyPad=function(){this._menu.resetKeyPadConfig();this._menu.clearInput();this._menu.setInputFormat(2,2,"/");};b.prototype.menuConfig=function(){this._menu.configure({exitCallback:this._exitCallback.bind(this),textInputAlignment:a.app.KeyboardType.ALIGNMENT.CENTRE});};b.prototype.getValidDate=function(d){var g=this,f=new Date(),e=a.app.DateTimeUtil,c=a.apps.util.Util.removeSpaces(d);f=c;c=f.split("/");if(e.isValidDate(parseInt(c[2],10),parseInt(c[1],10),parseInt(c[0],10))){if(!e.isDateInFuture(parseInt(c[2],10),parseInt(c[1],10),parseInt(c[0],10))){c[2]=parseInt(c[2],10)+1;}f=c.join("/");return f;}else{a.app.ErrorMessage.showInvalidDateDialog(function(){g.setDateKeyPad();});return false;}};b.prototype.saveOption=function(d){var c=false;if(d.value){c=this.getValidDate(d.value.concat("/"+new Date().getUTCFullYear()));if(c!==false){this._returnObj.startRecordingDate=c;this._successCallback(this._returnObj);this._exitCallback();}}};b.prototype.initialise=function(){this._menu.initialise();};b.prototype.setMaxNumericKeypadValue=function(c){this._menu.setMaxNumericKeypadValue(Number(c));};b.prototype.setMaxCharacters=function(c){this._menu.setMaxCharacters(Number(c));};b.prototype._setData=function(c){this._menu.setKeypadTitle(c.title);this._successCallback=c.successCallback;};b.prototype.activate=function(c){this._menu.resetKeyPadConfig();this._menu.setKeypadTitle(b.getString("manualRecordingDate"));c.setFirstSubTitle("_ _ /_ _");this._returnObj.startRecordingDate=null;a.app.KeyboardUtils.setKeypad(this._menu,a.app.KeyboardType.NUMERIC);this.menuConfig();a.app.KeyboardUtils.setKeypadReturnObject({});a.app.KeyboardUtils.setSaveCallback(this.saveOption.bind(this));this.setDateKeyPad();a.app.KeyboardUtils.showKeypad(a.app.KeyboardType.NUMERIC);b.superClass.activate.call(this);};b.prototype.passivate=function(){this.hide();this._menu.defocus();};b.prototype.keyHandler=function(c){var e=false,d=a.apps.core.KeyInterceptor.getKeyMap();if(c===d.KEY_GREEN){e=true;}else{e=this._menu.keyHandler(c);}return e;};a.gui.ManualRecordingDateKeypad=b;}(window.parent.$N||{}));(function(b){function c(f,e){c.superConstructor.call(this,f,e);this._log=new b.apps.core.Log("CommonGUI","ManualRecordingOptionsSubMenuConfirmation");this.directChannelEntry=new b.app.DirectChannelEntry(b.app.constants.MAX_CHANNEL_DIGITS,b.app.constants.CHANNEL_ENTRY_TIMEOUT_MS);this._label=new b.gui.Label(f,this._container);this._label.configure({x:57,y:72,width:546,cssClass:"libraryOptionsSubMenuTitle",visible:false});this._parentItem=null;this._menuItem=null;this._successCallback=function(){};}b.gui.Util.extend(c,b.gui.LibraryOptionsSubMenu);c.prototype._itemSelected=function(g){var f=this._menu.getData(),e;if(g.value){for(e=0;e<f.length;e++){f[e].selected=false;}g.selected=true;this._menu.displayData();if(g.channelNumber){this._selectedItem=g.channelNumber;this._parentItem.setFirstSubTitle(g.channelNumber+" "+g.title);this._menuItem.subtitle=g.channelNumber+" "+g.title;}else{this._parentItem.setFirstSubTitle(g.title);this._menuItem.subtitle=g.title;}this._successCallback(g);}this._exitCallback();};c.prototype._setData=function(e){c.superClass._setData.call(this,e);this._successCallback=e.successCallback;};c.prototype.currentChannelInfo=function(g){var f=g.subtitle.split(" "),e;if(typeof(this._selectedItem)==="string"){this._selectedItem=Number(this._selectedItem);}e=Number(f[0])||this._selectedItem;return b.platform.btv.EPG.getChannelByLCN(e);};c.prototype.selectTunedChannel=function(g){var f=this.currentChannelInfo(g),i=(!g)?b.app.epgUtil.getChannelFromPrefs():f.serviceId,h=1,e=null;if(i){e=this._menu.getIndexByUniqueData("serviceId",i.toString());if(e){this._menu.selectItemAtIndex(e+1,true);}else{this._menu.selectItemAtIndex(h,true);}}};function a(g){var f=g,e=f._menu.getActualSelectedItem();if(e){e.setServiceNumber(e.getOriginalChannelNumber());e.updateForChannelEntryOver();}f.directChannelEntry.cancelEntry();}c.prototype.setDirectChannelEnteredCallback=function(){var f=this,e=function(h){var i=null,j=1,g=null;if(f._menuItem.isUpDownPageable&&h){f._menu.getActualSelectedItem().updateForChannelEntryOver();i=b.app.epgUtil.getNextClosestService(h,b.app.ChannelManager.getAllChannelsOrderedByChannelNumber()).logicalChannelNum;i=b.app.FormatUtils.formatChannelNumber(i);if(i){g=f._menu.getIndexByUniqueData("channelNumber",i);if(g){f._menu.selectItemAtIndex(g+1,true);}else{f._menu.selectItemAtIndex(j,true);}}}else{if(f._menuItem.isUpDownPageable&&!h){a(f);}}f._label.setText("");};this.directChannelEntry.setChannelEnteredCallback(e);};c.prototype.activate=function(e,f){var g=1;this._parentItem=e;this._menuItem=f.getSelectedItem();if(this._menuItem.isUpDownPageable){this._menu.setUpDownPageable(true);this.setDirectChannelEnteredCallback();}c.superClass.activate.call(this);if(this._menuItem.title===b.gui.ManualRecordingOptions.getString("manualRecordingChannel")){this.selectTunedChannel(this._menuItem);}else{this._menu.selectItemAtIndex(g,true);}};function d(f,g,i){var j=false,h=f,e=h.directChannelEntry,k=h._menu;switch(g){case i.KEY_ZERO:case i.KEY_ONE:case i.KEY_TWO:case i.KEY_THREE:case i.KEY_FOUR:case i.KEY_FIVE:case i.KEY_SIX:case i.KEY_SEVEN:case i.KEY_EIGHT:case i.KEY_NINE:if(!e.isActive()){k.getActualSelectedItem().updateForChannelEntry();}e.updateChannelDigits(g,k.getActualSelectedItem()._channelNumber,k.getActualSelectedItem()._cursor);j=true;break;case i.KEY_LEFT:if(e.isActive()){e.updateChannelDigits(g,k.getActualSelectedItem()._channelNumber,k.getActualSelectedItem()._cursor);j=true;}break;case i.KEY_BACK:if(e.isActive()){a(h);j=true;}break;case i.KEY_OK:if(e.okKeyHandler()){j=true;}break;default:if(b.app.GeneralUtil.isKeyReleaseEvent(g)){return false;}if(e.isActive()){a(h);}}return j;}c.prototype.keyHandler=function(e){var f=b.apps.core.KeyInterceptor.getKeyMap(),g=false;if(e===f.KEY_RIGHT){return false;}if(e===f.KEY_GREEN){g=true;}if(this._menuItem.isUpDownPageable){if(this.directChannelEntry&&this._menu.getSize()>0){if(d(this,e,f)){return true;}}}if(!g){g=c.superClass.keyHandler.call(this,e);}return g;};b.gui.ManualRecordingOptionsSubMenuConfirmation=c;}(window.parent.$N||{}));(function(a){function b(d,c){b.superConstructor.call(this,d,c);a.apps.core.Language.adornWithGetString(b);this._log=new a.apps.core.Log("CommonGUI","ManualRecordingOptionsTimeKeypad");this._returnObj={startTime:null,stopTime:null};this.stopTimeKeypad=null;this._menu=new a.gui.BaseKeypad(this._docRef,this._container);this._successCallback=function(){};}a.gui.Util.extend(b,a.gui.LibraryOptionsSubMenu);b.prototype.setTimeKeyPad=function(){this._menu.resetKeyPadConfig();this._menu.clearInput();this._menu.setInputFormat(2,2,":");};b.prototype.menuConfig=function(){this._menu.configure({exitCallback:this._exitCallback.bind(this),textInputAlignment:a.app.KeyboardType.ALIGNMENT.CENTRE});};b.prototype.getValidTime=function(e){var d=this,c=e.split(":");if(a.app.DateTimeUtil.isValidTime(c[0],c[1])){return e;}else{a.app.ErrorMessage.showInvalidTimeDialog(function(){d.setTimeKeyPad();});return false;}};b.prototype.saveOption=function(d){var c=false;if(d.value){c=this.getValidTime(d.value);}if(c!==false){if(this._returnObj.startTime===null){this._returnObj.startTime=c;this._menu.setKeypadTitle(b.getString("manualRecordingStopTime"));this.stopTimeKeypad=true;}else{this._returnObj.stopTime=c;}this._successCallback(this._returnObj);}if(this._returnObj.stopTime!==null){this._exitCallback();}};b.prototype.initialise=function(){this._menu.initialise();};b.prototype.setMaxNumericKeypadValue=function(c){this._menu.setMaxNumericKeypadValue(Number(c));};b.prototype.setMaxCharacters=function(c){this._menu.setMaxCharacters(Number(c));};b.prototype._setData=function(c){this._menu.setKeypadTitle(c.title);this._successCallback=c.successCallback;};b.prototype._keyPadConfig=function(c){this._menu.resetKeyPadConfig();this._menu.setKeypadTitle(b.getString("manualRecordingStartTime"));c.setFirstSubTitle("_ _ : _ _");c.setSecondSubTitle("_ _ : _ _");this._returnObj.startTime=null;this._returnObj.stopTime=null;a.app.KeyboardUtils.setKeypad(this._menu,a.app.KeyboardType.NUMERIC);this.menuConfig();a.app.KeyboardUtils.setKeypadReturnObject({});a.app.KeyboardUtils.setSaveCallback(this.saveOption.bind(this));this.setTimeKeyPad();a.app.KeyboardUtils.showKeypad(a.app.KeyboardType.NUMERIC);};b.prototype.activate=function(c){this._keyPadConfig(c);b.superClass.activate.call(this);};b.prototype.keyHandler=function(c){var e=false,d=a.apps.core.KeyInterceptor.getKeyMap();if(c===d.KEY_GREEN){e=true;}else{e=this._menu.keyHandler(c);}if(c===d.KEY_OK&&this.stopTimeKeypad){this.setTimeKeyPad();this.stopTimeKeypad=false;e=true;}return e;};a.gui.ManualRecordingOptionsTimeKeypad=b;}(window.parent.$N||{}));(function(b){function a(d,c){a.superConstructor.call(this,d);this._log=new b.apps.core.Log("CommonGUI","LibraryOptions");b.apps.core.Language.importLanguageBundleForObject(a,null,"apps/library/common/","LanguageBundle.js",null,window);this._container=new b.gui.Group(this._docRef);this._background=new b.gui.Container(this._docRef,this._container);this._menu=new b.gui.PageableList(this._docRef,this._container);this._legend=new b.gui.Container(this._docRef,this._container);this._legendBack=new b.gui.Label(this._docRef,this._legend);this._okIcon=new b.gui.Image(this._docRef,this._legend);this._okText=new b.gui.Label(this._docRef,this._legend);this._legendEnter=new b.gui.Label(this._docRef,this._legend);this._legendBackArrow=new b.gui.SVGlink(this._docRef,this._legend);this._legendEnterArrow=new b.gui.SVGlink(this._docRef,this._legend);this._upArrow=new b.gui.SVGlink(this._docRef,this._container);this._downArrow=new b.gui.SVGlink(this._docRef,this._container);this._title=new b.gui.SpanLabel(this._docRef,this._container);this._titleArrays=[];this._container.configure({width:1345.5,height:576});this._title.configure({x:20,y:-28,height:75,FirstWordsOnly:true,cssClass:"newLibraryTitle",spanCssClass:"newLibraryTitleGray"});this._background.configure({width:660,height:576,cssClass:"menuBackgroundFocus"});this._menu.configure({x:0,y:63,itemHeight:120,visibleItemCount:4,itemTemplate:"MultipleTitleSubtitleItem"});this._legend.configure({x:0,y:600,width:660,height:72,cssClass:"menuBackgroundDefocus"});this._legendBack.configure({x:61.5,y:45,cssClass:"filterTypeText"});this._legendEnter.configure({x:483,y:45,cssClass:"filterTypeText"});this._legendBackArrow.configure({x:28.5,y:21,href:"../../../customise/resources/svg/icons.svg#guideLeftArrowIcon"});this._legendEnterArrow.configure({x:615,y:21,href:"../../../customise/resources/svg/icons.svg#guideRightArrowIcon"});this._upArrow.configure({x:610,y:20,href:"../../../customise/resources/svg/icons.svg#guideUpArrowIcon",visible:false});this._downArrow.configure({x:610,y:540,href:"../../../customise/resources/svg/icons.svg#guideDownArrowIcon",visible:false});this._okIcon.configure({x:730,y:18,href:"../../../customise/resources/images/%RES/icons/botao_ok_branco.png"});this._okText.configure({x:784,y:46.5,cssClass:"recordingsOptionFooterText"});this.currentSubMenu=null;this.subMenuActive=false;this._subMenu={confirmation:new b.gui.LibraryOptionsSubMenuConfirmation(this._docRef,this._container),keypad:new b.gui.LibraryOptionsSubMenuKeypad(this._docRef,this._container),folder:new b.gui.LibraryOptionsSubMenuFolder(this._docRef,this._container),keyboard:new b.gui.LibraryOptionsSubMenuKeyboard(this._docRef,this._container)};this._subMenu.confirmation.configure({x:685.5,y:0,visible:false});this._subMenu.keypad.configure({x:685.5,y:0,visible:false,maxCharacters:3,maxNumericKeypadValue:100});this._subMenu.folder.configure({x:685.5,y:0,visible:false});this._subMenu.keyboard.configure({x:685.5,y:0,visible:false,maxCharacters:30});this._rootSVGRef=this._container.getRootSVGRef();if(c){c.addChild(this);}}b.gui.Util.extend(a,b.gui.GUIObject);a.prototype.focus=function(){this._menu.focus();this._background.setCssClass("menuBackgroundFocus");this._legend.setWidth(660);this._legendEnter.show();this._legendEnterArrow.show();this._okIcon.hide();this._okText.hide();this.subMenuActive=false;};a.prototype._openSubMenu=function(){this._legendEnter.hide();this._legendEnterArrow.hide();this._okIcon.show();this._okText.show();this._okText.setText(a.getString("optionsFolderSelect"));this._legend.setWidth(1345.5);this._background.setCssClass("menuBackgroundDefocus");this._menu.defocus();this._menu.getActualSelectedItem()._highlight.setCssClass("inactiveMenuItemHighlight").show();this.currentSubMenu.activate(this._menu.getActualSelectedItem(),this);this.subMenuActive=true;};a.prototype.getSelectedItem=function(){return this._menu.getSelectedItem();};a.prototype.getActualSelectedItem=function(){return this._menu.getActualSelectedItem();};a.prototype.subMenuExit=function(){this.currentSubMenu.passivate();this.focus();};a.prototype._itemHighlighted=function(e){var c=this._dataMapper.getSubMenuType(e),d=this._dataMapper.getSubMenuData(e);this.currentSubMenu=null;if(c&&d&&this._subMenu[c]){this.currentSubMenu=this._subMenu[c];this.currentSubMenu.preview(d);}};a.prototype._itemSelected=function(c){if(this.currentSubMenu){this._openSubMenu();}};a.prototype.initialise=function(){var e=this,d,c=function(f,g){e._upArrow.setVisible(g);e._downArrow.setVisible(f);};this._menu.setItemHighlightedCallback(this._itemHighlighted.bind(this));this._menu.setItemSelectedCallback(this._itemSelected.bind(this));this._menu.initialise();for(d in this._subMenu){if(this._subMenu.hasOwnProperty(d)){this._subMenu[d].initialise();this._subMenu[d].setExitCallback(this.subMenuExit.bind(this));}}this._menu.setListPagedCallback(c);};a.prototype.setDataMapper=function(c){this._dataMapper=c;this._menu.setDataMapper(c);};a.prototype.titlePush=function(d){var c=this._titleArrays.join(" ");this._titleArrays.push(d);this._title.setText(this._titleArrays.join(" "));this._title.setSpanOnText(c);};a.prototype.titlePop=function(){var c=this._titleArrays.length;if(!c){return;}this._titleArrays.pop();if(!this._titleArrays.length){return;}else{if(this._titleArrays.length===1){this._title.setText(this._titleArrays[0]);this._title.setSpanOnText("");}else{this._title.setText(this._titleArrays.join(" "));this._title.setSpanOnText(this._titleArrays.slice(0,c-1).join(" "));}}};a.prototype.activate=function(c){this.titlePush(a.getString("optionsTitle"));this._okIcon.hide();this._okText.hide();this._legendBack.setText(a.getString("menuSettingsBack"));this._legendEnter.setText(a.getString("menuSettingsForward"));if(this.currentSubMenu){this.currentSubMenu.passivate();}this._menu.setData(c);this._menu.displayData();this._upArrow.setVisible(false);this._downArrow.setVisible(c.length>this._menu.getVisibleItemCount());this.show();};a.prototype.passivate=function(){if(this.subMenuActive){this.subMenuExit();}this.titlePop();this.hide();};a.prototype.keyHandler=function(d,c){var e=b.apps.core.KeyInterceptor.getKeyMap(),f=false;if(this.subMenuActive){f=this.currentSubMenu.keyHandler(d,c);}else{f=this._menu.keyHandler(d,c);}if(!f){switch(d){case e.KEY_LEFT:case e.KEY_BACK:if(this.subMenuActive){this.subMenuExit();f=true;}break;case e.KEY_GREEN:if(this.subMenuActive){f=true;}break;}}return f;};b.gui.LibraryOptions=a;}(window.parent.$N||{}));(function(b){function a(d,c){a.superConstructor.call(this,d,c);this._log=new b.apps.core.Log("CommonGUI","ManualRecordingOptionsSubMenuFolder");this._optionsController=null;this._parentItem=null;this._menuItem=null;this._successCallback=function(){};}b.gui.Util.extend(a,b.gui.LibraryOptionsSubMenuFolder);a.prototype._itemSelected=function(e){var d=this._menu.getData(),c;if(e.selected){this._exitCallback();return;}for(c=0;c<d.length;c++){d[c].selected=false;}e.selected=true;this._menu.displayData();this._parentItem.setFirstSubTitle(e.title);this._menuItem.subtitle=e.title;this._successCallback(e);this._exitCallback();};a.prototype.beforeShowKeypad=function(){this._optionsController._background.hide();this._optionsController._menu.hide();this._optionsController._okIcon.hide();this._optionsController._okText.hide();this._optionsController._upArrow.setHref("");this._optionsController._downArrow.setHref("");this._optionsController._legend.setWidth(660);};b.gui.ManualRecordingOptionsSubMenuFolder=a;}(window.parent.$N||{}));