var $N=window.parent.$N;$N.app=$N.app||{};$N.app.players=$N.app.players||{};(function(b){function a(c){this._log=new b.apps.core.Log("MediaPlayer","BasePlayer");this._banner=c||{show:function(){},hide:function(){},update:function(){}};this._bannerTimeout=null;this._backLabelTimeout=null;this._updateInterval=null;this._trickplayEnabled=true;this._skipEnabled=false;this._isTrailer=false;this._DEFAULT_MODE="play";this._DEFAULT_RATE=100;this._BANNER_UPDATE_INTERVAL=1000;this._BANNER_TIMEOUT_DEFAULT=5000;this._SKIP_TIME=b.app.constants.DEFAULT_SKIP_TIME_SECS;this._trickPlayObj=b.app.fullScreenPlayer.trickPlay;this._clockDisplay=b.app.ClockDisplay;this._hasFocus=false;}a.prototype._getBannerTimeout=function(){return parseInt(b.platform.system.Preferences.get(b.app.constants.PREF_PLAYBACK_PLAYER_TIMEOUT),10)||this._BANNER_TIMEOUT_DEFAULT;};a.prototype._getContentLengthText=function(d){d=Math.max(d,0);var c=Math.floor(d/(60*60)),e=Math.floor((d-(c*60*60))/60),f=Math.floor(d-(c*3600)-(e*60));if(f===60){e++;f=0;}if(e===60){c++;e=0;}if(c<10){c="0"+c;}if(e<10){e="0"+e;}if(f<10){f="0"+f;}return c+":"+e+":"+f;};a.prototype.initialise=function(){var c=this;this._player=b.app.fullScreenPlayer.getPlayer();this._playerReachedEndCallback=function(){if(this._hasFocus){b.app.ContextHelper.closeContext();}};this._playerReachedBeginningCallback=function(){c._trickPlayObj.play();};this._playerPlayingCallback=function(){if(!c._isTrailer){c._showBanner();}};this._uiRefreshCallback=function(e,d){c._updateBannerTrickPlayIndicators(e,d);c._showBanner(e);if(e!==b.platform.output.TrickPlay.MODES.PLAY){c._cancelBannerHide();}};};a.prototype.activate=function(e){var c=this,d=e.retryCallback;this._skipEnabled=e.skip;this._trickplayEnabled=e.trickplay;this._playbackFinished=false;this._isTrailer=false;this._updateBannerTrickPlayIndicators(this._DEFAULT_MODE,this._DEFAULT_RATE);this._trickPlayObj.setPlayerPlayingCallback(this._playerPlayingCallback);this._trickPlayObj.setPlayerAtBeginningCallback(this._playerReachedBeginningCallback);this._trickPlayObj.setPlayerAtEndCallback(this._playerReachedEndCallback);this._trickPlayObj.setUIRefreshCallback(this._uiRefreshCallback);this._trickPlayObj.registerEventListeners();if(b.app.Config.getConfigValue("faked.playback")==="true"&&(e.type==="ASSET"||e.type==="STARTOVER"||e.type==="CATCHUP")){b.app.fullScreenPlayer.requestPlayout({url:b.app.Config.getConfigValue("faked.playback.serviceUri"),isLive:false,isMusic:false,serviceId:b.app.Config.getConfigValue("faked.playback.serviceId")},true,e.contentObj,d);}else{b.app.fullScreenPlayer.requestPlayout({url:e.url,isMusic:e.isMusic||false,context:e.context,bookmark:e.bookmark},false,e.contentObj,d);}if(this._isTrailer){this._hideBannerAndClock();this._cancelBannerHide();if(this._getBannerTimeout()!==-1){this._backLabelTimeout=window.parent.setTimeout(function(){c._controller.hideBackLabel();},this._getBannerTimeout());}this._controller.showBackLabel();}else{this._showBanner();}this._hasFocus=true;};a.prototype.passivate=function(){this._cancelBannerHide();this._banner.hide();this._controller.hideBackLabel();this._stopUpdateInterval();this._finishPlayback();this._trickPlayObj.unRegisterEventListeners();this._trickPlayObj.setPlayerPlayingCallback(function(){});this._trickPlayObj.setPlayerAtBeginningCallback(function(){});this._trickPlayObj.setPlayerAtEndCallback(function(){});this._trickPlayObj.setUIRefreshCallback(function(d,c){});if(!this._playbackFinished){b.app.fullScreenPlayer.manageStream();}this._hasFocus=false;};a.prototype.focus=function(){this._hasFocus=true;b.app.ClockDisplay.hide();};a.prototype.defocus=function(){this._hasFocus=false;};a.prototype.playGivenURL=function(d){var c=d.retryCallback;b.app.fullScreenPlayer.requestPlayout({url:d.url,isMusic:d.isMusic||false,context:d.context},false,d.contentObj,c);};a.prototype._ifTrailerShowBackLabel=function(){if(this._isTrailer){this._controller.showBackLabel();}};a.prototype.keyHandler=function(c){var e=this,d=b.apps.core.KeyInterceptor.getKeyMap(),f=false;switch(c){case d.KEY_OK:case d.KEY_UP:case d.KEY_DOWN:case d.KEY_LEFT:case d.KEY_RIGHT:this._ifTrailerShowBackLabel();if(!this._banner.isVisible()){this._showBanner();}f=true;break;case d.KEY_INFO:if(this._banner.isVisible()){this._stopUpdateInterval();this._controller.hideBackLabel();this._banner.hide();}else{this._ifTrailerShowBackLabel();this._showBanner();}return true;case d.KEY_STOP:b.app.ContextHelper.closeContext();return true;case d.KEY_SKIP_REW:this._skip(-1);return true;case d.KEY_SKIP_FW:this._skip(1);return true;}if(this._trickplayEnabled){return f||this._trickPlayObj.keyHandler(c);}return f;};a.prototype._skip=function(c){if(this._skipEnabled){this._trickPlayObj.skip(this._SKIP_TIME*c);this._updateBannerPlayBackPositions();this._ifTrailerShowBackLabel();this._showBanner();}};a.prototype._stopTrickPlay=function(){var d="ff",c="rew",e=this._trickPlayObj.getTrickPlayMode();if((this._trickplayEnabled)&&(e===d||e===c)){this._trickPlayObj.pause();}};a.prototype.resetBannerTimeout=function(){var c=this;if(this._bannerTimeout){window.parent.clearTimeout(this._bannerTimeout);}if(this._getBannerTimeout()!==-1){this._bannerTimeout=window.parent.setTimeout(function(){c._stopUpdateInterval();c._clockDisplay.hide();c._controller.hideBackLabel();c._banner.hide();},this._getBannerTimeout());}};a.prototype._showBanner=function(g){var d=this,c=this._getBannerTimeout(),f,e=true;switch(g){case b.platform.output.TrickPlay.MODES.PAUSE:case b.platform.output.TrickPlay.MODES.FF:case b.platform.output.TrickPlay.MODES.RW:e=false;break;}this._cancelBannerHide();if(c!==-1&&e){f=function(){d._stopUpdateInterval();d._clockDisplay.hide();d._controller.hideBackLabel();d._banner.hide();};this._bannerTimeout=window.parent.setTimeout(f,c);}else{e=false;}if(!this._banner.isVisible()){this._startUpdateInterval();this._ifTrailerShowBackLabel();this._banner.show(e);}else{if(this._banner.setBannerTimeout){this._banner.setBannerTimeout(e);}}};a.prototype._hideBannerAndClock=function(){this._stopUpdateInterval();this._clockDisplay.hide();this._controller.hideBackLabel();this._banner.hide();};a.prototype._cancelBannerHide=function(){if(this._bannerTimeout){window.parent.clearTimeout(this._bannerTimeout);}if(this._backLabelTimeout){window.parent.clearTimeout(this._backLabelTimeout);}};a.prototype._startUpdateInterval=function(c){var d=this;this._updateBannerPlayBackPositions();if(this._updateInterval){window.parent.clearInterval(this._updateInterval);this._updateInterval=null;}if(!c){c=this._BANNER_UPDATE_INTERVAL;}this._updateInterval=window.parent.setInterval(function(){d._updateBannerPlayBackPositions();},c);};a.prototype._stopUpdateInterval=function(){if(this._updateInterval){window.parent.clearInterval(this._updateInterval);this._updateInterval=null;}};a.prototype._finishPlayback=function(c){this._playbackFinished=true;this._controller.hideBackLabel();this._stopTrickPlay();};a.prototype._updateBannerContentLength=function(){};a.prototype._updateBannerPlayBackPositions=function(){};a.prototype._updateBannerTrickPlayIndicators=function(d,c){};b.app.players.BasePlayer=a;}($N));var $N=window.parent.$N;function ImageViewer(b,a){$N.apps.core.Language.adornWithGetString(ImageViewer,"apps/mediaPlayer/common/");ImageViewer.superConstructor.call(this,b);this._log=new $N.apps.core.Log("MediaPlayer","ImageViewer");this._bannerTimeout=null;this._slideShowType=null;this._transitionEffectTypes=$N.app.constants.USBDLNA_PHOTO_TRANSITION_EFFECTS_AVAILABLE;this._container=new $N.gui.Container(b);this._clockDisplay=$N.app.ClockDisplay;this.MAX_WIDTH=1920;this.MAX_HEIGHT=1080;this._defaultAnimationOffset=1000;this._isExit=false;this._arrowTimeout=null;this._container.configure({x:0,y:0,width:this.MAX_WIDTH,height:this.MAX_HEIGHT,cssStyle:"fill: #000000"});this._createImage=function(){this._photoLayer=new $N.gui.Layer(b,this._container);this._photoAlternateLayer=new $N.gui.Layer(b,this._container);this._photo=new $N.gui.Image(b,this._photoLayer);this._photoAlternate=new $N.gui.Image(b,this._photoAlternateLayer);this._inProgressIndicator=new $N.gui.BufferIndicator(b,this._container);this._inProgressIndicator.configure({x:1820,y:50,imageWidth:48,imageHeight:48,image:"../../../customise/resources/images/net/loading.png"});this._photoLayer.configure({x:0,y:0,width:this.MAX_WIDTH,height:this.MAX_HEIGHT});this._photoAlternateLayer.configure({x:0,y:0,width:this.MAX_WIDTH,height:this.MAX_HEIGHT});this._photo.configure({x:0,y:0,width:this.MAX_WIDTH,height:this.MAX_HEIGHT,preserveAspect:true,quality:1,maxBitMapSize:$N.app.constants.MAX_IMAGE_BITMAP_SIZE});this._photoAlternate.configure({x:0,y:0,width:this.MAX_WIDTH,height:this.MAX_HEIGHT,preserveAspect:true,quality:1,maxBitMapSize:$N.app.constants.MAX_IMAGE_BITMAP_SIZE});this._photoViewer={focus:this._photo,outOfFocus:this._photoAlternate,focusLayer:this._photoLayer,outOfFocusLayer:this._photoAlternateLayer};};if($N.app.constants.BROWSER_MODE==="html"){this.exitLeft=65;}else{this.exitLeft=85;}this._PREVIOUS_X=-1920;this._NEXT_X=1920;this._pauseMode=false;this._current=null;this._next=null;this._previous=null;this._playMode=null;this._shuffleMode=false;this._BROWSE_MODE="BROWSE";this._SLIDESHOW_MODE="SLIDESHOW";this._SINGLE_IMAGE_MODE="SINGLE";this._index=null;this._slideShowTimeout=null;this._totalImages=0;this._startIndex=0;this._rootSVGRef=this._container.getRootSVGRef();this.isSlideshowStarted=false;this.banner=null;this.availableIconsForBanner=null;this.START_ICON_FOUCS_INDEX=1;if(a){a.addChild(this);}}$N.gui.Util.extend(ImageViewer,$N.gui.GUIObject);ImageViewer.prototype.initialise=function(){var b=null,a=this;this._usbMediaPlaybackListener=function(c){if(a.url[0].indexOf("file://")>=0){a.activationContext.controller.setMediaDeviceDiasbledFlag(true);if(!c.data){$N.app.ContextHelper.closeContext();}}};this._subscribeToUsbMediaPlaybackEvent=function(){b=$N.app.UsbBrowserHelper.subscribeToUsbMediaPlaybackEvent(this._usbMediaPlaybackListener,this._usbMediaPlaybackListener,this);};this._unSubscribeToUsbMediaPlaybackEvent=function(){if(b){b=$N.app.UsbBrowserHelper.unSubscribeToUsbMediaPlaybackEvent(b);b=null;}};this._onDlnaDeviceLost=function(c){if(($N.app.DlnaHelper.getMediumName()===c.device.friendlyName)&&(a.url[0].indexOf("http://")>=0)){$N.app.DialogueHelper.createAndShowDialogue($N.app.constants.DLG_DLNA_COMMUNICATION_ERROR,ImageViewer.getString("dlnaErrorTitle"),ImageViewer.getString("dlnaPlayFailMessage"));a.activationContext.controller.setMediaDeviceDiasbledFlag(true);$N.app.ContextHelper.closeContext();}};this._subscribeToDlnaDeviceLostEvent=function(){$N.app.DlnaHelper.subscribeToDeviceLostEvent(this._onDlnaDeviceLost);};this._unSubscribeToDlnaDeviceLostEvent=function(){$N.app.DlnaHelper.unSubscribeToDeviceLostEvent(this._onDlnaDeviceLost);};};ImageViewer.prototype._swapViewer=function(){if(this._photoViewer.focus===this._photo){this._photoViewer={focus:this._photoAlternate,outOfFocus:this._photo,focusLayer:this._photoAlternateLayer,outOfFocusLayer:this._photoLayer};}else{this._photoViewer={focus:this._photo,outOfFocus:this._photoAlternate,focusLayer:this._photoLayer,outOfFocusLayer:this._photoAlternateLayer};}};ImageViewer.prototype._getCurrentIndexOfData=function(){return this._current;};ImageViewer.prototype._showLoadingIndicator=function(){this._inProgressIndicator.show();};ImageViewer.prototype.activate=function(g,b){var f=this,d,a=g.selectedItemIndex,e=g.playList.length,c;this.url=null;this.banner=b;this._slideShowType=$N.platform.system.Preferences.get($N.app.constants.PREF_USBDLNA_PHOTO_TRANSITION_EFFECTS);this._subscribeToUsbMediaPlaybackEvent();this._subscribeToDlnaDeviceLostEvent();$N.app.AudioManager.mute();$N.app.fullScreenPlayer.tuner.hideVideo();this._actualUrls=[];this._formatedUrls=[];this.activationContext=g;for(c=0;c<e;c++){this._actualUrls[c]=g.playList[c];this._formatedUrls[c]=(g.playList[c].split("?"))[0];}this._shuffledUrls=$N.app.ArrayUtil.arrayShuffle(this._actualUrls);this._shuffleMode=false;this._playMode=this._SINGLE_IMAGE_MODE;this._totalImages=this._actualUrls.length;this._setIndexes(a);this.availableIconsForBanner=$N.app.constants.TRICKPLAY_ICONS_FOR_PHOTO_AUDIO_VIDEO_PLAYBACK;this.iconsList=[];if(this._totalImages>1){this._playMode=this._BROWSE_MODE;this.START_ICON_FOUCS_INDEX=1;this.iconsList=[this.availableIconsForBanner.SLIDESHOW,this.availableIconsForBanner.BACK];}else{this.START_ICON_FOUCS_INDEX=0;this.iconsList=[this.availableIconsForBanner.BACK];}this.banner.setIconsForBanner(this.iconsList);this.banner.setCurrentAndTotalTracks(String(a+1),String(this._totalImages));this.banner.setFolderName(g.folderName);this._createImageAndsetAnimationType();this._showImageAtIndexWithoutAnimation(a);this.show();this.banner.bringToFront();if(g.startSlideShow){this._startSlideshow();}else{this._showBanner();}this.banner.selectIconAtIndex(this.START_ICON_FOUCS_INDEX);};ImageViewer.prototype.passivate=function(){this._actualUrls=[];this._shuffledUrls=[];this._photoViewer.focus.setHref("");this._photoViewer.focus.setLoadSuccessful(function(){});this._photoViewer.outOfFocus.setHref("");this._photoViewer.outOfFocus.setLoadSuccessful(function(){});this._photoLayer.destroy();this._photoAlternateLayer.destroy();this._photo.destroy();this._photoAlternate.destroy();this._photoViewer.outOfFocus.destroy();this._photoViewer.focus.destroy();this._playMode=this._BROWSE_MODE;if(this.isSlideshowStarted){this._clearSlideshowTimer();}this.banner.deFocusSelectedIcon();this.banner.hide();this.hide();$N.app.ClockDisplay.hide();$N.app.AudioManager.unmute();this._unSubscribeToUsbMediaPlaybackEvent();this._unSubscribeToDlnaDeviceLostEvent();$N.app.fullScreenPlayer.tuner.showVideo();$N.app.TracksUtil.showSubtitles();};ImageViewer.prototype.focus=function(){this._isExit=false;this._showBanner();$N.app.ClockDisplay.hide();};ImageViewer.prototype.defocus=function(){if(!this._isExit){$N.app.fullScreenPlayer.tuner.hideVideo();$N.app.TracksUtil.hideSubtitles();}};ImageViewer.prototype._configureAnimation=function(c,a){var b=this;if(a){c.setId("photoLayerAni");c.setAnimationEndCallback(function(){b._waitForNextTransition();});}else{c.setId("photoLayerAltAni");}};ImageViewer.prototype._setupTransition=function(b,a){b.linked=false;a.linked=true;b.setBegin("indefinite");a.setBegin(b.getId()+".begin");};ImageViewer.prototype._createImageAndsetAnimationType=function(){switch(this._slideShowType){case this._transitionEffectTypes.SLIDE:this._createImage();this._photoLayer.addMoveAnimation();this._photoAlternateLayer.addMoveAnimation();this._configureAnimation(this._photoLayer._moveAnim,true);this._configureAnimation(this._photoAlternateLayer._moveAnim,false);break;case this._transitionEffectTypes.FADE:case this._transitionEffectTypes.CROSS_FADE:this._createImage();this._photoLayer.addFadeAnimation();this._photoAlternateLayer.addFadeAnimation();this._configureAnimation(this._photoLayer._attributeAnim.opacity,true);this._configureAnimation(this._photoAlternateLayer._attributeAnim.opacity,false);break;case this._transitionEffectTypes.ZOOM_FADE:this._createImage();this._photoLayer.addFadeAnimation();this._photoAlternateLayer.addFadeAnimation();this._configureAnimation(this._photoLayer._attributeAnim.opacity,true);this._configureAnimation(this._photoAlternateLayer._attributeAnim.opacity,false);this._photoLayer.addMoveAnimation();this._photoAlternateLayer.addMoveAnimation();this._photoLayer.addAttributeAnimation("width");this._photoLayer.addAttributeAnimation("height");this._photoAlternateLayer.addAttributeAnimation("width");this._photoAlternateLayer.addAttributeAnimation("height");this._photoLayer._attributeAnim.width.linked=true;this._photoLayer._attributeAnim.height.linked=true;this._photoLayer._moveAnim.linked=true;this._photoAlternateLayer._attributeAnim.width.linked=true;this._photoAlternateLayer._attributeAnim.height.linked=true;this._photoAlternateLayer._moveAnim.linked=true;break;case this._transitionEffectTypes.NONE:this._createImage();break;default:break;}this._photoLayer.setAnimationDuration(this._defaultAnimationOffset+"ms");this._photoAlternateLayer.setAnimationDuration(this._defaultAnimationOffset+"ms");};ImageViewer.prototype._setIndexes=function(a){this._current=a;this._next=a+1;this._previous=a-1;if(this._next>this._totalImages-1){this._next=0;}if(this._previous<0){this._previous=this._totalImages-1;}};ImageViewer.prototype._changeSlideShowEffects=function(d,b){var c=this,a=c._photoViewer.focusLayer,e=c._photoViewer.outOfFocusLayer;this._inProgressIndicator.hide();switch(c._slideShowType){case c._transitionEffectTypes.SLIDE:this._setupTransition(a._moveAnim,e._moveAnim);if(d){e.doMove(0,0,c._NEXT_X,0);a.doMove(c._PREVIOUS_X,0,0,0);}else{e.doMove(0,0,c._PREVIOUS_X,0);a.doMove(c._NEXT_X,0,0,0);}break;case c._transitionEffectTypes.FADE:this._setupTransition(a._attributeAnim.opacity,e._attributeAnim.opacity);a._attributeAnim.opacity.setValues("1; 0; 0");e._attributeAnim.opacity.setValues("0; 0; 1");a._attributeAnim.opacity.animate();break;case c._transitionEffectTypes.CROSS_FADE:this._setupTransition(a._attributeAnim.opacity,e._attributeAnim.opacity);e.doFade(1);a.doFade(0);break;case c._transitionEffectTypes.ZOOM_FADE:this._setupTransition(a._attributeAnim.opacity,e._attributeAnim.opacity);e._attributeAnim.width.setBegin("indefinite");e._attributeAnim.height.setBegin("indefinite");e._moveAnim.setBegin("indefinite");a._attributeAnim.width.setBegin(a._attributeAnim.opacity.getId()+".begin");a._attributeAnim.height.setBegin(a._attributeAnim.opacity.getId()+".begin");a._moveAnim.setBegin(a._attributeAnim.opacity.getId()+".begin");e.setAttribute("width",1280);e.setAttribute("height",720);a.doAttributeAnimation("width",1600);a.doAttributeAnimation("height",900);a.doMove(-240,-135,0,0);e.doFade(1);a.doFade(0);break;case c._transitionEffectTypes.NONE:c._photoViewer.focus.hide();c._photoViewer.outOfFocus.show();c._waitForNextTransition();break;default:break;}c._swapViewer();c.banner.updateCurrentTrack(b+1);};ImageViewer.prototype._exitPlayer=function(){var a=this;if(a.isSlideshowStarted){a._clearSlideshowTimer();}$N.app.ContextHelper.closeContext();};ImageViewer.prototype.setImageName=function(a){this.banner.setImageName(a);};ImageViewer.prototype._showImageAtIndexWithoutAnimation=function(a){var b=this,c;this.url=(this._shuffleMode)?this._shuffledUrls[a]:this._actualUrls[a];c=this.activationContext.controller.getMetaDataForUrl(this.url);this.setImageName(c.itemDetails[0].fileName);if(c.itemDetails[0]){this._setActualImageWidthHeight(c.itemDetails[0].width,c.itemDetails[0].height);}this.url=this.url.split("?");this._photoViewer.outOfFocus.setHref("");this._photoViewer.outOfFocus.setHref(this.url[0]);this._photoViewer.outOfFocus.setLoadSuccessful(function(){b._inProgressIndicator.hide();});this._photoViewer.outOfFocus.setLoadFailedCallback(function(){b._exitPlayer();});this._swapViewer();this._setIndexes(a);};ImageViewer.prototype._showImageAtIndex=function(b){var c=this,a,e,d;this._showLoadingIndicator();if(this._shuffleMode){this.url=this._shuffledUrls[b];this.url=this.url.split("?");b=this._getActualListIndex();}else{this.url=this._actualUrls[b];d=this.activationContext.controller.getMetaDataForUrl(this.url);this.url=this.url.split("?");}if(d.itemDetails[0]){this._setActualImageWidthHeight(d.itemDetails[0].width,d.itemDetails[0].height);}this._photoViewer.outOfFocus.setHref("");this._photoViewer.outOfFocus.setHref(this.url[0]);this._photoViewer.outOfFocus.setLoadSuccessful(function(){c._changeSlideShowEffects(true,b);c.setImageName(d.itemDetails[0].fileName);});this._photoViewer.outOfFocus.setLoadFailedCallback(function(){c._exitPlayer();});this._setIndexes(b);};ImageViewer.prototype._animateToNext=function(b){var c=this,a,e,d;this._showLoadingIndicator();if(this._shuffleMode){this.url=this._shuffledUrls[b];d=this.activationContext.controller.getMetaDataForUrl(this.url);this.url=this.url.split("?");e=this._getActualListIndex();}else{a=this._getActualListIndex();b=a+1;if(b>this._totalImages-1){b=0;}this.url=this._actualUrls[b];e=b;d=this.activationContext.controller.getMetaDataForUrl(this.url);this.url=this.url.split("?");}if(d.itemDetails[0]){this._setActualImageWidthHeight(d.itemDetails[0].width,d.itemDetails[0].height);}this._photoViewer.outOfFocus.setHref("");this._photoViewer.outOfFocus.setHref(this.url[0]);this._photoViewer.outOfFocus.setLoadSuccessful(function(){c._changeSlideShowEffects(true,e);c.setImageName(d.itemDetails[0].fileName);});this._photoViewer.outOfFocus.setLoadFailedCallback(function(){c._exitPlayer();});this._setIndexes(this._next);};ImageViewer.prototype._animateToPrevious=function(d){var b=this,a,e,c;this._showLoadingIndicator();if(this._shuffleMode){this.url=this._shuffledUrls[d];c=this.activationContext.controller.getMetaDataForUrl(this.url);this.url=this.url.split("?");e=this._getActualListIndex();}else{a=this._getActualListIndex();d=a-1;if(d<0){d=this._totalImages-1;}this.url=this._actualUrls[d];e=d;c=this.activationContext.controller.getMetaDataForUrl(this.url);this.url=this.url.split("?");}if(c.itemDetails[0]){this._setActualImageWidthHeight(c.itemDetails[0].width,c.itemDetails[0].height);}this._photoViewer.outOfFocus.setHref("");this._photoViewer.outOfFocus.setHref(this.url[0]);this._photoViewer.outOfFocus.setLoadSuccessful(function(){b._changeSlideShowEffects(false,e);b.setImageName(c.itemDetails[0].fileName);});this._photoViewer.outOfFocus.setLoadFailedCallback(function(){b._exitPlayer();});this._setIndexes(this._previous);};ImageViewer.prototype._setActualImageWidthHeight=function(b,a){var d=0,c=0;if(b===null||a===null){b=this.MAX_WIDTH;a=this.MAX_HEIGHT;}else{if(a<this.MAX_HEIGHT&&b>=this.MAX_WIDTH){d=0;c=(this.MAX_HEIGHT-a)/2;b=this.MAX_WIDTH;}else{if(a>=this.MAX_HEIGHT&&b<this.MAX_WIDTH){d=(this.MAX_WIDTH-b)/2;c=0;a=this.MAX_HEIGHT;}else{if(a<this.MAX_HEIGHT&&b<this.MAX_WIDTH){d=(this.MAX_WIDTH-b)/2;c=(this.MAX_HEIGHT-a)/2;}else{b=this.MAX_WIDTH;a=this.MAX_HEIGHT;}}}}if(this._photoViewer.focus===this._photo){this._photoAlternate.setX(d);this._photoAlternate.setY(c);this._photoAlternate.setWidth(b);this._photoAlternate.setHeight(a);}else{this._photo.setX(d);this._photo.setY(c);this._photo.setWidth(b);this._photo.setHeight(a);}};ImageViewer.prototype._getActualListIndex=function(){return this._formatedUrls.indexOf(this.url[0]);};ImageViewer.prototype._clearSlideshowTimer=function(){if(this._slideShowTimeout){this.isSlideshowStarted=false;clearTimeout(this._slideShowTimeout);this.banner.toggleSlideShowIcon(false);}};ImageViewer.prototype._startSlideshow=function(a){var b=this;this.isSlideshowStarted=true;this.banner.toggleSlideShowIcon(true);if(a){this._showImageAtIndex(this._startIndex);}this._slideShowTimeout=setTimeout(function(){b._animateToNext(b._next);},this._getSlideShowDuration());};ImageViewer.prototype._waitForNextTransition=function(){var a=this;if(this.isSlideshowStarted){this._slideShowTimeout=setTimeout(function(){a._animateToNext(a._next);},this._getSlideShowDuration());}};ImageViewer.prototype._toggleShuffleMode=function(){if(this._shuffleMode){this._shuffleMode=false;this.banner.toggleShuffleIconAndLabel(false);}else{this._shuffleMode=true;this.banner.toggleShuffleIconAndLabel(true);}};ImageViewer.prototype._cancelBannerHide=function(){if(this._bannerTimeout){window.parent.clearTimeout(this._bannerTimeout);}};ImageViewer.prototype._getSlideShowDuration=function(){return(($N.platform.system.Preferences.get($N.app.constants.PREF_USBDLNA_PHOTO_DISPLAY_DURATION))*1000);};ImageViewer.prototype._getBannerTimeout=function(){return(($N.platform.system.Preferences.get($N.app.constants.PREF_USBDLNA_PLAYER_BANNER_TIMEOUT))*1000);};ImageViewer.prototype._showBanner=function(){var a=this;this._cancelBannerArrowHide();this.banner.show();this._cancelBannerHide();this._bannerTimeout=window.parent.setTimeout(function(){a.banner.hide();},this._getBannerTimeout());};ImageViewer.prototype._cancelBannerArrowHide=function(){if(this._arrowTimeout){window.parent.clearTimeout(this._arrowTimeout);this._arrowTimeout=null;}};ImageViewer.prototype._getBannerArrowTimeout=function(){return 5000;};ImageViewer.prototype._showArrows=function(){var a=this;this.banner.showArrows();this._cancelBannerArrowHide();this._arrowTimeout=window.parent.setTimeout(function(){a.banner.hide();},this._getBannerArrowTimeout());};ImageViewer.prototype.okPressedHandler=function(){var a,b=$N.apps.core.KeyInterceptor.getKeyMap();if(this.banner.isVisible()){switch(this.iconsList[this.banner.getSelectedIndex()]){case this.availableIconsForBanner.SLIDESHOW:a=b.KEY_PLAY;break;case this.availableIconsForBanner.BACK:a=b.KEY_BACK;break;}this.keyHandler(a);}else{this.banner.show();}};ImageViewer.prototype.keyHandler=function(a){var c=this,d=false,b=$N.apps.core.KeyInterceptor.getKeyMap();if(this._playMode===this._BROWSE_MODE){switch(a){case b.KEY_OK:this.okPressedHandler();this._showBanner();break;case b.KEY_RIGHT:case b.KEY_FFW:if(this._totalImages>1){if(!this.banner.isVisible()||this._arrowTimeout){this._showArrows();}else{this._showBanner();}this.banner.highlightRightArrow();if(this.isSlideshowStarted){clearTimeout(this._slideShowTimeout);}this._animateToNext(this._next);}d=true;break;case b.KEY_LEFT:case b.KEY_REW:if(this._totalImages>1){if(!this.banner.isVisible()||this._arrowTimeout){this._showArrows();}else{this._showBanner();}this.banner.highlightLeftArrow();if(this.isSlideshowStarted){clearTimeout(this._slideShowTimeout);}this._animateToPrevious(this._previous);}d=true;break;case b.KEY_PLAY:case b.KEY_PLAY_PAUSE:this._showBanner();if(!this.isSlideshowStarted){this._startSlideshow();}else{this._clearSlideshowTimer();}d=true;break;case b.KEY_STOP:this._showBanner();this.banner.updateFocusForIcon(this.availableIconsForBanner.STOP);if(this.isSlideshowStarted){this._clearSlideshowTimer();}$N.app.ContextHelper.closeContext();d=true;break;case b.KEY_UP:if(this.banner.isVisible()){this._showBanner();this.banner.selectPrevious();}else{this._showBanner();}d=true;break;case b.KEY_DOWN:if(this.banner.isVisible()){if(this.banner.getSelectedIndex()>=this.iconsList.length-1){this.banner.hide();}else{this._showBanner();this.banner.selectNext();}}d=true;break;case b.KEY_INFO:this._showBanner();d=true;break;case b.KEY_BACK:if(this.isSlideshowStarted){this._clearSlideshowTimer();}$N.app.ContextHelper.closeContext();d=true;break;case b.KEY_EXIT:if(this.isSlideshowStarted){this._clearSlideshowTimer();}this._isExit=true;$N.app.ContextHelper.exitContext();d=true;break;}}else{if(this._playMode===this._SINGLE_IMAGE_MODE){switch(a){case b.KEY_OK:case b.KEY_BACK:$N.app.ContextHelper.closeContext();d=true;break;case b.KEY_EXIT:this._isExit=true;$N.app.ContextHelper.exitContext();d=true;break;case b.KEY_UP:this._showBanner();d=true;break;case b.KEY_DOWN:this.banner.hide();d=true;break;}}}if(!d){switch(a){case b.KEY_VOL_UP:case b.KEY_VOL_DOWN:case b.KEY_MUTE:d=true;break;case b.KEY_RADIO:case b.KEY_MOSAIC:case b.KEY_POWER:case b.KEY_VOD:case b.KEY_TV:$N.app.ContextHelper.closeContext();break;}}return d;};var $N=window.parent.$N;$N.app=$N.app||{};$N.app.players=$N.app.players||{};(function(a){function b(d,c,e,f){a.apps.core.Language.adornWithGetString(b,"apps/mediaPlayer/common/");b.superConstructor.call(this,c);this._log=new a.apps.core.Log("MediaPlayer","MusicPlayer");this._controller=d;this._fullscreenPlayer=f;this.thumbnailImage=e;this._startPosition=0;this._isStopPressed=false;this._speedIndicatorTimeout=null;this.START_ICON_FOUCS_INDEX=5;this._playMode=null;this._counter=0;}a.apps.util.Util.extend(b,a.app.players.BasePlayer);b.prototype.initialise=function(){var c=this,d;b.superClass.initialise.call(this);this._failureCallback=function(h){if(h.contentErrorInfo){var f=a.app.constants.CA_PLAY_ERRORS.contentErrorReason.CONTENT_ERROR_REASON_STREAM_WRONG_TYPE,g=a.app.constants.CA_PLAY_ERRORS.contentErrorReason.CONTENT_ERROR_REASON_STREAM_CODEC_NOT_FOUND;if((h.contentErrorInfo.reason===f)||(h.contentErrorInfo.reason===g)){a.app.DialogueHelper.createAndShowDialogue(a.app.constants.DLG_DLNA_COMMUNICATION_ERROR,b.getString("playerErrorTitle"),b.getString("playerAudioErrorMessage"));}}a.app.fullScreenPlayer.jumpToLive();a.app.ContextHelper.closeContext();};this._playerReachedEndCallback=function(){c._endOfPlayback();};this._playerConnectedListener=function(){if(c._startPosition){a.app.fullScreenPlayer.tuner.hideVideo();setTimeout(function(){a.app.fullScreenPlayer.setPlaybackPosition(c._startPosition);a.app.fullScreenPlayer.tuner.showVideo();},100);}c._updateBannerPlayBackPositions();};this._usbMediaPlaybackListener=function(e){if(c.activationContext.url.indexOf("file://")>=0){a.app.fullScreenPlayer.jumpToLive();c.activationContext.controller.setMediaDeviceDiasbledFlag(true);if(!e.data){a.app.ContextHelper.closeContext();}}};this._subscribeToUsbMediaPlaybackEvent=function(){d=a.app.UsbBrowserHelper.subscribeToUsbMediaPlaybackEvent(this._usbMediaPlaybackListener,this._usbMediaPlaybackListener,this);};this._unSubscribeToUsbMediaPlaybackEvent=function(){d=a.app.UsbBrowserHelper.unSubscribeToUsbMediaPlaybackEvent(d);};this._onDlnaDeviceLost=function(f){if((a.app.DlnaHelper.getMediumName()===f.device.friendlyName)&&(c.activationContext.url.indexOf("dlna://")>=0)){a.app.DialogueHelper.createAndShowDialogue(a.app.constants.DLG_DLNA_COMMUNICATION_ERROR,b.getString("dlnaErrorTitle"),b.getString("dlnaPlayFailMessage"));a.app.fullScreenPlayer.jumpToLive();c.activationContext.controller.setMediaDeviceDiasbledFlag(true);a.app.ContextHelper.closeContext();}};this._subscribeToDlnaDeviceLostEvent=function(){a.app.DlnaHelper.subscribeToDeviceLostEvent(this._onDlnaDeviceLost);};this._unSubscribeToDlnaDeviceLostEvent=function(){a.app.DlnaHelper.unSubscribeToDeviceLostEvent(this._onDlnaDeviceLost);};};b.prototype._setIndexes=function(c){this._current=c;this._next=c+1;this._previous=c-1;if(this._next>this._totalTracks-1){this._next=0;}if(this._previous<0){this._previous=this._totalTracks-1;}};b.prototype.activate=function(h){var f=null,c,e,g,d={};this._fullscreenPlayer.show();this._startPosition=0;this._counter=0;this.activationContext=h;f=h.playList.length;this._actualUrls=[];this.iconsList=[];for(e=0;e<f;e++){this._actualUrls[e]=h.playList[e];}this._shuffledUrls=a.app.ArrayUtil.arrayShuffle(this._actualUrls);this._shuffleMode=false;this._repeatMode=false;this._totalTracks=this._actualUrls.length;c=(h.selectedItemIndex===undefined)?0:h.selectedItemIndex;d.shuffleModeEnabled=false;if(h.isPlayShuffleEnabled){this._shuffleMode=true;c=0;d.shuffleModeEnabled=true;}this.availableIconsForBanner=a.app.constants.TRICKPLAY_ICONS_FOR_PHOTO_AUDIO_VIDEO_PLAYBACK;if(this._totalTracks>1){this.START_ICON_FOUCS_INDEX=4;this.iconsList=[this.availableIconsForBanner.STOP,this.availableIconsForBanner.SHUFFLE,this.availableIconsForBanner.PREVIOUS,this.availableIconsForBanner.PLAY,this.availableIconsForBanner.NEXT,this.availableIconsForBanner.PROGRESSBAR];}else{this.START_ICON_FOUCS_INDEX=1;this.iconsList=[this.availableIconsForBanner.STOP,this.availableIconsForBanner.PLAY,this.availableIconsForBanner.PROGRESSBAR];}h.url=this._shuffleMode?this._shuffledUrls[c]:this._actualUrls[c];this.activationContext.url=h.url;c=this._getActualListIndex();this._setIndexes(c);this._banner.setIconsForBanner(this.iconsList,d);this._banner.setCurrentAndTotalTracks(String(c+1),String(this._totalTracks));this._showBanner();this._startUpdateInterval();this._banner.selectIconAtIndex(this.START_ICON_FOUCS_INDEX);this._subscribeToUsbMediaPlaybackEvent();this._subscribeToDlnaDeviceLostEvent();a.app.fullScreenPlayer.registerPlayerConnectedListener(this._playerConnectedListener);a.app.fullScreenPlayer.registerPlayerConnectFailedListener(this._failureCallback);a.app.fullScreenPlayer.registerPlayerPlayFailedListener(this._failureCallback);this._trickPlayObj.setDirectMode(true);b.superClass.activate.call(this,h);this.thumbnailImage.setDefaultThumbnailUrl(h.defaultThumbnailUrl);g=this.activationContext.controller.getMetaDataForUrl(h.url);this.thumbnailImage.activate(g);};b.prototype.passivate=function(){this._finishPlayback();a.app.fullScreenPlayer.jumpToLive();this._banner.deFocusSelectedIcon();if(this._repeatMode){this._banner.toggleRepeatIconAndLabel(false);}b.superClass.passivate.call(this);this._fullscreenPlayer.hide();this.thumbnailImage.passivate();this._unSubscribeToUsbMediaPlaybackEvent();this._unSubscribeToDlnaDeviceLostEvent();a.app.fullScreenPlayer.unregisterPlayerConnectedListener(this._playerConnectedListener);a.app.fullScreenPlayer.unregisterPlayerConnectFailedListener(this._failureCallback);a.app.fullScreenPlayer.unregisterPlayerPlayFailedListener(this._failureCallback);a.app.ClockDisplay.hide();};b.prototype.focus=function(){this._showBanner();a.app.ClockDisplay.hide();};b.prototype._playNextTrack=function(d){if(this._totalTracks>1){var c,e;this._counter=0;if(this._shuffleMode){this.activationContext.url=this._shuffledUrls[d];e=this._getActualListIndex();}else{c=this._getActualListIndex();d=c+1;if(d>this._totalTracks-1){d=0;}this.activationContext.url=this._actualUrls[d];e=d;}this.playGivenURL(this.activationContext);this._banner.updateCurrentTrack(e+1);this._setIndexes(this._next);this._updateThumbnailMetadata(d);}};b.prototype._playPreviousTrack=function(e){if(this._totalTracks>1){var c,f,d=a.app.fullScreenPlayer.getPlaybackPosition();if(this._counter<1||d>=4){if(d>=4){this._counter=1;this._restartCurrentTrack();return;}}this._counter=0;if(this._shuffleMode){this.activationContext.url=this._shuffledUrls[e];f=this._getActualListIndex();}else{c=this._getActualListIndex();e=c-1;if(e<0){e=this._totalTracks-1;}this.activationContext.url=this._actualUrls[e];f=e;}this.playGivenURL(this.activationContext);this._banner.updateCurrentTrack(f+1);this._setIndexes(this._previous);this._updateThumbnailMetadata(e);}};b.prototype._endOfPlayback=function(){this._counter=0;if(this._repeatMode){this._restartCurrentTrack();}else{if(this._totalTracks>1){this._playNextTrack(this._next);}else{a.app.ContextHelper.closeContext();}}};b.prototype._restartCurrentTrack=function(){var c=this._trickPlayObj.getTrickPlayMode();if(c==="pause"){this._trickPlayObj.play();}a.app.fullScreenPlayer.setPlaybackPosition(0);this._trickPlayObj.play();this._updateBannerPlayBackPositions();};b.prototype._updateThumbnailMetadata=function(c){var d;if(this._shuffleMode){c=this._actualUrls.indexOf(this.activationContext.url);}d=this.activationContext.controller.getMetaDataForUrl(this.activationContext.url);this.thumbnailImage.activate(d);};b.prototype._getActualListIndex=function(){return this._actualUrls.indexOf(this.activationContext.url);};b.prototype._toggleShuffleMode=function(){if(this._shuffleMode){this._shuffleMode=false;this._banner.toggleShuffleIconAndLabel(this._shuffleMode);}else{this._shuffleMode=true;this._banner.toggleShuffleIconAndLabel(this._shuffleMode);}};b.prototype._toggleRepeatMode=function(){if(this._repeatMode){this._repeatMode=false;this._banner.toggleRepeatIconAndLabel(this._repeatMode);}else{this._repeatMode=true;this._banner.toggleRepeatIconAndLabel(this._repeatMode);}};b.prototype._updateBannerPlayBackPositions=function(){var d=a.app.fullScreenPlayer.getPlaybackPosition(),c=a.app.fullScreenPlayer.getContentLength();this._banner.updateProgressBar(d,c);if(c){this._banner.setProgressBarStartEnd(this._getContentLengthText(d),this._getContentLengthText(c));}};b.prototype._updateBannerTrickPlayIndicators=function(d,c){if(c===0){this._cancelBannerHide();this._stopUpdateInterval();this._banner.togglePlayPauseIcon(false);this.thumbnailImage.clearThumbnailAnimationTimer();}else{this._startUpdateInterval();this._banner.togglePlayPauseIcon(true);this.thumbnailImage.restartThumbnailAnimation();}};b.prototype._cancelBannerHide=function(){if(this._bannerTimeout){window.parent.clearTimeout(this._bannerTimeout);}};b.prototype._getBannerTimeout=function(){return((a.platform.system.Preferences.get(a.app.constants.PREF_USBDLNA_PLAYER_BANNER_TIMEOUT))*1000);};b.prototype._showBanner=function(){var c=this;if(!this._banner.isVisible()){this._banner.show();}this._cancelBannerHide();this._bannerTimeout=window.parent.setTimeout(function(){c._banner.hide();},this._getBannerTimeout());};b.prototype.okPressedHandler=function(){var c,d=a.apps.core.KeyInterceptor.getKeyMap();if(this._banner.isVisible()){switch(this.iconsList[this._banner.getSelectedIndex()]){case this.availableIconsForBanner.STOP:c=d.KEY_STOP;break;case this.availableIconsForBanner.REPEAT:this._showBanner();this._toggleRepeatMode();break;case this.availableIconsForBanner.PREVIOUS:this._playPreviousTrack(this._previous);break;case this.availableIconsForBanner.PLAY:c=d.KEY_PLAY_PAUSE;break;case this.availableIconsForBanner.SHUFFLE:this._toggleShuffleMode();break;case this.availableIconsForBanner.NEXT:this._playNextTrack(this._next);break;case this.availableIconsForBanner.FWD:c=d.KEY_FFW;break;case this.availableIconsForBanner.RWD:c=d.KEY_REW;break;case this.availableIconsForBanner.REPLAY:c=d.KEY_REPLAY;break;}this.keyHandler(c);}else{this._showBanner();}};b.prototype.keyHandler=function(c){var e=a.apps.core.KeyInterceptor.getKeyMap(),d=this,f=null;switch(c){case e.KEY_LEFT:if(this._banner.isVisible()){this._banner.selectPrevious();}this._showBanner();break;case e.KEY_RIGHT:if(this._banner.isVisible()){this._banner.selectNext();}this._showBanner();break;case e.KEY_OK:this.okPressedHandler();this._showBanner();break;case e.KEY_DOWN:this._banner.hide();return true;case e.KEY_FFW:this._showBanner();this._banner.updateFocusForIcon(this.availableIconsForBanner.NEXT);this._playNextTrack(this._next);return true;case e.KEY_REW:this._showBanner();this._banner.updateFocusForIcon(this.availableIconsForBanner.PREVIOUS);this._playPreviousTrack(this._previous);return true;case e.KEY_PLAY_PAUSE:this._showBanner();this._banner.updateFocusForIcon(this.availableIconsForBanner.PLAY);break;case e.KEY_STOP:case e.KEY_BACK:a.app.ContextHelper.closeContext();return true;case e.KEY_EXIT:a.app.ContextHelper.exitContext();return true;case e.KEY_RADIO:case e.KEY_MOSAIC:case e.KEY_POWER:case e.KEY_VOD:case e.KEY_TV:a.app.ContextHelper.closeContext();break;default:this._isStopPressed=false;break;}b.superClass.keyHandler.call(this,c);};a.app.players.MusicPlayer=b;}($N));var $N=window.parent.$N;$N.app=$N.app||{};$N.app.players=$N.app.players||{};(function(b){function a(d,c,f,e){a.superConstructor.call(this,c);this._log=new b.apps.core.Log("MediaPlayer","OnDemandPlayer");this._controller=d;this._fullscreenPlayer=f;this._loadingBar=e;this._startPosition=0;this.PLAY_SPEED=100;this.PAUSE_SPEED=0;this.SPEED_REW_MULTIPLIERS=[100,200,400,800,1600,3200,6400];this.SPEED_FFW_MULTIPLIERS=[200,400,800,1600,3200,6400];this.STOP_INDEX=0;this.REPLAY_INDEX=1;this.REW_INDEX=2;this.PLAY_PAUSE_INDEX=3;this.FFW_INDEX=4;this._speedIndicatorTimeout=null;this._cachedBanner=null;this._isStartOver=false;this._activationContext=null;this.RECORD_GAP_SECONDS=300;this._playbackCompleteCallback=function(){};this._moreInfoCallback=function(){};}b.apps.util.Util.extend(a,b.app.players.BasePlayer);a.prototype.initialise=function(){var c=this;a.superClass.initialise.call(this);this._failureCallback=function(){};this._playErrorCallback=function(d){};this._streamStartedListener=function(){};this._playerReachedEndCallback=function(){b.app.ContextHelper.closeContext();};this._playerConnectedListener=function(){c._updateBannerPlayBackPositions();};b.apps.core.Language.adornWithGetString(b.app.players.OnDemandPlayer);};a.prototype._setupForStartOver=function(c){var d="";if(this._activationContext.contentObj&&this._activationContext.contentObj.displaySeasonEpisode===true){d=b.app.epgUtil.getSeasonEpisodeAbbreviation(this._activationContext.contentObj.seriesId,this._activationContext.contentObj.episodeId);}this._cachedBanner=this._banner;this._isStartOver=true;this._banner=c;this.RETURN_TO_LIVE_INDEX=0;this.STOP_INDEX=null;this.REPLAY_INDEX=null;this.REW_INDEX=1;this.PLAY_PAUSE_INDEX=2;this.FFW_INDEX=3;this._banner.setStopKeyText(this._controller.getString("live"));this._banner.setEventNameText(this._activationContext.title,d);this._banner.resetProgressBarPositon();};a.prototype.activate=function(e,c){var d=this;this._activationContext=e;if(e.type==="STARTOVER"&&c){this._setupForStartOver(c);}else{this._tearDownForStartOver();}this._loadingBar.setText(b.app.players.OnDemandPlayer.getString("preparingVideo"));this._loadingBar.setLoading(true);if(e.successCallback){this._streamStartedListener=function(){d._loadingBar.setLoading(false);e.successCallback();b.app.fullScreenPlayer.unregisterPlayerConnectedListener(d._streamStartedListener);};}else{this._streamStartedListener=function(){d._loadingBar.setLoading(false);b.app.fullScreenPlayer.unregisterPlayerConnectedListener(d._streamStartedListener);};}b.app.fullScreenPlayer.registerPlayerConnectedListener(this._streamStartedListener);if(e.failureCallback){this._failureCallback=e.failureCallback;}b.app.fullScreenPlayer.registerPlayerConnectFailedListener(this._failureCallback);if(e.playbackCompleteCallback){this._playbackCompleteCallback=e.playbackCompleteCallback;}if(e.moreInfoCallback){this._moreInfoCallback=e.moreInfoCallback;}b.app.fullScreenPlayer.registerPlayerReachedEndListener(this._playerReachedEndCallback);if(e.playErrorCallback){this._playErrorCallback=e.playErrorCallback;}b.app.fullScreenPlayer.registerPlayErrorListener(this._playErrorCallback);this._trickPlayObj.setDirectMode(true);this._fullscreenPlayer.show();this._startPosition=e.bookmark||0;this._banner.setProgressBarStartEnd(this._getContentLengthText(this._startPosition),this._getContentLengthText(b.app.fullScreenPlayer.getContentLength()));this._banner.show();b.app.fullScreenPlayer.registerPlayerConnectedListener(this._playerConnectedListener);a.superClass.activate.call(this,e);this._updateBannerPlayBackPositions();this._startUpdateInterval();};a.prototype._tearDownForStartOver=function(){this._isStartOver=false;if(this._cachedBanner){this._banner=this._cachedBanner;this._cachedBanner=null;}this.RETURN_TO_LIVE_INDEX=null;this.STOP_INDEX=0;this.REPLAY_INDEX=1;this.REW_INDEX=2;this.PLAY_PAUSE_INDEX=3;this.FFW_INDEX=4;};a.prototype.passivate=function(){this._loadingBar.setLoading(false);b.app.fullScreenPlayer.unregisterPlayerConnectedListener(this._streamStartedListener);a.superClass.passivate.call(this);b.app.fullScreenPlayer.unregisterPlayerConnectedListener(this._playerConnectedListener);b.app.fullScreenPlayer.unregisterPlayerConnectFailedListener(this._failureCallback);b.app.fullScreenPlayer.unregisterPlayerReachedEndListener(this._playerReachedEndCallback);b.app.fullScreenPlayer.unregisterPlayErrorListener(this._playErrorCallback);if(this._isStartOver){this._tearDownForStartOver();}};a.prototype._showStopPlaybackBanner=function(c,d){var f=this,g=function(){f._banner.select(f.STOP_INDEX||f.RETURN_TO_LIVE_INDEX);f._showBanner();},h=function(i){if(i&&i.action===b.app.constants.YES_OPTION){g();setTimeout(function(){if(d){b.app.ContextHelper.exitContext();}else{b.app.ContextHelper.closeContext();}},100);}else{f._trickPlayObj.play();}},e=function(i){if(i&&i.action===b.app.constants.YES_OPTION){g();setTimeout(function(){var k=f._activationContext&&f._activationContext.contentObj?f._activationContext.contentObj:null,l=k&&k.serviceId?k.serviceId:0,j=null;if(f._isStartOver&&l){j=b.app.epgUtil.getServiceById(l);j.showBanner=true;b.app.ContextHelper.openContext("ZAPPER",{activationContext:j});}else{b.app.ContextHelper.closeContext();}},100);}else{f._trickPlayObj.play();}};this._trickPlayObj.pause();if(this._isStartOver){b.app.DialogueHelper.createAndShowDialogue(b.app.constants.DLG_STOP_RECORDING_PLAYBACK,b.app.players.OnDemandPlayer.getString("stopRecordingPlaybackTitle"),b.app.players.OnDemandPlayer.getString("stopRecordingPlaybackMessage"),[{name:b.app.players.OnDemandPlayer.getString("yes"),action:b.app.constants.YES_OPTION},{name:b.app.players.OnDemandPlayer.getString("no"),action:b.app.constants.NO_OPTION}],function(i){if(c){e(i);}else{h(i);}});}else{b.app.DialogueHelper.showNowDialog(b.app.players.OnDemandPlayer.getString("stopRecordingPlaybackTitle"),b.app.players.OnDemandPlayer.getString("stopRecordingPlaybackMessage"),[{name:b.app.players.OnDemandPlayer.getString("yes"),action:function(){if(c){e({action:b.app.constants.YES_OPTION});}else{h({action:b.app.constants.YES_OPTION});}}},{name:b.app.players.OnDemandPlayer.getString("no")}],null,null,function(){f._trickPlayObj.play();});}};a.prototype.okPressedHandler=function(){var c,d=b.apps.core.KeyInterceptor.getKeyMap();if(this._banner.isVisible()){switch(this._banner.getSelectedIndex()){case this.RETURN_TO_LIVE_INDEX:this._showStopPlaybackBanner(true);return;case this.STOP_INDEX:c=d.KEY_STOP;break;case this.REPLAY_INDEX:c=d.KEY_REPLAY;break;case this.REW_INDEX:c=d.KEY_REW;break;case this.PLAY_PAUSE_INDEX:c=d.KEY_PLAY_PAUSE;break;case this.FFW_INDEX:c=d.KEY_FFW;break;}this.keyHandler(c);}else{this._showBanner();}};a.prototype.trickplayKeyHandler=function(c){var d=this._trickPlayObj.getTrickPlayMode();if((!c&&d==="rew")||(c&&d==="ff")){this._trickPlayObj.play();}else{this._trickPlayObj.setAllowSpeedCycle(false);if(c){this._trickPlayObj.setPlayRateMultipliers(this.SPEED_REW_MULTIPLIERS);this._banner.select(this.REW_INDEX);}else{this._trickPlayObj.setPlayRateMultipliers(this.SPEED_FFW_MULTIPLIERS);this._banner.select(this.FFW_INDEX);}}};a.prototype.keyHandler=function(c){var e=b.apps.core.KeyInterceptor.getKeyMap(),d=this,f=0;switch(c){case e.KEY_INFO:case e.KEY_RED:if(this._moreInfoCallback){this._moreInfoCallback();}break;case e.KEY_LEFT:if(this._banner.isVisible()){this._banner.selectPrevious();}break;case e.KEY_RIGHT:if(this._banner.isVisible()){this._banner.selectNext();}break;case e.KEY_OK:this.okPressedHandler();break;case e.KEY_DOWN:this._banner.hide();return true;case e.KEY_EXIT:case e.KEY_BACK:if(this._banner.isVisible()){this._banner.hide();}else{this._showStopPlaybackBanner(null,c===e.KEY_EXIT);}return true;case e.KEY_STOP:this._showStopPlaybackBanner();return true;case e.KEY_FFW:this.trickplayKeyHandler(false);break;case e.KEY_REW:this.trickplayKeyHandler(true);break;case e.KEY_PLAY_PAUSE:this._banner.select(this.PLAY_PAUSE_INDEX);break;case e.KEY_REPLAY:this._banner.select(this.REPLAY_INDEX);this._showBanner();if(this._isStartOver){f=b.app.fullScreenPlayer.getPlaybackPosition()-10;if(f<0){f=0;}}this._banner.setSpeedIndicatorText("");setTimeout(function(){b.app.fullScreenPlayer.setPlaybackPosition(f);d._banner.select(d.PLAY_PAUSE_INDEX);d._updateBannerPlayBackPositions(f);},250);return true;case e.KEY_UP:if(this._banner.isVisible()){b.app.ContextHelper.openContext("MINIGUIDE",{activationContext:{showBanner:true,hideBanner:false,inTrickplayMode:true}});}else{this._showBanner();}return true;}return a.superClass.keyHandler.call(this,c);};a.prototype._updateBannerPlayBackPositions=function(d){var g=d||b.app.fullScreenPlayer.getPlaybackPosition(),e=b.app.fullScreenPlayer.getContentLength(),h=this._activationContext.contentObj.type,f=this._activationContext.contentObj.endTime-Date.now(),c=e-(f/1000);if(h&&h==="STARTOVER"){this._banner.updateProgressBar(0,e+this.RECORD_GAP_SECONDS,0,c+this.RECORD_GAP_SECONDS,g);this._banner.setProgressBarStartEnd(this._activationContext.contentObj.startTime-(this.RECORD_GAP_SECONDS*1000),this._activationContext.contentObj.endTime+(this.RECORD_GAP_SECONDS*1000));}else{this._banner.updateProgressBar(g,e);this._banner.setProgressBarStartEnd(this._getContentLengthText(g),this._getContentLengthText(e));}};a.prototype._clearSpeedIndicatorTimer=function(){clearTimeout(this._speedIndicatorTimeout);};a.prototype.setHideSpeedIndicatorTimer=function(){var c=this;this._clearSpeedIndicatorTimer();this._speedIndicatorTimeout=setTimeout(function(){c._banner.setSpeedIndicatorText("");},500);};a.prototype._updateBannerTrickPlayIndicators=function(d,c){this._banner.hideSpeedIndicator();if(this._isStartOver===true){this._banner.setSpeedIndicatorX(d);}switch(c){case this.PAUSE_SPEED:this._banner.togglePlayPauseIcon(false);this._banner.select(this.PLAY_PAUSE_INDEX);break;case this.PLAY_SPEED:this._banner.togglePlayPauseIcon(true);this._banner.select(this.PLAY_PAUSE_INDEX);this._banner.setSpeedIndicatorText("x1");this.setHideSpeedIndicatorTimer();if(this._isStartOver===false){this._banner.setSpeedIndicatorX(this.PLAY_PAUSE_INDEX);}this._banner.showSpeedIndicator();break;default:this._clearSpeedIndicatorTimer();this._banner.togglePlayPauseIcon(false);this._banner.setSpeedIndicatorText("x"+String(Math.abs(c)/100));if(this._isStartOver===false){this._banner.setSpeedIndicatorX(d===b.platform.output.TrickPlay.MODES.RW?this.REW_INDEX:this.FFW_INDEX);}this._banner.showSpeedIndicator();}};a.prototype._exitPlayback=function(c){if(this._playbackCompleteCallback){this._playbackCompleteCallback(c);}};a.prototype._finishPlayback=function(){var c=b.app.fullScreenPlayer.getPlaybackPosition();b.app.fullScreenPlayer._retuneToCurrentChannel();this._exitPlayback(c);};b.app.players.OnDemandPlayer=a;}($N));var $N=window.parent.$N;$N.app=$N.app||{};$N.app.players=$N.app.players||{};(function(a){function b(d,c,f,e){b.superConstructor.call(this,c);this._log=new a.apps.core.Log("MediaPlayer","PvrPlayer");this._controller=d;this._fullscreenPlayer=f;this._parentalLockIcon=e;this._startPosition=0;this._bookMarkedPosition=0;this._taskId=null;this._isStopPressed=false;this._playbackSpeed=null;this.PLAY_SPEED=100;this.PAUSE_SPEED=0;this.SPEED_REW_MULTIPLIERS=[100,200,400,800,1600,3200,6400];this.SPEED_FFW_MULTIPLIERS=[200,400,800,1600,3200,6400];this.STOP_INDEX=0;this.REPLAY_INDEX=1;this.REW_INDEX=2;this.PLAY_PAUSE_INDEX=3;this.FFW_INDEX=4;this.SPEED_INDICATOR_FADEOUT_TIME=500;this._speedIndicatorTimeout=null;this.pvrDisabledSubscriptionId=null;this.pinHelper=null;this.activatedCurrentPrefSubtitleTrack=false;}a.apps.util.Util.extend(b,a.app.players.BasePlayer);b.prototype.initialise=function(){var c=this;b.superClass.initialise.call(this);this._failureCallback=function(){};this._streamStartedListener=function(d){if(!c.activatedCurrentPrefSubtitleTrack){a.app.TracksUtil.activateCurrentPrefSubtitleTrack();c.activatedCurrentPrefSubtitleTrack=true;}};this._playerReachedEndCallback=function(){c._endOfPlayback();};this._playerConnectedListener=function(){if(c._startPosition){a.app.fullScreenPlayer.tuner.hideVideo();setTimeout(function(){a.app.fullScreenPlayer.setPlaybackPosition(c._startPosition);a.app.fullScreenPlayer.tuner.showVideo();},100);}c._updateBannerPlayBackPositions();};this._showOrHideParentalLock=function(d){if(d){c._parentalLockIcon.show();}else{c._parentalLockIcon.hide();}};this._parentalLockListener=function(d){c._showOrHideParentalLock(d);};this._banner.hide(true);this._pinSuccessCallback=function(){if(c._trickPlayObj.getTrickPlayMode()===a.platform.output.TrickPlay.MODES.PAUSE){c._banner.select(this.PLAY_PAUSE_INDEX);c._trickPlayObj.play();}};this._pinKeyPressCallback=function(e,d){if(isNaN(parseInt(d,10))&&d!==a.apps.core.KeyInterceptor.getKeyMap().KEY_LEFT&&d!==a.apps.core.KeyInterceptor.getKeyMap().KEY_OK){c.pinHelper.hideDialog();c.resetBannerTimeout();c._showBanner();}};this._pinCancelledCallback=function(){a.app.ContextHelper.closeContext();};this.pinHelper=new a.app.PinHelper(this._pinSuccessCallback,null,null,this._pinCancelledCallback,a.app.constants.PIN_DIALOG_SHOW_TIME,false);};b.prototype._showParentalPinPopup=function(){if((this._trickPlayObj.getTrickPlayMode()===a.platform.output.TrickPlay.MODES.FF)||this._trickPlayObj.getTrickPlayMode()===a.platform.output.TrickPlay.MODES.RW){this._trickPlayObj.playPause();}if(this._trickPlayObj.getTrickPlayMode()!==a.platform.output.TrickPlay.MODES.PAUSE){this._banner.select(this.PLAY_PAUSE_INDEX);this._trickPlayObj.playPause();}this.pinHelper.setDialogProperties({x:0,y:0,width:1920,height:1080,id:"PinDialog",title:a.app.DialogueHelper.getString("programLocked"),description:a.app.DialogueHelper.getString("unlockShow"),keyPressedCallback:this._pinKeyPressCallback,titleCssClass:"pinEntryTitle"});this.pinHelper.showPinDialog("master",true,null,true);this._banner.hide(true);};b.prototype.activate=function(e){var d=this,c=e.playingEvent;this._activationContext=e;this._taskId=c.taskId;this._isActiveRecording=e.actualStopTime?false:true;this._isStopPressed=false;this.activatedCurrentPrefSubtitleTrack=false;if((c&&c.bookmark&&c.bookmark>0)&&!e.clearBookmark){this._bookMarkedPosition=c.bookmark;}else{this._bookMarkedPosition=0;}this._recordingDurationinMS=a.app.PVRUtil.getRecordingTimingsData(c).recordingDuration;this._recordingDurationInSecs=a.app.epgUtil.calculateEventLengthInSeconds(0,this._recordingDurationinMS);a.app.fullScreenPlayer.registerPlayerConnectedListener(this._streamStartedListener);if(e.failureCallback){this._failureCallback=e.failureCallback;}a.app.fullScreenPlayer.setPinPopUpOnBlockedEventCallback(function(){d._showParentalPinPopup();});a.app.fullScreenPlayer.setHidePinPopUpForUnblockedEventCallback(function(){if(d.pinHelper.isPinShowing()){d.pinHelper.hideDialog();}});a.app.fullScreenPlayer.registerPlayerConnectFailedListener(this._failureCallback);a.app.fullScreenPlayer.registerPlayErrorListener(this._failureCallback);if(this.pvrDisabledSubscriptionId!==null){a.apps.util.EventManager.unSubscribe(this.pvrDisabledSubscriptionId);}this.pvrDisabledSubscriptionId=a.apps.util.EventManager.subscribe("PVRDisabled",function(){d._finishPlayback(true);},this);a.app.PVRUtil.setTaskAsPlaying(this._taskId);a.app.fullScreenPlayer.registerPlayerReachedEndListener(a.app.PVRUtil.unsetTaskAsPlaying);a.app.fullScreenPlayer.registerPlayerConnectFailedListener(a.app.PVRUtil.unsetTaskAsPlaying);a.app.fullScreenPlayer.registerPvrPlayerParentalLockListener(this._parentalLockListener);this._trickPlayObj.setDirectMode(true);this._fullscreenPlayer.show();this._startPosition=e.startPosition||0;this._banner.setProgressBarStartEnd(this._getContentLengthText(this._startPosition),this._getContentLengthText(this._recordingDurationInSecs));this._banner.show();a.app.fullScreenPlayer.registerPlayerConnectedListener(this._playerConnectedListener);if(e.dontRestartStream&&!e.atEndOfPlayBack){if(this._startPosition===0){a.app.fullScreenPlayer.setPlaybackPosition(0);}this._trickPlayObj.play();}if(this._bookMarkedPosition&&this._bookMarkedPosition>0){e.bookmark=this._bookMarkedPosition;}b.superClass.activate.call(this,e);this._updateBannerPlayBackPositions();this._startUpdateInterval();};b.prototype.passivate=function(){a.app.fullScreenPlayer.unregisterPlayerConnectedListener(this._streamStartedListener);b.superClass.passivate.call(this);a.app.fullScreenPlayer.unregisterPlayerConnectedListener(this._playerConnectedListener);a.app.fullScreenPlayer.unregisterPlayerConnectFailedListener(this._failureCallback);a.app.fullScreenPlayer.unregisterPlayErrorListener(this._failureCallback);a.app.fullScreenPlayer.unregisterPvrPlayerParentalLockListener(this._parentalLockListener);a.app.fullScreenPlayer.unregisterPlayerReachedEndListener(a.app.PVRUtil.unsetTaskAsPlaying);a.app.fullScreenPlayer.unregisterPlayerConnectFailedListener(a.app.PVRUtil.unsetTaskAsPlaying);a.app.fullScreenPlayer.setPinPopUpOnBlockedEventCallback(null);this._banner.hide(true);};b.prototype.okPressedHandler=function(){var c,d=a.apps.core.KeyInterceptor.getKeyMap();if(this._banner.isVisible()){switch(this._banner.getSelectedIndex()){case this.STOP_INDEX:c=d.KEY_STOP;break;case this.REPLAY_INDEX:c=d.KEY_REPLAY;break;case this.REW_INDEX:c=d.KEY_REW;break;case this.PLAY_PAUSE_INDEX:c=d.KEY_PLAY_PAUSE;break;case this.FFW_INDEX:c=d.KEY_FFW;break;}this.keyHandler(c);}else{this._showBanner();}};b.prototype._restoreTrickPlayMode=function(){switch(this._playbackSpeed){case this.PAUSE_SPEED:this._trickPlayObj.pause();this._banner.togglePlayPauseIcon(false);this._banner.select(this.PLAY_PAUSE_INDEX);break;case this.PLAY_SPEED:this._trickPlayObj.play();this._banner.togglePlayPauseIcon(true);this._banner.select(this.PLAY_PAUSE_INDEX);break;default:if(this._playbackSpeed<0){this._trickPlayObj.rewind();this._banner.select(this.REW_INDEX);}else{this._trickPlayObj.fastForward();this._banner.select(this.FFW_INDEX);}}};b.prototype._showStopPlaybackBanner=function(e){var f=this,d=function(i){f._banner.select(f.STOP_INDEX);f._isStopPressed=true;f._banner.exitPVRPlaybackBanner();f._showBanner();setTimeout(function(){if(f._shouldExitContext){a.app.ContextHelper.exitContext();}else{a.app.ContextHelper.closeContext();}},100);},c=function(i){f._restoreTrickPlayMode();},h=function(i){var j=((i&&i.action===a.app.constants.YES_OPTION)||(i.key&&i.key.action===a.app.constants.YES_OPTION));if(j){d(i);}else{c(i);}},g=[{name:a.app.DialogueHelper.getString("yes"),action:a.app.constants.YES_OPTION},{name:a.app.DialogueHelper.getString("no"),action:a.app.constants.NO_OPTION}];this._playbackSpeed=this._trickPlayObj.getSpeed();this._trickPlayObj.pause();this._shouldExitContext=e;a.app.DialogueHelper.createAndShowDialogue(a.app.constants.DLG_STOP_PVR_PLAYBACK,a.app.PVRUtil.getString("stopRecordingPlaybackTitle"),a.app.PVRUtil.getString("stopRecordingPlaybackMessage"),g,h);};b.prototype.trickplayKeyHandler=function(c){var d=this._trickPlayObj.getTrickPlayMode();if((!c&&d==="rew")||(c&&d==="ff")){this._trickPlayObj.play();}else{this._trickPlayObj.setAllowSpeedCycle(false);if(c){this._trickPlayObj.setPlayRateMultipliers(this.SPEED_REW_MULTIPLIERS);this._banner.select(this.REW_INDEX);}else{this._trickPlayObj.setPlayRateMultipliers(this.SPEED_FFW_MULTIPLIERS);this._banner.select(this.FFW_INDEX);}}};b.prototype.keyHandler=function(c){var e=a.apps.core.KeyInterceptor.getKeyMap(),d=this,f=null;switch(c){case e.KEY_LEFT:if(this._banner.isVisible()){this._banner.selectPrevious();}break;case e.KEY_RIGHT:if(this._banner.isVisible()){this._banner.selectNext();}break;case e.KEY_OK:this.okPressedHandler();break;case e.KEY_GREEN:if(this._banner.isVisible()){this._banner.showCurrentAudioTrackAndToggle();}this._showBanner();return true;case e.KEY_YELLOW:if(this._banner.isVisible()){this._banner.showCurrentSubtitleStateAndToggle();}this._showBanner();return true;case e.KEY_DOWN:this._banner.hide(true);return true;case e.KEY_EXIT:this._showStopPlaybackBanner(true);return true;case e.KEY_BACK:case e.KEY_STOP:this._showStopPlaybackBanner(false);return true;case e.KEY_FFW:this.trickplayKeyHandler(false);break;case e.KEY_REW:this.trickplayKeyHandler(true);break;case e.KEY_PLAY_PAUSE:this._banner.select(this.PLAY_PAUSE_INDEX);break;case e.KEY_REPLAY:this._banner.select(this.REPLAY_INDEX);this._trickPlayObj.play();this._showBanner();setTimeout(function(){a.app.fullScreenPlayer.setPlaybackPosition(0);d._banner.select(d.PLAY_PAUSE_INDEX);d._updateBannerPlayBackPositions();},250);return true;case e.KEY_RED:case e.KEY_INFO:a.app.PVRUtil.navigateToSynopsis(this._activationContext.playingEvent);return true;case e.KEY_UP:if(this._banner.isVisible()){a.app.ContextHelper.openContext("MINIGUIDE",{activationContext:{showBanner:true,hideBanner:false,inTrickplayMode:true}});}else{this._showBanner();}return true;default:this._isStopPressed=false;break;}return b.superClass.keyHandler.call(this,c);};b.prototype._updateBannerPlayBackPositions=function(){var c=a.app.fullScreenPlayer.getPlaybackPosition(),d=a.app.fullScreenPlayer.getContentLength();this._banner.updateProgressBar(c,d);if(this._isActiveRecording&&d){this._banner.setProgressBarStartEnd(this._getContentLengthText(c),this._getContentLengthText(d));}};b.prototype._clearSpeedIndicatorTimer=function(){clearTimeout(this._speedIndicatorTimeout);};b.prototype.setHideSpeedIndicatorTimer=function(){var c=this;this._clearSpeedIndicatorTimer();this._speedIndicatorTimeout=setTimeout(function(){c._banner.setSpeedIndicatorText("");},this.SPEED_INDICATOR_FADEOUT_TIME);};b.prototype._updateBannerTrickPlayIndicators=function(d,c){this._banner.hideSpeedIndicator();switch(c){case this.PAUSE_SPEED:this._banner.togglePlayPauseIcon(false);this._banner.select(this.PLAY_PAUSE_INDEX);break;case this.PLAY_SPEED:this._banner.togglePlayPauseIcon(true);this._banner.select(this.PLAY_PAUSE_INDEX);this._banner.setSpeedIndicatorText("x1");this.setHideSpeedIndicatorTimer();this._banner.setSpeedIndicatorX(this.PLAY_PAUSE_INDEX);this._banner.showSpeedIndicator();break;default:this._clearSpeedIndicatorTimer();this._banner.togglePlayPauseIcon(false);this._banner.setSpeedIndicatorText("x"+String(Math.abs(c)/100));this._banner.setSpeedIndicatorX(d===a.platform.output.TrickPlay.MODES.RW?this.REW_INDEX:this.FFW_INDEX);this._banner.showSpeedIndicator();}};b.prototype._saveBookMark=function(d,c){d=(d>=0)?d:a.app.fullScreenPlayer.getPlaybackPosition();c=c||a.app.fullScreenPlayer.getContentLength();if(a.app.PVRUtil.deleteOrBookmarkCurrentPosition(d,c)){this._bookMarkedPosition=d;}else{this._bookMarkedPosition=0;}a.platform.btv.PVRManager.saveBookmark(this._activationContext.playingEvent,0,this._bookMarkedPosition);};b.prototype._exitPlayback=function(c){if(!this._bookMarkedPosition){a.app.fullScreenPlayer.jumpToLive();}this._banner.exitPVRPlaybackBanner();a.app.PVRUtil.unsetTaskAsPlaying();this._playbackFinished=true;};b.prototype._finishPlayback=function(e){var d=a.app.fullScreenPlayer.getPlaybackPosition(),c=a.app.fullScreenPlayer.getContentLength();this._stopTrickPlay();a.app.fullScreenPlayer.jumpToLive();this._saveBookMark(d,c);a.apps.util.EventManager.unSubscribe(this.pvrDisabledSubscriptionId);this.pvrDisabledSubscriptionId=null;this._exitPlayback(e);};b.prototype._haveFwToLiveTv=function(c){return a.platform.btv.PVRManager.isTaskRecordingNow(c);};b.prototype._endOfPlayback=function(){if(this._haveFwToLiveTv(this._taskId)){this._trickPlayObj.play();}else{this._saveBookMark();this._exitPlayback();if(this._hasFocus){a.app.ContextHelper.closeContext();}}};a.app.players.PvrPlayer=b;}($N));var $N=window.parent.$N;$N.app=$N.app||{};$N.app.players=$N.app.players||{};(function(a){function b(d,c,f,e){a.apps.core.Language.adornWithGetString(b,"apps/mediaPlayer/common/");b.superConstructor.call(this,c);this._log=new a.apps.core.Log("MediaPlayer","VideoPlayerUSBDLNA");this._controller=d;this._fullscreenPlayer=f;this._startPosition=0;this._isStopPressed=false;this._speedIndicatorTimeout=null;this.START_ICON_FOUCS_INDEX=0;this.KILO_BYTE=1024;this.PLAY_SPEED=100;this.PAUSE_SPEED=0;this.SPEED_REW_MULTIPLIERS=[100,200,400,800,1600,3200,6400,-100];this.SPEED_FFW_MULTIPLIERS=[200,400,800,1600,3200,6400,100];this._trickKeyIndex=null;this._loadingBar=e;}a.apps.util.Util.extend(b,a.app.players.BasePlayer);b.prototype.initialise=function(){var c=this,d;b.superClass.initialise.call(this);this._failureCallback=function(h){if(h.contentErrorInfo){var f=a.app.constants.CA_PLAY_ERRORS.contentErrorReason.CONTENT_ERROR_REASON_STREAM_WRONG_TYPE,g=a.app.constants.CA_PLAY_ERRORS.contentErrorReason.CONTENT_ERROR_REASON_STREAM_CODEC_NOT_FOUND;if((h.contentErrorInfo.reason===f)||(h.contentErrorInfo.reason===g)){a.app.DialogueHelper.createAndShowDialogue(a.app.constants.DLG_DLNA_COMMUNICATION_ERROR,b.getString("playerErrorTitle"),b.getString("playerVideoErrorMessage"));}}c._loadingBar.hide();a.app.fullScreenPlayer.jumpToLive();a.app.ContextHelper.closeContext();};this._playerReachedEndCallback=function(){c._endOfPlayback();};this._playerConnectedListener=function(){c._loadingBar.hide();if(c._startPosition){a.app.fullScreenPlayer.tuner.hideVideo();setTimeout(function(){a.app.fullScreenPlayer.setPlaybackPosition(c._startPosition);a.app.fullScreenPlayer.tuner.showVideo();},100);}c._updateBannerPlayBackPositions();};this._usbMediaPlaybackListener=function(e){if(c.activationContext.url.indexOf("file://")>=0){c._loadingBar.setLoading(false);a.app.fullScreenPlayer.jumpToLive();c.activationContext.controller.setMediaDeviceDiasbledFlag(true);if(!e.data){a.app.ContextHelper.closeContext();}}};this._subscribeToUsbMediaPlaybackEvent=function(){d=a.app.UsbBrowserHelper.subscribeToUsbMediaPlaybackEvent(this._usbMediaPlaybackListener,this._usbMediaPlaybackListener,this);};this._unSubscribeToUsbMediaPlaybackEvent=function(){d=a.app.UsbBrowserHelper.unSubscribeToUsbMediaPlaybackEvent(d);};this._onDlnaDeviceLost=function(f){if((a.app.DlnaHelper.getMediumName()===f.device.friendlyName)&&(c.activationContext.url.indexOf("dlna://")>=0)){c._loadingBar.setLoading(false);a.app.DialogueHelper.createAndShowDialogue(a.app.constants.DLG_DLNA_COMMUNICATION_ERROR,b.getString("dlnaErrorTitle"),b.getString("dlnaPlayFailMessage"));a.app.fullScreenPlayer.jumpToLive();c.activationContext.controller.setMediaDeviceDiasbledFlag(true);a.app.ContextHelper.closeContext();}};this._subscribeToDlnaDeviceLostEvent=function(){a.app.DlnaHelper.subscribeToDeviceLostEvent(this._onDlnaDeviceLost);};this._unSubscribeToDlnaDeviceLostEvent=function(){a.app.DlnaHelper.unSubscribeToDeviceLostEvent(this._onDlnaDeviceLost);};};b.prototype._setIndexes=function(c){this._current=c;this._next=c+1;this._previous=c-1;if(this._next>this._totalTracks-1){this._next=0;}if(this._previous<0){this._previous=this._totalTracks-1;}};b.prototype.activate=function(g){var f=null,c,e={},d;this._startPosition=0;this.activationContext=g;c=(g.selectedItemIndex===undefined)?0:g.selectedItemIndex;this._shuffleMode=false;e.shuffleModeEnabled=false;if(g.isPlayShuffleEnabled){this._shuffleMode=true;c=0;e.shuffleModeEnabled=true;}f=g.playList.length;this._actualUrls=[];this.iconsList=[];for(d=0;d<f;d++){this._actualUrls[d]=g.playList[d];}this._shuffledUrls=a.app.ArrayUtil.arrayShuffle(this._actualUrls);g.url=this._shuffleMode?this._shuffledUrls[c]:this._actualUrls[c];this.activationContext.url=g.url;this._showLoadingBarIfNeeded();this._repeatMode=false;this._totalTracks=this._actualUrls.length;this._setIndexes(c);this.availableIconsForBanner=a.app.constants.TRICKPLAY_ICONS_FOR_PHOTO_AUDIO_VIDEO_PLAYBACK;if(this._totalTracks>1){this.START_ICON_FOUCS_INDEX=5;this.iconsList=[this.availableIconsForBanner.STOP,this.availableIconsForBanner.PREVIOUS,this.availableIconsForBanner.RWD,this.availableIconsForBanner.PLAY,this.availableIconsForBanner.FWD,this.availableIconsForBanner.NEXT,this.availableIconsForBanner.PROGRESSBAR];}else{this.START_ICON_FOUCS_INDEX=3;this.iconsList=[this.availableIconsForBanner.STOP,this.availableIconsForBanner.RWD,this.availableIconsForBanner.PLAY,this.availableIconsForBanner.FWD,this.availableIconsForBanner.PROGRESSBAR];}c=this._getActualListIndex();this._banner.setIconsForBanner(this.iconsList,e);this._banner.setCurrentAndTotalTracks(String(c+1),String(this._totalTracks));this._showBanner();this._startUpdateInterval();this._banner.selectIconAtIndex(this.START_ICON_FOUCS_INDEX);this._subscribeToUsbMediaPlaybackEvent();this._subscribeToDlnaDeviceLostEvent();this._fullscreenPlayer.show();this._trickPlayObj.setDirectMode(true);a.app.fullScreenPlayer.registerPlayerConnectedListener(this._playerConnectedListener);a.app.fullScreenPlayer.registerPlayerConnectFailedListener(this._failureCallback);a.app.fullScreenPlayer.registerPlayerPlayFailedListener(this._failureCallback);a.app.fullScreenPlayer.registerStreamDisabledListener(this._failureCallback);b.superClass.activate.call(this,g);};b.prototype.passivate=function(){this._finishPlayback();a.app.fullScreenPlayer.jumpToLive();this._banner.deFocusSelectedIcon();if(this._repeatMode){this._banner.toggleRepeatIconAndLabel(false);}b.superClass.passivate.call(this);this._unSubscribeToUsbMediaPlaybackEvent();this._unSubscribeToDlnaDeviceLostEvent();a.app.fullScreenPlayer.unregisterPlayerConnectedListener(this._playerConnectedListener);a.app.fullScreenPlayer.unregisterPlayerConnectFailedListener(this._failureCallback);a.app.fullScreenPlayer.unregisterPlayerPlayFailedListener(this._failureCallback);this._fullscreenPlayer.hide();};b.prototype.focus=function(){this._showBanner();a.app.ClockDisplay.hide();};b.prototype._playNextTrack=function(d){if(this._totalTracks>1){var c,e;if(this._shuffleMode){this.activationContext.url=this._shuffledUrls[d];e=this._getActualListIndex();}else{c=this._getActualListIndex();d=c+1;if(d>this._totalTracks-1){d=0;}this.activationContext.url=this._actualUrls[d];e=d;}this._showLoadingBarIfNeeded();this.playGivenURL(this.activationContext);this._banner.updateCurrentTrack(e+1);this._setIndexes(this._next);}};b.prototype._playPreviousTrack=function(d){if(this._totalTracks>1){var c,e;if(this._shuffleMode){this.activationContext.url=this._shuffledUrls[d];e=this._getActualListIndex();}else{c=this._getActualListIndex();d=c-1;if(d<0){d=this._totalTracks-1;}this.activationContext.url=this._actualUrls[d];e=d;}this._showLoadingBarIfNeeded();this.playGivenURL(this.activationContext);this._banner.updateCurrentTrack(e+1);this._setIndexes(this._previous);}};b.prototype._endOfPlayback=function(){if(this._repeatMode){a.app.fullScreenPlayer.setPlaybackPosition(0);this._trickPlayObj.play();this._updateBannerPlayBackPositions();}else{if(this._totalTracks>1){this._playNextTrack(this._next);}else{a.app.ContextHelper.closeContext();}}};b.prototype._restartCurrentTrack=function(){var c=this._trickPlayObj.getTrickPlayMode();this._trickPlayObj.setPlayRateMultipliers([100]);if(c!=="play"){this._trickPlayObj.play();}a.app.fullScreenPlayer.setPlaybackPosition(0);this._trickPlayObj.play();this._updateBannerPlayBackPositions();};b.prototype._showLoadingBarIfNeeded=function(){var d=this.activationContext.controller.getMetaDataForUrl(this.activationContext.url),c=null,f=null,e=null;if(d.itemDetails&&d.itemDetails[0].fileSize){c=d.itemDetails[0].fileSize;f=(c>this.KILO_BYTE)?(c/this.KILO_BYTE):null;e=(f&&f>this.KILO_BYTE)?(f/this.KILO_BYTE):null;if(e&&(e>200)){this._loadingBar.setText(b.getString("preparingVideo"));this._loadingBar.show();}}};b.prototype._getActualListIndex=function(){return this._actualUrls.indexOf(this.activationContext.url);};b.prototype.trickplayKeyHandler=function(c){var d=this._trickPlayObj.getTrickPlayMode();if((!c&&d==="rew")||(c&&d==="ff")){this._trickPlayObj.play();}else{this._trickPlayObj.setAllowSpeedCycle(true);if(c){this._trickPlayObj.setPlayRateMultipliers(this.SPEED_REW_MULTIPLIERS);}else{this._trickPlayObj.setPlayRateMultipliers(this.SPEED_FFW_MULTIPLIERS);}}};b.prototype._toggleShuffleMode=function(){if(this._shuffleMode){this._shuffleMode=false;this._banner.toggleShuffleIconAndLabel(this._shuffleMode);}else{this._shuffleMode=true;this._banner.toggleShuffleIconAndLabel(this._shuffleMode);}};b.prototype._toggleRepeatMode=function(){if(this._repeatMode){this._repeatMode=false;this._banner.toggleRepeatIconAndLabel(this._repeatMode);}else{this._repeatMode=true;this._banner.toggleRepeatIconAndLabel(this._repeatMode);}};b.prototype._updateBannerPlayBackPositions=function(){var d=a.app.fullScreenPlayer.getPlaybackPosition(),c=a.app.fullScreenPlayer.getContentLength();if(c&&(d>=0)){this._banner.updateProgressBar(d,c);this._banner.setProgressBarStartEnd(this._getContentLengthText(d),this._getContentLengthText(c));}};b.prototype._updateBannerTrickPlayIndicators=function(d,c){switch(c){case this.PAUSE_SPEED:this._cancelBannerHide();this._banner.updateFocusForIcon(this.availableIconsForBanner.PLAY);this._banner.togglePlayPauseIcon(false);this._stopUpdateInterval();break;case this.PLAY_SPEED:this._banner.togglePlayPauseIcon(true);if(this._trickKeyIndex){this._banner.setTrickKeysLabel(c,this.availableIconsForBanner.PLAY);this._trickKeyIndex=null;}this._startUpdateInterval();break;default:this._trickKeyIndex=(d===a.platform.output.TrickPlay.MODES.RW?this.availableIconsForBanner.RWD:this.availableIconsForBanner.FWD);this._banner.setTrickKeysLabel(c,this._trickKeyIndex);this._cancelBannerHide();this._banner.togglePlayPauseIcon(false);this._startUpdateInterval((1000/2));}};b.prototype._cancelBannerHide=function(){if(this._bannerTimeout){window.parent.clearTimeout(this._bannerTimeout);}};b.prototype._getBannerTimeout=function(){return((a.platform.system.Preferences.get(a.app.constants.PREF_USBDLNA_PLAYER_BANNER_TIMEOUT))*1000);};b.prototype._showBanner=function(){var c=this;if(!this._banner.isVisible()){this._banner.show();}this._cancelBannerHide();this._bannerTimeout=window.parent.setTimeout(function(){c._banner.hide();},this._getBannerTimeout());};b.prototype.okPressedHandler=function(){var c,d=a.apps.core.KeyInterceptor.getKeyMap();if(this._banner.isVisible()){switch(this.iconsList[this._banner.getSelectedIndex()]){case this.availableIconsForBanner.STOP:c=d.KEY_STOP;break;case this.availableIconsForBanner.REPEAT:this._showBanner();this._toggleRepeatMode();break;case this.availableIconsForBanner.PREVIOUS:this._playPreviousTrack(this._previous);break;case this.availableIconsForBanner.PLAY:c=d.KEY_PLAY_PAUSE;break;case this.availableIconsForBanner.SHUFFLE:this._toggleShuffleMode();break;case this.availableIconsForBanner.NEXT:this._playNextTrack(this._next);break;case this.availableIconsForBanner.FWD:c=d.KEY_FFW;break;case this.availableIconsForBanner.RWD:c=d.KEY_REW;break;case this.availableIconsForBanner.REPLAY:c=d.KEY_REPLAY;break;}this.keyHandler(c);}else{this._showBanner();}};b.prototype.keyHandler=function(c){var e=a.apps.core.KeyInterceptor.getKeyMap(),d=this,f=null;switch(c){case e.KEY_LEFT:if(this._banner.isVisible()){this._banner.selectPrevious();}this._showBanner();break;case e.KEY_RIGHT:if(this._banner.isVisible()){this._banner.selectNext();}this._showBanner();break;case e.KEY_OK:this.okPressedHandler();this._showBanner();break;case e.KEY_DOWN:this._banner.hide();return true;case e.KEY_FFW:this._showBanner();this.trickplayKeyHandler(false);break;case e.KEY_REW:this._showBanner();this.trickplayKeyHandler(true);break;case e.KEY_PLAY_PAUSE:this._showBanner();break;case e.KEY_STOP:case e.KEY_BACK:a.app.ContextHelper.closeContext();return true;case e.KEY_EXIT:a.app.ContextHelper.exitContext();return true;case e.KEY_RADIO:case e.KEY_MOSAIC:case e.KEY_POWER:case e.KEY_VOD:case e.KEY_TV:a.app.ContextHelper.closeContext();break;default:this._isStopPressed=false;break;}b.superClass.keyHandler.call(this,c);};a.app.players.VideoPlayerUSBDLNA=b;}($N));var $N=window.parent.$N;function AudioBanner(b,a){$N.apps.core.Language.adornWithGetString(AudioBanner,"apps/mediaPlayer/common/");AudioBanner.superConstructor.call(this,b);this._container=new $N.gui.Container(b);this._audioDetailGroup=new $N.gui.Group(b,this._container);this._thumbnail=new $N.gui.Image(b,this._audioDetailGroup);this._title=new $N.gui.Label(b,this._audioDetailGroup);this._artist=new $N.gui.Label(b,this._audioDetailGroup);this._album=new $N.gui.Label(b,this._audioDetailGroup);this._playerDuration=new $N.gui.Label(b,this._audioDetailGroup);this._shuffleIcon=new $N.gui.Image(b,this._audioDetailGroup);this._pauseIcon=new $N.gui.Image(b,this._audioDetailGroup);this._helpLayer=new $N.gui.Group(b,this._container);this._playAllHelp=new $N.gui.Label(b,this._helpLayer);this._exitHelp=new $N.gui.Label(b,this._helpLayer);this._HELP_FADEOUT_TIME=parseInt($N.platform.system.Preferences.get($N.app.constants.PREF_ZAPPING_BANNER_TIMEOUT),10)||$N.app.constants.SURFER_DURATION_DEFAULT;this._clockDisplay=$N.app.ClockDisplay;this._helpTimer=null;this._MIN_WIDTH=0;this._MAX_WIDTH=1920;this._MIN_HEIGHT=0;this._MAX_HEIGHT=1080;this._container.configure({x:0,y:0,width:this._MAX_WIDTH,height:this._MAX_HEIGHT,cssStyle:"fill: #000000"});this._AUDIO_DETAIL_GROUP_WIDTH=820;this._AUDIO_DETAIL_GROUP_HEIGHT=300;this._audioDetailGroupXPosition=900;this._audioDetailGroupYPosition=600;this._audioDetailGroup.configure({x:this._audioDetailGroupXPosition,y:this._audioDetailGroupYPosition,width:this._AUDIO_DETAIL_GROUP_WIDTH,height:this._AUDIO_DETAIL_GROUP_HEIGHT});this._thumbnail.configure({x:0,y:0,width:300,height:300,preserveAspect:true});this._title.configure({x:320,y:40,cssClass:"title",width:500});this._artist.configure({x:320,y:70,cssClass:"subtitle"});this._album.configure({x:320,y:110,cssClass:"subtitle"});this._playerDuration.configure({x:320,y:278,cssClass:"subtitle3"});this._shuffleIcon.configure({x:380,y:250,width:40,height:40,href:"../../../customise/resources/images/%RES/icons/Icn_shuffle.png",preserveAspect:true,visible:false});this._pauseIcon.configure({x:430,y:250,width:40,height:40,href:"../../../customise/resources/images/%RES/icons/Icn_Surfer_pause.png",preserveAspect:true,visible:false});this._X_INCREMENT=3;this._Y_INCREMENT=3;this._bounceAnimationTimer=null;this._BOUNCE_ANIMATION_INTERVAL=5;this._helpLayer.configure({x:0,y:0,width:this._MAX_WIDTH,height:this._MAX_HEIGHT});this._exitHelp.configure({x:1870,y:85,width:400,text:AudioBanner.getString("exitHelp"),cssClass:"playerHelpText smallFont"});this._playAllHelp.configure({x:1870,y:110,width:400,cssClass:"playerHelpText smallFont"});this._defaultThumbnail="";this._rootSVGRef=this._container.getRootSVGRef();if(a){a.addChild(this);}}$N.gui.Util.extend(AudioBanner,$N.gui.GUIObject);AudioBanner.prototype.doBounceAnimation=function(){this._audioDetailGroupXPosition=this._audioDetailGroupXPosition+this._X_INCREMENT;this._audioDetailGroupYPosition=this._audioDetailGroupYPosition+this._Y_INCREMENT;this._audioDetailGroup.setX(this._audioDetailGroupXPosition);this._audioDetailGroup.setY(this._audioDetailGroupYPosition);if(this._X_INCREMENT>0){if(this._audioDetailGroupXPosition+this._AUDIO_DETAIL_GROUP_WIDTH>=this._MAX_WIDTH){this._X_INCREMENT=this._X_INCREMENT*-1;}}else{if(this._audioDetailGroupXPosition<=this._MIN_WIDTH){this._X_INCREMENT=this._X_INCREMENT*-1;}}if(this._Y_INCREMENT>0){if(this._audioDetailGroupYPosition+this._AUDIO_DETAIL_GROUP_HEIGHT>=this._MAX_HEIGHT){this._Y_INCREMENT=this._Y_INCREMENT*-1;}}else{if(this._audioDetailGroupYPosition<=this._MIN_HEIGHT){this._Y_INCREMENT=this._Y_INCREMENT*-1;}}};AudioBanner.prototype.activate=function(c){var b=this,a=function(){b.hideHelpLayer();};if(c){this.setDefaultThumbnailUrl(c.defaultThumbnailUrl);}this.showHelpLayer();if(this._bounceAnimationTimer){clearInterval(this._bounceAnimationTimer);this._bounceAnimationTimer=null;}this._bounceAnimationTimer=setInterval(function(){b.doBounceAnimation();},b._BOUNCE_ANIMATION_INTERVAL);$N.app.HotPlug.setDialogShownCallback(a);$N.app.ErrorMessage.setDialogShownCallback(a);};AudioBanner.prototype.passivate=function(){this.hideShuffleIcon();this.hideHelpLayer();clearInterval(this._bounceAnimationTimer);this._bounceAnimationTimer=null;this._clockDisplay.show();$N.app.HotPlug.setDialogShownCallback(function(){});$N.app.ErrorMessage.setDialogShownCallback(function(){});};AudioBanner.prototype.setThumbnail=function(a){var b=this;if(a===""){this._setDefaultThumbnail();}else{this._thumbnail.setLoadFailedCallback(function(){b._setDefaultThumbnail(b._thumbnail,b._defaultThumbnail);});this._thumbnail.setHref(a);}};AudioBanner.prototype.setDefaultThumbnailUrl=function(a){this._defaultThumbnail=a;};AudioBanner.prototype._setDefaultThumbnail=function(b,a){b.setHref(a);};AudioBanner.prototype.setTitle=function(a){this._title.setText(a);};AudioBanner.prototype.setArtist=function(a){this._artist.setText(a);};AudioBanner.prototype.setAlbum=function(a){this._album.setText(a);};AudioBanner.prototype.setPlayerDuration=function(a){this._playerDuration.setText(a);};AudioBanner.prototype.setExitHelp=function(a){this._exitHelp.setText(a);};AudioBanner.prototype.setPlayAllHelp=function(a){this._playAllHelp.setText(a);};AudioBanner.prototype.update=function(a){this.configure(a);};AudioBanner.prototype.showPauseIcon=function(){this._pauseIcon.show();if(this._bounceAnimationTimer){clearInterval(this._bounceAnimationTimer);this._bounceAnimationTimer=null;}};AudioBanner.prototype.hidePauseIcon=function(){var a=this;this._pauseIcon.hide();if(this._bounceAnimationTimer){clearInterval(this._bounceAnimationTimer);this._bounceAnimationTimer=null;}this._bounceAnimationTimer=setInterval(function(){a.doBounceAnimation();},a._BOUNCE_ANIMATION_INTERVAL);};AudioBanner.prototype.showShuffleIcon=function(){this._shuffleIcon.show();};AudioBanner.prototype.hideShuffleIcon=function(){this._shuffleIcon.hide();};AudioBanner.prototype.hideHelpLayer=function(){if(this._helpTimer){clearTimeout(this._helpTimer);}this._clockDisplay.hide();this._helpLayer.hide();};AudioBanner.prototype.showHelpLayer=function(){var a=this;if(this._helpTimer){clearTimeout(this._helpTimer);}this._clockDisplay.show();this._helpLayer.show();this._helpTimer=setTimeout(function(){a.hideHelpLayer();},this._HELP_FADEOUT_TIME);};AudioBanner.prototype.getClassName=function(){return"AudioBanner";};var $N=window.parent.$N;function BaseBanner(b,a){$N.apps.core.Language.adornWithGetString(BaseBanner,"apps/mediaPlayer/common/");BaseBanner.superConstructor.call(this,b);this._log=new $N.apps.core.Log("MediaPlayer","BaseBanner");this._container=new $N.gui.Layer(b);this._backgroundBox=new $N.gui.BackgroundBox(b,this._container);this._rewContainer=new $N.gui.Container(b,this._container);this._playPauseContainer=new $N.gui.Container(b,this._container);this._ffwContainer=new $N.gui.Container(b,this._container);this._rewIcon=new $N.gui.SVGlink(b,this._rewContainer);this._ffwIcon=new $N.gui.SVGlink(b,this._ffwContainer);this._playPauseIcon=new $N.gui.SVGlink(b,this._playPauseContainer);this._speedIndicator=new $N.gui.Label(b,this._container);this._eventName=new $N.gui.Label(b,this._container);this._progress=new $N.gui.LabelledProgressBar(b,this._container);this._items=[this._rewContainer,this._playPauseContainer,this._ffwContainer];this._selectedItemIndex=0;this._SPEED_INDICATOR_OFFSET=30;this._rewIcon.iconUrl="../../../customise/resources/svg/icons.svg#timeShiftREW";this._ffwIcon.iconUrl="../../../customise/resources/svg/icons.svg#timeShiftFFW";this.PLAY_ICON_URL="../../../customise/resources/svg/icons.svg#timeShiftPlay";this.PAUSE_ICON_URL="../../../customise/resources/svg/icons.svg#timeShiftPause";this.PROGRESS_WIDTH=793.5;this.SPEED_INDICATOR_FADEOUT_TIME=500;this._bannerTimeout=null;this._speedIndicatorTimeout=null;this._container.configure({height:480,width:1920});this._backgroundBox.configure({x:0,y:0,height:480,width:1920,cssClass:"playbackBackground",opacity:1});this._speedIndicator.configure({x:495,y:282.5,height:60,width:150,cssClass:"timeShiftSpeedIndicator",visible:false});this._eventName.configure({x:750,y:282.5,height:60,width:this.PROGRESS_WIDTH,cssClass:"settingsDescriptionSmall"});this._rewContainer.configure({x:510,y:299,height:60,width:60,rounding:2,cssClass:"timeShiftButton"});this._rewIcon.configure({x:14,y:18,href:this._rewIcon.iconUrl});this._playPauseContainer.configure({x:600,y:299,height:60,width:60,rounding:2,cssClass:"timeShiftButton"});this._playPauseIcon.configure({x:0,y:0,href:this.PLAY_ICON_URL});this._ffwContainer.configure({x:690,y:299,height:60,width:60,rounding:2,cssClass:"timeShiftButton"});this._ffwIcon.configure({x:19,y:18,href:this._ffwIcon.iconUrl});this._progress.configure({x:795,y:314,width:this.PROGRESS_WIDTH,progressOuterCssClass:"timeShiftProgressOuter",progressInnerCssClass:"timeShiftProgressInner",progressBarProperties:{x:0,y:2,height:15,width:this.PROGRESS_WIDTH},startLabelProperties:{x:0,y:50,cssClass:"timeShiftProgressStartLabel"},endLabelProperties:{x:this.PROGRESS_WIDTH,y:50,cssClass:"timeShiftProgressEndLabel"}});this._rootSVGRef=this._container.getRootSVGRef();if(a){a.addChild(this);}}$N.gui.Util.extend(BaseBanner,$N.gui.GUIObject);BaseBanner.prototype.setEventNameText=function(a){this._eventName.setText(a||"");};BaseBanner.prototype.setSpeedIndicatorText=function(a){this._speedIndicator.setText(a);};BaseBanner.prototype.hideSpeedIndicator=function(){this._speedIndicator.hide();};BaseBanner.prototype.showSpeedIndicator=function(){this._speedIndicator.show();};BaseBanner.prototype.setSpeedIndicatorX=function(c){var b=c?this._items[c]._trueX:this._items[this._selectedItemIndex]._trueX,a=b+this._SPEED_INDICATOR_OFFSET;this._speedIndicator.setX(a);};BaseBanner.prototype.getSelectedIndex=function(){return this._selectedItemIndex;};BaseBanner.prototype.select=function(a){var b=this._items[this._selectedItemIndex];if(a===this._selectedItemIndex){b.setCssClass("timeShiftButton_highlight");return;}if(b){b.setCssClass("timeShiftButton");}b=this._items[a];if(b){this._selectedItemIndex=a;b.setCssClass("timeShiftButton_highlight");}};BaseBanner.prototype.selectNext=function(){if(this._selectedItemIndex<this._items.length-1){this.select(this._selectedItemIndex+1);}};BaseBanner.prototype.selectPrevious=function(){if(this._selectedItemIndex>0){this.select(this._selectedItemIndex-1);}};BaseBanner.prototype.setProgressBarStartEnd=function(d,c){var b,a;if(d&&c){b=$N.app.DateTimeUtil.getFormattedTimeStringFromTime(d,"HH:mm");a=$N.app.DateTimeUtil.getFormattedTimeStringFromTime(c,"HH:mm");this._progress.setProgressBarLabels(b,a);}};BaseBanner.prototype.updateProgressBar=function(a,b){this._progress.updateProgressBar(0,b,a);};BaseBanner.prototype.togglePlayPauseIcon=function(a){var c=a===undefined?this._playPauseIcon.getHref()===this.PLAY_ICON_URL:a,b=c?this.PAUSE_ICON_URL:this.PLAY_ICON_URL;this._playPauseIcon.setHref(b);};BaseBanner.prototype.toString=function(){return"BaseBanner";};var $N=window.parent.$N;function ThumbnailWithAnimation(b,a){$N.apps.core.Language.adornWithGetString(ThumbnailWithAnimation,"apps/mediaPlayer/common/");ThumbnailWithAnimation.superConstructor.call(this,b);this._container=new $N.gui.Layer(b);this._audioDetailGroupForTitle=new $N.gui.Layer(b,this._container);this._audioDetailGroup=new $N.gui.Layer(b,this._container);this._thumbnail=new $N.gui.Image(b,this._audioDetailGroup);this._title=new $N.gui.DelayedScrollingLabel(b,this._audioDetailGroupForTitle);this._artist=new $N.gui.Label(b,this._audioDetailGroup);this._album=new $N.gui.Label(b,this._audioDetailGroup);this._clockDisplay=$N.app.ClockDisplay;this._MIN_WIDTH=0;this._MAX_WIDTH=1920;this._MIN_HEIGHT=0;this._MAX_HEIGHT=1080;this._container.configure({x:0,y:0,width:this._MAX_WIDTH,height:this._MAX_HEIGHT,cssStyle:"fill: #000000"});this._AUDIO_DETAIL_GROUP_WIDTH=820;this._AUDIO_DETAIL_GROUP_HEIGHT=300;this._audioDetailGroupXPosition=900;this._audioDetailGroupYPosition=600;this._audioDetailGroupForTitle.configure({x:this._audioDetailGroupXPosition,y:this._audioDetailGroupYPosition,width:this._AUDIO_DETAIL_GROUP_WIDTH,height:this._AUDIO_DETAIL_GROUP_HEIGHT});this._audioDetailGroup.configure({x:this._audioDetailGroupXPosition,y:this._audioDetailGroupYPosition,width:this._AUDIO_DETAIL_GROUP_WIDTH,height:this._AUDIO_DETAIL_GROUP_HEIGHT});this._thumbnail.configure({x:0,y:0,width:300,height:300,preserveAspect:true});this._title.configure({x:320,y:10,width:500,cssClass:"thumbnailTitle",duration:"250ms"});this._artist.configure({x:320,y:86,cssClass:"thumbnailsubtitle",width:500});this._album.configure({x:320,y:123,cssClass:"thumbnailsubtitle",width:500});this._X_INCREMENT=3;this._Y_INCREMENT=3;this._bounceAnimationTimer=null;this._BOUNCE_ANIMATION_INTERVAL=10;if($N.app.constants.BROWSER_MODE==="html"){this.exitLeft=65;}else{this.exitLeft=85;}this._defaultThumbnail="";this._rootSVGRef=this._container.getRootSVGRef();if(a){a.addChild(this);}}$N.gui.Util.extend(ThumbnailWithAnimation,$N.gui.GUIObject);ThumbnailWithAnimation.prototype.doBounceAnimation=function(){this._audioDetailGroupXPosition=this._audioDetailGroupXPosition+this._X_INCREMENT;this._audioDetailGroupYPosition=this._audioDetailGroupYPosition+this._Y_INCREMENT;this._audioDetailGroup.setX(this._audioDetailGroupXPosition);this._audioDetailGroup.setY(this._audioDetailGroupYPosition);this._audioDetailGroupForTitle.setX(this._audioDetailGroupXPosition);this._audioDetailGroupForTitle.setY(this._audioDetailGroupYPosition);if(this._X_INCREMENT>0){if(this._audioDetailGroupXPosition+this._AUDIO_DETAIL_GROUP_WIDTH>=this._MAX_WIDTH){this._X_INCREMENT=this._X_INCREMENT*-1;}}else{if(this._audioDetailGroupXPosition<=this._MIN_WIDTH){this._X_INCREMENT=this._X_INCREMENT*-1;}}if(this._Y_INCREMENT>0){if(this._audioDetailGroupYPosition+this._AUDIO_DETAIL_GROUP_HEIGHT>=this._MAX_HEIGHT){this._Y_INCREMENT=this._Y_INCREMENT*-1;}}else{if(this._audioDetailGroupYPosition<=this._MIN_HEIGHT){this._Y_INCREMENT=this._Y_INCREMENT*-1;}}};ThumbnailWithAnimation.prototype.activate=function(a){var b=this;if(a){this.setThumbnail(a.itemDetails[0].albumArtUri);}if(a.itemDetails[0].title){this.setTitle(a.itemDetails[0].title);}if(a.itemDetails[0].artist){this.setArtist(a.itemDetails[0].artist);}if(a.itemDetails[0].album){this.setAlbum(ThumbnailWithAnimation.getString("album")+a.itemDetails[0].album);}this.show();if(this._bounceAnimationTimer){clearInterval(this._bounceAnimationTimer);}this._bounceAnimationTimer=setInterval(function(){b.doBounceAnimation();},b._BOUNCE_ANIMATION_INTERVAL);};ThumbnailWithAnimation.prototype.passivate=function(){clearInterval(this._bounceAnimationTimer);this._clockDisplay.show();this._title.stop();this.hide();};ThumbnailWithAnimation.prototype.clearThumbnailAnimationTimer=function(){if(this._bounceAnimationTimer){clearInterval(this._bounceAnimationTimer);}};ThumbnailWithAnimation.prototype.restartThumbnailAnimation=function(){var a=this;if(this._bounceAnimationTimer){clearInterval(this._bounceAnimationTimer);}this._bounceAnimationTimer=setInterval(function(){a.doBounceAnimation();},a._BOUNCE_ANIMATION_INTERVAL);};ThumbnailWithAnimation.prototype.setThumbnail=function(a){var b=this;if((a==="")||!a){this._setDefaultThumbnail(this._thumbnail,this._defaultThumbnail);}else{this._thumbnail.setLoadFailedCallback(function(){b._setDefaultThumbnail(b._thumbnail,b._defaultThumbnail);});this._thumbnail.setHref(a);}};ThumbnailWithAnimation.prototype.setDefaultThumbnailUrl=function(a){this._defaultThumbnail=a;};ThumbnailWithAnimation.prototype._setDefaultThumbnail=function(b,a){b.setHref(a);};ThumbnailWithAnimation.prototype.setTitle=function(a){this._title.setText(a+$N.app.constants.TRIPLE_SPACE_UNICODE);this._title.start();};ThumbnailWithAnimation.prototype.setArtist=function(a){this._artist.setText(a);};ThumbnailWithAnimation.prototype.setAlbum=function(a){this._album.setText(a);};ThumbnailWithAnimation.prototype.update=function(a){this.configure(a);};ThumbnailWithAnimation.prototype.getClassName=function(){return"ThumbnailWithAnimation";};var $N=window.parent.$N;function TimeShiftBanner(b,a){$N.apps.core.Language.adornWithGetString(TimeShiftBanner,"apps/mediaPlayer/common/");TimeShiftBanner.superConstructor.call(this,b);this._log=new $N.apps.core.Log("MediaPlayer","TimeShiftBanner");this._container=new $N.gui.Group(b);this._backgroundBox=new $N.gui.BackgroundBox(b,this._container);this._liveTVContainer=new $N.gui.Container(b,this._container);this._rewContainer=new $N.gui.Container(b,this._container);this._playPauseContainer=new $N.gui.Container(b,this._container);this._ffwContainer=new $N.gui.Container(b,this._container);this._liveTVLabel=new $N.gui.Label(b,this._liveTVContainer);this._rewIcon=new $N.gui.SVGlink(b,this._rewContainer);this._ffwIcon=new $N.gui.SVGlink(b,this._ffwContainer);this._playPauseIcon=new $N.gui.SVGlink(b,this._playPauseContainer);this._speedIndicator=new $N.gui.Label(b,this._container);this._eventName=new $N.gui.SpanLabel(b,this._container);this._progress=new $N.gui.LabelledProgressBar(b,this._container);this._items=[this._liveTVContainer,this._rewContainer,this._playPauseContainer,this._ffwContainer];this._selectedItemIndex=0;this._rewIcon.iconUrl="../../../customise/resources/svg/icons.svg#timeShiftREW";this._ffwIcon.iconUrl="../../../customise/resources/svg/icons.svg#timeShiftFFW";this._progressMarker="../../../customise/resources/svg/icons.svg#timeShiftProgressMarker";this.PLAY_ICON_URL="../../../customise/resources/svg/icons.svg#timeShiftPlay";this.PAUSE_ICON_URL="../../../customise/resources/svg/icons.svg#timeShiftPause";this.SPEED_INDICATOR_REW_X=495;this.SPEED_INDICATOR_PLAY_X=582;this.SPEED_INDICATOR_FFW_X=669;this.PROGRESS_WIDTH=793.5;this.SPEED_INDICATOR_FADEOUT_TIME=500;this._bannerTimeout=null;this._speedIndicatorTimeout=null;this._backgroundBox.configure({x:0,y:0,height:480,width:1920,cssClass:"miniguideBackground",opacity:1});this._speedIndicator.configure({x:495,y:282.5,height:60,width:150,cssClass:"timeShiftSpeedIndicator",visible:false});this._eventName.configure({x:750,y:282.5,height:60,width:this.PROGRESS_WIDTH,cssClass:"timeShiftEventName",spanCssClass:"timeShiftEpisodeInfo"});this._liveTVContainer.configure({x:288,y:299,height:60,width:150,rounding:2,cssClass:"timeShiftButton"});this._liveTVLabel.configure({x:78,y:41,width:120,cssClass:"liveTVTitle"});this._rewContainer.configure({x:465,y:299,height:60,width:60,rounding:2,cssClass:"timeShiftButton"});this._rewIcon.configure({x:14,y:18,href:this._rewIcon.iconUrl});this._playPauseContainer.configure({x:552,y:299,height:60,width:60,rounding:2,cssClass:"timeShiftButton"});this._playPauseIcon.configure({x:0,y:0,href:this.PLAY_ICON_URL});this._ffwContainer.configure({x:639,y:299,height:60,width:60,rounding:2,cssClass:"timeShiftButton"});this._ffwIcon.configure({x:19,y:18,href:this._ffwIcon.iconUrl});this._progress.configure({x:750,y:299,width:this.PROGRESS_WIDTH,progressOuterCssClass:"timeShiftProgressOuter",progressInnerCssClass:"timeShiftProgressInner",progressBarProperties:{x:0,y:2,height:15,width:this.PROGRESS_WIDTH},startLabelProperties:{x:0,y:59,cssClass:"timeShiftProgressStartLabel"},endLabelProperties:{x:this.PROGRESS_WIDTH,y:59,cssClass:"timeShiftProgressEndLabel"}});this._progress.setPlayHead(this._progressMarker);this._rootSVGRef=this._container.getRootSVGRef();if(a){a.addChild(this);}}$N.gui.Util.extend(TimeShiftBanner,$N.gui.GUIObject);TimeShiftBanner.prototype.setStopKeyText=function(a){this._liveTVLabel.setText(a);};TimeShiftBanner.prototype.setEventNameText=function(a,c){var b=$N.app.StringUtil.join(" ",a,c);this._eventName.setText(b||"");this._eventName.setSpanOnText(c);};TimeShiftBanner.prototype.setSpeedIndicatorText=function(a){this._speedIndicator.setText(a);};TimeShiftBanner.prototype.hideSpeedIndicator=function(){this._speedIndicator.hide();};TimeShiftBanner.prototype.showSpeedIndicator=function(){this._speedIndicator.show();};TimeShiftBanner.prototype.setSpeedIndicatorX=function(b){var a=0;switch(b){case $N.platform.output.TrickPlay.MODES.RW:a=this.SPEED_INDICATOR_REW_X;break;case $N.platform.output.TrickPlay.MODES.FF:a=this.SPEED_INDICATOR_FFW_X;break;default:a=this.SPEED_INDICATOR_PLAY_X;break;}this._speedIndicator.setX(a);};TimeShiftBanner.prototype.getSelectedIndex=function(){return this._selectedItemIndex;};TimeShiftBanner.prototype.select=function(a){var b=this._items[this._selectedItemIndex];if(a===this._selectedItemIndex){return;}if(b){b.setCssClass("timeShiftButton");}b=this._items[a];if(b){this._selectedItemIndex=a;b.setCssClass("timeShiftButton_highlight");}};TimeShiftBanner.prototype.selectNext=function(){if(this._selectedItemIndex<this._items.length-1){this.select(this._selectedItemIndex+1);}};TimeShiftBanner.prototype.selectPrevious=function(){if(this._selectedItemIndex>0){this.select(this._selectedItemIndex-1);}};TimeShiftBanner.prototype.setProgressBarStartEnd=function(d,c){var b,a;if(d&&c){b=$N.app.DateTimeUtil.getFormattedTimeStringFromTime(d,"HH:mm");a=$N.app.DateTimeUtil.getFormattedTimeStringFromTime(c,"HH:mm");this._progress.setProgressBarLabels(b,a);}};TimeShiftBanner.prototype.updateProgressBar=function(c,f,h,i,a){var b=f-c,e,g=i-c,d=h-c;if((h+a>=c)&&(h+a<=f)){e=(h+a-c)/b*this.PROGRESS_WIDTH;}else{if(h+a<c){e=0;}else{e=this.PROGRESS_WIDTH;}}this._progress.updateProgressBar(0,b,g,d);if(a&&a>0){this._progress.setMarkerPosition(e);}};TimeShiftBanner.prototype.resetProgressBarPositon=function(){this._progress.setMarkerPosition(0);};TimeShiftBanner.prototype.togglePlayPauseIcon=function(a){var c=a===undefined?this._playPauseIcon.getHref()===this.PLAY_ICON_URL:a,b=c?this.PAUSE_ICON_URL:this.PLAY_ICON_URL;this._playPauseIcon.setHref(b);};TimeShiftBanner.prototype.toString=function(){return"TimeShiftBanner";};var $N=$N||{};(function(a){var b=function(d,c){b.superConstructor.call(this,d);this._log=new a.apps.core.Log("MediaPlayer","VideoLoadingBar");this._radialGradientCentre=new a.gui.BackgroundBox(this._docRef,this._additionalGradientGroup);this._radialGradientLeft=new a.gui.BackgroundBox(this._docRef,this._additionalGradientGroup);this._radialGradientRight=new a.gui.BackgroundBox(this._docRef,this._additionalGradientGroup);this._barGroup.configure({y:301.5});this._basicGradientTop.configure({y:112.5});this._basicGradientBottom.configure({y:349.5});this._solidLineTop.configure({y:151.5});this._solidLineBottom.configure({y:348});this._radialGradientLeft.configure({x:-258,y:42,width:800,height:414,cssClass:"videoloadingBarEdgeGlow"});this._radialGradientRight.configure({x:1378,y:42,width:800,height:414,cssClass:"videoloadingBarEdgeGlow"});this._radialGradientCentre.configure({x:-99,y:-48,width:2118,height:594,cssClass:"videoloadingBarCentreGlow"});this._barBackground.configure({height:193.5});this._text.configure({y:267,cssClass:"videoLoadingBarText"});this._rootSVGRef=this._container.getRootSVGRef();if(c){c.addChild(this);}};a.gui.Util.extend(b,a.gui.LoadingBar);a.gui.VideoLoadingBar=b;}($N||{}));var $N=window.parent.$N;$N.app=$N.app||{};$N.app.players=$N.app.players||{};(function(b){function a(d,c,e){a.superConstructor.call(this,c);this._log=new b.apps.core.Log("MediaPlayer","AudioPlayer");this._controller=d;this._fullscreenPlayer=e;this._player=b.app.fullScreenPlayer.getPlayer();}b.apps.util.Util.extend(a,b.app.players.BasePlayer);a.prototype.initialise=function(){a.superClass.initialise.call(this);var c=this;this._failureCallback=function(){c._stopPlayback(true);};this._skip=false;this._trickPlay=false;this._context=null;this._isMusic=true;this._actualList=[];this._shuffledList=[];this._currentAudioList=[];this._shuffleMode=false;this._current=null;this._next=null;this._index=null;this._previous=null;this._itemCountToHideHelpLayer=0;this._MAX_INDEX_TO_HIDE_HELP=3;this._FIRST_INDEX_TO_HIDE_HELP=1;this._PLAY_MODES={SINGLE:"SINGLE",ALL:"ALL"};this._playMode=null;};a.prototype._setIndexes=function(c){this._current=c;this._next=c+1;this._previous=c-1;if(this._next>this._totalAudios-1){this._next=0;}if(this._previous<0){this._previous=this._totalAudios-1;}};a.prototype._updateBanner=function(){this._banner.update({title:this._currentAudioList[this._current].title,artist:this._currentAudioList[this._current].artist,album:this._controller.getString("album")+": "+this._currentAudioList[this._current].album,thumbnail:this._currentAudioList[this._current].thumbnail});};a.prototype._activateBasePlayer=function(){this._index=this._currentAudioList[this._current].index;var c={url:this._currentAudioList[this._current].resourceUrl,isMusic:this._isMusic,context:this._context,skip:this._skip,trickPlay:this._trickPlay};a.superClass.activate.call(this,c);a.superClass._startUpdateInterval.call(this);};a.prototype.activate=function(c){if(c.failureCallback){this._failureCallback=c.failureCallback;}b.app.fullScreenPlayer.registerPlayerConnectFailedListener(this._failureCallback);this._fullscreenPlayer.show();this._skip=c.skip;this._context=c.context;this._trickPlay=c.trickplay;this._current=c.index;this._playMode=c.mode;this._banner.activate({defaultThumbnailUrl:c.defaultThumbnail});this._actualList=c.audioList;this._shuffledList=b.app.ArrayUtil.arrayShuffle(this._actualList);this._shuffleMode=false;this._currentAudioList=this._actualList;this._totalAudios=this._actualList.length;this._itemCountToHideHelpLayer=this._FIRST_INDEX_TO_HIDE_HELP;this._setIndexes(this._current);this._activateBasePlayer();if(this._playMode===this._PLAY_MODES.SINGLE){this._banner.setPlayAllHelp(this._controller.getString("playAllHelp"));}else{this._banner.setPlayAllHelp(this._controller.getString("shuffleOnHelp"));}this._updateBanner();this._banner.show();if(!b.app.EnvironmentUtil.isSTBEnvironmentIP()){b.app.fullScreenPlayer.registerPlayerFailureListeners();}};a.prototype.passivate=function(){this._banner.hide();this._actualList=[];this._shuffledList=[];this._currentAudioList=[];this._banner.passivate();this._playbackFinished=true;b.app.fullScreenPlayer.stopPlayout(true);b.app.fullScreenPlayer.unregisterPlayerConnectFailedListener(this._failureCallback);if(!b.app.EnvironmentUtil.isSTBEnvironmentIP()){b.app.fullScreenPlayer.unregisterPlayerFailureListeners();}a.superClass.passivate.call(this);};a.prototype._toggleShuffleMode=function(){this._shuffleMode=!this._shuffleMode;if(this._shuffleMode){this._currentAudioList=this._shuffledList;this._banner.setPlayAllHelp(this._controller.getString("shuffleOffHelp"));this._banner.showShuffleIcon();}else{this._currentAudioList=this._actualList;this._banner.setPlayAllHelp(this._controller.getString("shuffleOnHelp"));this._banner.hideShuffleIcon();}this._setIndexes(this._totalAudios);};a.prototype._switchToPlayAllMode=function(){this._playMode=this._PLAY_MODES.ALL;this._itemCountToHideHelpLayer=this._FIRST_INDEX_TO_HIDE_HELP;this._banner.setPlayAllHelp(this._controller.getString("shuffleOnHelp"));};a.prototype.keyHandler=function(d){var e=b.apps.core.KeyInterceptor.getKeyMap(),f=false,c=true;switch(d){case e.KEY_OK:this._banner.showHelpLayer();f=true;break;case e.KEY_PLAY:if(this._playMode===this._PLAY_MODES.SINGLE){this._switchToPlayAllMode();}f=true;break;case e.KEY_PAUSE:b.app.fullScreenPlayer.trickPlay.playPause();break;case e.KEY_PLAY_PAUSE:if(this._playMode===this._PLAY_MODES.SINGLE){this._switchToPlayAllMode();}b.app.fullScreenPlayer.trickPlay.playPause();f=true;break;case e.KEY_RIGHT:case e.KEY_SKIP_FW:this._playNext();f=true;break;case e.KEY_LEFT:case e.KEY_SKIP_REW:this._playPrevious();f=true;break;case e.KEY_ZERO:if(this._playMode===this._PLAY_MODES.ALL){this._toggleShuffleMode();}f=true;break;case e.KEY_REW:case e.KEY_FFW:f=this._trickPlayObj.keyHandler(d);break;case e.KEY_STOP:case e.KEY_EXIT:case e.KEY_BACK:this._stopPlayback(c);f=true;break;}if(!f){a.superClass.keyHandler.call(this,d);}return f;};a.prototype._updateBannerTrickPlayIndicators=function(d,c){if(c===0){this._banner.showPauseIcon();}else{this._banner.hidePauseIcon();}};a.prototype._playCurrentIndexItem=function(){this._index=this._currentAudioList[this._current].index;b.app.fullScreenPlayer.stopPlayout(true);b.app.fullScreenPlayer.requestPlayout({url:this._currentAudioList[this._current].resourceUrl,isMusic:this._isMusic||false,context:this.context},false,this.contentObj);this._updateBanner();};a.prototype._playPrevious=function(){this._setIndexes(this._previous);this._playCurrentIndexItem();};a.prototype._playNext=function(){this._itemCountToHideHelpLayer++;if(this._itemCountToHideHelpLayer===this._MAX_INDEX_TO_HIDE_HELP){this._banner.hideHelpLayer();}this._setIndexes(this._next);this._playCurrentIndexItem();};a.prototype._stopPlayback=function(c){var d={};d.index=this._index;if(c){b.app.ContextHelper.closeContext();}else{if(this._playMode===this._PLAY_MODES.SINGLE){this._playCurrentIndexItem();}else{this._playNext();}}};a.prototype._updateBannerPlayBackPositions=function(){var d=this,c=b.app.fullScreenPlayer.seekTrickPlay.getPlaybackPosition();this._banner.update({playerDuration:this._getContentDurationText(c)});};a.prototype._getContentDurationText=function(c){var d=Math.floor(c/60),e=Math.floor(c%60);if(e<10){e="0"+e;}return d+":"+e;};a.prototype._showBanner=function(){};b.app.players.AudioPlayer=a;}($N));var $N=window.parent.$N;$N.app=$N.app||{};$N.app.players=$N.app.players||{};(function(a){function b(d,c,e){b.superConstructor.call(this,c);this._log=new a.apps.core.Log("MediaPlayer","HLSPlayer");this._controller=d;this._fullscreenPlayer=e;this._bookmarkManager=null;this._startPosition=0;this._bookMarkedPosition=0;this._trickPlayObj=a.app.fullScreenPlayer.seekTrickPlay;this._trickPlayObj.setPlayRateMultipliers([200,400,800,1600,3200]);}a.apps.util.Util.extend(b,a.app.players.BasePlayer);b.prototype.initialise=function(){var c=this;b.superClass.initialise.call(this);this._failureCallback=function(){};this._playerPlayingListener=function(){if(c._startPosition){a.app.fullScreenPlayer.seekTrickPlay.play();a.app.fullScreenPlayer.setPlaybackPosition(c._startPosition);}c._bookmarkManager.setContentDuration(a.app.fullScreenPlayer.getContentLength());c._updateBannerContentLength();c._updateBannerPlayBackPositions();a.app.fullScreenPlayer.unregisterPlayerPlayingListener(c._playerPlayingListener);};};b.prototype.activate=function(g){var e,d=this,c=function(){d._banner.hide();this._controller.hideBackLabel();},f=null;if(g.failureCallback){this._failureCallback=g.failureCallback;}a.app.fullScreenPlayer.registerPlayerConnectFailedListener(this._failureCallback);if(!g.preview){this._fullscreenPlayer.show();this._banner.update({title:g.title,subtitle:g.subtitle||"",channelLogo:g.channelLogo||"",channelNumber:g.channelNumber||"",image:g.promoUrl||"",vodLabel:this._controller.getString("vod")||""});this._startPosition=g.startPosition||0;if(g.bookmark){this._bookmarkManager=g.bookmark;}a.app.fullScreenPlayer.registerPlayerConnectedListener(this._playerPlayingListener);this._bookmarkManager.setContentDuration(a.app.fullScreenPlayer.getContentLength());b.superClass.activate.call(this,g);this._updateBannerPlayBackPositions();}else{a.app.fullScreenPlayer.stopPlayout();this._fullscreenPlayer.hide();this._banner.hide();this._controller.hideBackLabel();e=g.preview;a.app.fullScreenPlayer.seekTrickPlay.setPlayerPlayingCallback(function(){});a.app.fullScreenPlayer.seekTrickPlay.setPlayerAtBeginningCallback(function(){});a.app.fullScreenPlayer.seekTrickPlay.setPlayerAtEndCallback(function(){a.app.fullScreenPlayer.tuner.disconnect();a.app.fullScreenPlayer.tuner.tune(g.url);});a.app.fullScreenPlayer.seekTrickPlay.setUIRefreshCallback(function(){});a.app.fullScreenPlayer.seekTrickPlay.registerEventListeners();a.app.fullScreenPlayer.tuner.tune(g.url);a.app.fullScreenPlayer.tuner.showInSVGVideo(e.getRootSVGRef());}if(!a.app.EnvironmentUtil.isSTBEnvironmentIP()){a.app.fullScreenPlayer.registerPlayerFailureListeners();}a.app.HotPlug.setDialogShownCallback(c);a.app.ErrorMessage.setDialogShownCallback(c);};b.prototype.passivate=function(){b.superClass.passivate.call(this);this._stopTrickPlay();a.app.fullScreenPlayer.unregisterPlayerConnectedListener(this._playerConnectedListener);a.app.fullScreenPlayer.unregisterPlayerConnectFailedListener(this._failureCallback);if(!a.app.EnvironmentUtil.isSTBEnvironmentIP()){a.app.fullScreenPlayer.unregisterPlayerFailureListeners();}a.app.HotPlug.setDialogShownCallback(function(){});a.app.ErrorMessage.setDialogShownCallback(function(){});};b.prototype._updateBannerContentLength=function(){var e=this,c=a.app.fullScreenPlayer.getContentLength(),d=a.app.fullScreenPlayer.seekTrickPlay.getPlaybackPosition();this._banner.update({progressLowerBound:0,progressUpperBound:c,progressBarLowerLabel:this._getContentLengthText(d),progressBarUpperLabel:this._getContentLengthText(c)});};b.prototype._updateBannerPlayBackPositions=function(){this._updateBannerContentLength();var c=a.app.fullScreenPlayer.seekTrickPlay.getPlaybackPosition();this._banner.update({progressBarValue:c,progressHeadValue:c});};b.prototype._updateBannerTrickPlayIndicators=function(d,c){this._banner.update({trickPlayIcon:d,trickPlaySpeed:c});};b.prototype._finishPlayback=function(){var c=0;if(!this._isTrailer){this._bookmarkManager.setContentDuration(a.app.fullScreenPlayer.getContentLength());c=a.app.fullScreenPlayer.seekTrickPlay.getPlaybackPosition();if(this._bookmarkManager.deleteOrBookmarkCurrentPosition(c)){this._bookMarkedPosition=c;}else{this._bookMarkedPosition=0;}}this._playbackFinished=true;this._stopTrickPlay();a.app.fullScreenPlayer.stopPlayout(true);};b.prototype.keyHandler=function(c){var d=a.apps.core.KeyInterceptor.getKeyMap();switch(c){case d.KEY_LEFT:return true;}b.superClass.keyHandler.call(this,c);};a.app.players.HLSPlayer=b;}($N));var $N=window.parent.$N;$N.app=$N.app||{};$N.app.players=$N.app.players||{};(function(b){function a(d,c,e){a.superConstructor.call(this,c);this._log=new b.apps.core.Log("MediaPlayer","TimeShiftPlayer");this._controller=d;this._fullscreenPlayer=e;this._startPosition=0;this._event={};this._isStopPressed=false;this.SPEED_INDICATOR_FADEOUT_TIME=500;this.PLAY_SPEED=100;this.PAUSE_SPEED=0;this.SPEED_REW_MULTIPLIERS=[100,200,400,800,1600,3200,6400];this.SPEED_FFW_MULTIPLIERS=[200,400,800,1600,3200,6400];this.RETURN_TO_LIVE_INDEX=0;this.REW_INDEX=1;this.PLAY_PAUSE_INDEX=2;this.FFW_INDEX=3;this._speedIndicatorTimeout=null;this._closeContext=false;this.pinHelper=null;this.isReviewBufferActive=false;this._boundPlayerCaughtUptoLiveListener=null;}b.apps.util.Util.extend(a,b.app.players.BasePlayer);a.prototype.initialise=function(){var c=this;a.superClass.initialise.call(this);this._failureCallback=function(){};this._playerOnSignalLostCallback=function(){var e=1,d=[{name:c._controller.getString("back"),action:e}],f=function(g){if(g&&g.action===e){c.exit();}};b.app.DialogueHelper.createAndShowDialogue(b.app.constants.DLG_TS_SIGNAL_LOSS,c._controller.getString("timeshiftStoppedTitle"),c._controller.getString("timeshiftStoppedSubTitle"),d,f);};this._streamStartedListener=function(d){b.app.TracksUtil.activateCurrentPrefSubtitleTrack();};this._playerCaughtUptoLiveListener=function(){c.exit();c.resetBannerTimeout();};this._eventBoundaryChangedListener=function(e){var d=e.eventBoundaryChangedInfo.eventID;if(d&&d!==c._event.eventId){c._event=b.app.epgUtil.getMappedEventById(d);c._updateBannerEventInfo();c._showPopUpIfBlocked();}};this._playerConnectedListener=function(){if(c._startPosition){b.app.fullScreenPlayer.tuner.hideVideo();setTimeout(function(){b.app.fullScreenPlayer.setPlaybackPosition(c._startPosition);b.app.fullScreenPlayer.tuner.showVideo();},100);}c._updateBannerPlayBackPositions();};this._reviewBufferFailedListener=function(d){c.exit();c.resetBannerTimeout();};this._pinSuccessCallback=function(){this.isReviewBufferActive=false;setTimeout(function(){if(b.apps.core.ContextManager.getDefaultContext().getId()==="ZAPPER"){b.apps.core.ContextManager.getDefaultContext().getController().updateBannerAndTuneIfNeeded(b.platform.btv.EPG.getChannelByServiceId(c._event.serviceId),c._event);}b.app.TracksUtil.activateAudioTrack();c._showBanner();},1000);};this._pinKeyPressCallback=function(e,d){var f=function(){c.pinHelper.hideDialog();c.resetBannerTimeout();c._showBanner();};c.pinHelper.handlePinKeyPressCallback(d,f);};this._pinCancelledCallback=function(){c._showBanner();};this.pinHelper=new b.app.PinHelper(this._pinSuccessCallback,null,null,this._pinCancelledCallback,b.app.constants.PIN_DIALOG_SHOW_TIME,false);};a.prototype.activate=function(c){this._event=c.event;this._isActiveRecording=c.actualStopTime?false:true;this._isStopPressed=false;this.isReviewBufferActive=true;this._failureCallback=function(){};b.app.fullScreenPlayer.registerPlayerConnectedListener(this._playerConnectedListener);if(c.failureCallback){this._failureCallback=c.failureCallback;}b.app.fullScreenPlayer.registerPlayerConnectFailedListener(this._failureCallback);this._boundPlayerCaughtUptoLiveListener=this._playerCaughtUptoLiveListener.bind(this);b.app.fullScreenPlayer.registerCaughtUptoLiveListener(this._boundPlayerCaughtUptoLiveListener);b.app.fullScreenPlayer.registerSignalLoss(this._playerOnSignalLostCallback);b.app.fullScreenPlayer.registerEventBoundaryChangedListener(this._eventBoundaryChangedListener);b.app.fullScreenPlayer.registerReviewBufferCallbacks(null,this._reviewBufferFailedListener);this._fullscreenPlayer.show();this._banner.setStopKeyText(this._controller.getString("live"));this._updateBannerEventInfo();this._trickPlayObj.setDirectMode(true);this._trickPlayObj.setAllowSpeedCycle(false);this._startPosition=c.startPosition||0;if(c.dontRestartStream&&!c.atEndOfPlayBack){if(this._startPosition===0){b.app.fullScreenPlayer.setPlaybackPosition(0);}this._trickPlayObj.play();}a.superClass.activate.call(this,c);if(b.app.fullScreenPlayer){if(c.audiotrack){b.app.fullScreenPlayer.tracks.activateAudioTrackByLanguage(c.audiotrack.language);}if(c.subtitletrack){b.app.fullScreenPlayer.tracks.activateSubtitleTrackByLanguage(c.subtitletrack.language);}else{b.app.TracksUtil.deactivateCurrentSubtitleTrack();}}this._startUpdateInterval();this.keyHandler(c.triggerKey);};a.prototype.passivate=function(){this.isReviewBufferActive=false;a.superClass.passivate.call(this);b.app.fullScreenPlayer.jumpToLive();b.app.fullScreenPlayer.unregisterPlayerConnectedListener(this._playerConnectedListener);b.app.fullScreenPlayer.unregisterPlayerConnectFailedListener(this._failureCallback);b.app.fullScreenPlayer.unregisterCaughtUptoLiveListener(this._boundPlayerCaughtUptoLiveListener);b.app.fullScreenPlayer.unregisterSignalLoss(this._playerOnSignalLostCallback);b.app.fullScreenPlayer.unregisterEventBoundaryChangedListener(this._eventBoundaryChangedListener);b.app.fullScreenPlayer.unregisterReviewBufferCallbacks(null,this._reviewBufferFailedListener);this._boundPlayerCaughtUptoLiveListener=null;this._closeContext=false;};a.prototype.focus=function(){this.isReviewBufferActive=true;a.superClass.focus.call(this);if(this._closeContext){this._closeContext=false;b.app.ContextHelper.closeContext();}};a.prototype.defocus=function(){this.isReviewBufferActive=false;a.superClass.defocus.call(this);};a.prototype._showBanner=function(){var c=this;this._cancelBannerHide();if(this._getBannerTimeout()!==-1){this._bannerTimeout=window.parent.setTimeout(function(){c._stopUpdateInterval();c._clockDisplay.hide();c._controller.hideBackLabel();c._banner.hide();if(c.isReviewBufferActive){c._showPopUpIfBlocked();}},this._getBannerTimeout());}if(!this._banner.isVisible()){this._startUpdateInterval();this._ifTrailerShowBackLabel();this._banner.show();}};a.prototype.resetBannerTimeout=function(){var c=this;if(this._bannerTimeout){window.parent.clearTimeout(this._bannerTimeout);}if(this._getBannerTimeout()!==-1){this._bannerTimeout=window.parent.setTimeout(function(){c._stopUpdateInterval();c._clockDisplay.hide();c._controller.hideBackLabel();c._banner.hide();if(c.isReviewBufferActive){c._showPopUpIfBlocked();}},this._getBannerTimeout());}};a.prototype.keyHandler=function(d){var j=false,h=b.apps.core.KeyInterceptor.getKeyMap(),g=this,i=null,c=0,f=1,e=10;if(!b.app.PVRCapability.isPVREnabled){this.goBackToZapper(d);j=true;}else{switch(d){case h.KEY_ZERO:case h.KEY_ONE:case h.KEY_TWO:case h.KEY_THREE:case h.KEY_FOUR:case h.KEY_FIVE:case h.KEY_SIX:case h.KEY_SEVEN:case h.KEY_EIGHT:case h.KEY_NINE:case h.KEY_FAVOURITES:this.goToMiniGuideWithKey(d);j=true;break;case h.KEY_CHAN_UP:case h.KEY_CHAN_DOWN:b.app.ContextHelper.openContext("ZAPPER",{activationContext:{keyHandlerKey:d,showBanner:true}});j=true;break;case h.KEY_LEFT:if(this._banner.isVisible()){this._banner.selectPrevious();}j=true;break;case h.KEY_RIGHT:if(this._banner.isVisible()){this._banner.selectNext();}j=true;break;case h.KEY_OK:this.okPressedHandler();j=true;break;case h.KEY_EXIT:case h.KEY_BACK:case h.KEY_DOWN:this._banner.hide();this._showPopUpIfBlocked();j=true;break;case h.KEY_STOP:this.exit();this.isReviewBufferActive=false;j=true;break;case h.KEY_FFW:if(this._trickPlayObj.getTrickPlayMode()===b.platform.output.TrickPlay.MODES.RW){this._trickPlayObj.play();}else{this._trickPlayObj.setPlayRateMultipliers(this.SPEED_FFW_MULTIPLIERS);this._banner.select(this.FFW_INDEX);this._trickPlayObj.fastForward();}j=true;break;case h.KEY_REW:if(this._trickPlayObj.getTrickPlayMode()===b.platform.output.TrickPlay.MODES.FF){this._trickPlayObj.play();}else{this._trickPlayObj.setPlayRateMultipliers(this.SPEED_REW_MULTIPLIERS);this._banner.select(this.REW_INDEX);this._trickPlayObj.rewind();}j=true;break;case h.KEY_PLAY:case h.KEY_PAUSE:case h.KEY_PLAY_PAUSE:this._banner.select(this.PLAY_PAUSE_INDEX);this._trickPlayObj.playPause();j=true;break;case h.KEY_REPLAY:this._trickPlayObj.play();this._updateBannerPlayBackPositions();i=b.app.fullScreenPlayer.getPlaybackPosition();setTimeout(function(){if(i<=f){i=(b.app.fullScreenPlayer.getReviewBufferInfo().currentPosition)/1000;}if(i>e){c=i-e;b.app.fullScreenPlayer.setPlaybackPosition(c);g._updateBannerPlayBackPositions();}},100);j=true;break;case h.KEY_INFO:case h.KEY_RED:b.app.epgUtil.navigateToSynopsis(this._event);j=true;break;case h.KEY_UP:if(this._banner.isVisible()){b.app.ContextHelper.openContext("MINIGUIDE",{activationContext:{keyHandlerKey:d,showBanner:true,hideBanner:false,inTrickplayMode:true}});}else{this._showBanner();}j=true;break;case h.KEY_RECORD:if(this._event&&this._event.eventId&&b.app.PVRUtil.isRecordable(this._event)){b.app.PVRUtil.recordOrCancelEvent(this._event);j=true;}break;default:this._isStopPressed=false;break;}if(j){if(this._trickPlayObj.getTrickPlayMode()===b.platform.output.TrickPlay.MODES.PLAY){this.resetBannerTimeout();}}else{j=a.superClass.keyHandler.call(this,d);}}return j;};a.prototype.goBackToZapper=function(){b.app.ContextHelper.closeContext();};a.prototype.goToMiniGuideWithKey=function(c){b.app.ContextHelper.openContext("MINIGUIDE",{activationContext:{keyHandlerKey:c,hideBanner:false,inTrickplayMode:true}});};a.prototype.exit=function(){if(this._trickPlayObj.getTrickPlayMode()!==b.platform.output.TrickPlay.MODES.PLAY){this._trickPlayObj.play();}if(this._hasFocus){b.app.ContextHelper.closeContext();}else{this._closeContext=true;}};a.prototype.cancelHideSpeedIndicatorTimer=function(){if(this._speedIndicatorTimeout){clearTimeout(this._speedIndicatorTimeout);this._speedIndicatorTimeout=null;}};a.prototype.setHideSpeedIndicatorTimer=function(){var d=this,c=function(){d._banner.setSpeedIndicatorText("");};this._speedIndicatorTimeout=setTimeout(c,this.SPEED_INDICATOR_FADEOUT_TIME);};a.prototype.okPressedHandler=function(){var c,d=b.apps.core.KeyInterceptor.getKeyMap();if(this._banner.isVisible()){switch(this._banner.getSelectedIndex()){case this.RETURN_TO_LIVE_INDEX:c=d.KEY_STOP;this.isReviewBufferActive=false;break;case this.REW_INDEX:c=d.KEY_REW;break;case this.PLAY_PAUSE_INDEX:c=d.KEY_PLAY_PAUSE;break;case this.FFW_INDEX:c=d.KEY_FFW;break;}this.keyHandler(c);}else{this._showBanner();}};a.prototype._updateBannerEventInfo=function(){var c="";if(b.app.EventUtil.isValidEvent(this._event)){if(this._event.displaySeasonEpisode===true){c=b.app.epgUtil.getSeasonEpisodeAbbreviation(this._event.seriesId,this._event.episodeId);}this._banner.setEventNameText(this._event.title,c);this._banner.setProgressBarStartEnd(this._event.startTime,this._event.endTime);}else{this._banner.setEventNameText("");this._banner.setProgressBarStartEnd(b.app.fullScreenPlayer.getReviewBufferStartTime(),b.app.fullScreenPlayer.getReviewBufferEndTime());}};a.prototype._showPopUpIfBlocked=function(){if(this._event){var c=b.platform.btv.EPG.getChannelByServiceId(this._event.serviceId),d=b.app.ParentalControlUtil.isChannelLocked(c);if(b.app.ParentalControlUtil.isChannelOrProgramLocked(this._event)&&this.isReviewBufferActive){if((this._trickPlayObj.getTrickPlayMode()===b.platform.output.TrickPlay.MODES.FF)||this._trickPlayObj.getTrickPlayMode()===b.platform.output.TrickPlay.MODES.RW){this._trickPlayObj.playPause();}if(this._trickPlayObj.getTrickPlayMode()!==b.platform.output.TrickPlay.MODES.PAUSE){this._banner.select(this.PLAY_PAUSE_INDEX);this._trickPlayObj.playPause();}this.pinHelper.setDialogProperties({x:0,y:0,width:1920,height:1080,id:"PinDialog",title:d?this._controller.getString("channelLocked"):this._controller.getString("programLocked"),description:d?this._controller.getString("unlockChannel"):this._controller.getString("unlockShow"),keyPressedCallback:this._pinKeyPressCallback,titleCssClass:"pinEntryTitle"});this.pinHelper.showPinDialog("master",true,null,true);b.app.fullScreenPlayer.tuner.hideVideo();b.app.TracksUtil.deactivateAudioTrack();}}};a.prototype._updateBannerPlayBackPositions=function(){var c=b.app.fullScreenPlayer.getReviewBufferInfo();if(b.app.EventUtil.isValidEvent(this._event)){this._banner.updateProgressBar(this._event.startTime,this._event.endTime,c.startPosition,c.endPosition,c.currentPosition);}else{this._banner.setProgressBarStartEnd(b.app.fullScreenPlayer.getReviewBufferStartTime(),b.app.fullScreenPlayer.getReviewBufferEndTime());this._banner.updateProgressBar(c.startPosition,c.endPosition,c.startPosition,c.endPosition,c.currentPosition);}};a.prototype._updateBannerTrickPlayIndicators=function(d,c){if(d===null||c===null){return;}this._banner.hideSpeedIndicator();this._banner.setSpeedIndicatorX(d);switch(c){case this.PAUSE_SPEED:this._banner.togglePlayPauseIcon(false);this._banner.select(this.PLAY_PAUSE_INDEX);break;case this.PLAY_SPEED:this._banner.togglePlayPauseIcon(true);this._banner.select(this.PLAY_PAUSE_INDEX);this._banner.setSpeedIndicatorText("x1");this.setHideSpeedIndicatorTimer();this._banner.showSpeedIndicator();break;default:this._banner.togglePlayPauseIcon(false);this._banner.setSpeedIndicatorText("x"+String(Math.abs(c)/100));this.cancelHideSpeedIndicatorTimer();this._banner.showSpeedIndicator();}};a.prototype._updateBannerTitle=function(c){};b.app.players.TimeShiftPlayer=a;}($N));var $N=window.parent.$N,BaseBanner=BaseBanner||{};function ImageBanner(b,a){$N.apps.core.Language.adornWithGetString(ImageBanner,"apps/mediaPlayer/common/");ImageBanner.superConstructor.call(this,b);this._log=new $N.apps.core.Log("MediaPlayer","ImageBanner");this.CONTAINER_WIDTH=200;this.ICON_POSITION_Y=200;this.SPACE_BETWEEN_ICONS=30;this.PROGRESS_WIDTH=393;this.playing=false;this.shuffleOn=false;this.repeatOn=false;this.trickKeysLabelText=null;this.iconUpdateTimer=null;this._container.configure({x:0,y:0,height:580,width:1920});this._backgroundBox.configure({x:0,y:0,height:580,width:1920,cssClass:"synopsisFadeGradientBottom",opacity:1});this._slideshowContainer=new $N.gui.Container(b,this._container);this._slideshowIcon=new $N.gui.Image(b,this._slideshowContainer);this.SLIDESHOW_PLAY="../../../customise/resources/images/%RES/icons/play_slideshow_icon.png";this.SLIDESHOW_STOP="../../../customise/resources/images/%RES/icons/stop_slideshow_icon.png";this._backIconContainer=new $N.gui.Container(b,this._container);this._backIcon=new $N.gui.Image(b,this._backIconContainer);this._backIcon.iconUrl="../../../customise/resources/images/%RES/icons/optionIcons/back_icon.png";this._slideshowIconLabel=new $N.gui.Label(b,this._slideshowContainer);this._backIconLabel=new $N.gui.Label(b,this._backIconContainer);this._folderNameLabel=new $N.gui.Label(b,this._container);this._imageNameLabel=new $N.gui.Label(b,this._container);this._currentTrackLabel=new $N.gui.Label(b,this._container);this._totalTracksLabel=new $N.gui.Label(b,this._container);this._leftArrowHollowIcon=new $N.gui.SVGlink(b,this._container);this._leftArrowSolidIcon=new $N.gui.SVGlink(b,this._container);this.LEFT_ARROW_HOLLOW_ICON="../../../customise/resources/svg/icons.svg#photoPlayerHollowLeftArrowIcon";this.LEFT_ARROW_SOLID_ICON="../../../customise/resources/svg/icons.svg#photoPlayerSolidLeftArrowIcon";this._rightArrowHollowIcon=new $N.gui.SVGlink(b,this._container);this._rightArrowSolidIcon=new $N.gui.SVGlink(b,this._container);this.RIGHT_ARROW_HOLLOW_ICON="../../../customise/resources/svg/icons.svg#photoPlayerHollowRightArrowIcon";this.RIGHT_ARROW_SOLID_ICON="../../../customise/resources/svg/icons.svg#photoPlayerSolidRightArrowIcon";this._items=[];this._items=[this._slideshowContainer,this._backIconContainer];this._selectedItemIndex=0;this._bannerTimeout=null;this.showOnlyArrows=false;this._fullInfo=new $N.gui.TextArea(b,this._container);this._fullInfo.configure({x:0,y:505,width:1920,maxHeight:50,cssClass:"photoPlayerLabelText"});this._slideshowContainer.configure({x:850,y:370,height:48,width:this.CONTAINER_WIDTH,rounding:2,cssClass:"timeShiftButton",visible:false});this._slideshowIcon.configure({x:23,y:7,height:35,width:40,href:this.SLIDESHOW_PLAY,visible:false});this._backIconContainer.configure({x:850,y:440,height:48,width:this.CONTAINER_WIDTH,rounding:2,cssClass:"timeShiftButton",visible:false});this._backIcon.configure({x:23,y:5,height:40,width:40,href:this._backIcon.iconUrl,visible:false});this._slideshowIconLabel.configure({x:70,y:30,height:30,width:30,cssClass:"photoPlayerIconLabelText",visible:false});this._backIconLabel.configure({x:90,y:30,height:30,width:30,cssClass:"photoPlayerIconLabelText",visible:false});this._leftArrowHollowIcon.configure({x:60,y:20,height:30,width:30,href:this.LEFT_ARROW_HOLLOW_ICON,visible:false});this._leftArrowSolidIcon.configure({x:60,y:20,height:30,width:30,href:this.LEFT_ARROW_SOLID_ICON,visible:false});this._rightArrowHollowIcon.configure({x:1840,y:35,height:30,width:30,href:this.RIGHT_ARROW_HOLLOW_ICON,visible:false});this._rightArrowSolidIcon.configure({x:1840,y:35,height:30,width:30,href:this.RIGHT_ARROW_SOLID_ICON,visible:false});this._currentTrackLabel.configure({x:1130,y:530,height:20,width:57,cssClass:"photoPlayerLabelRightAlign",visible:false});this._totalTracksLabel.configure({x:1195,y:530,height:20,width:50,cssClass:"photoPlayerLabelRightAlign",visible:false});this._folderNameLabel.configure({x:600,y:530,height:20,width:150,cssClass:"photoPlayerLabelText",visible:false});this._imageNameLabel.configure({x:800,y:530,height:20,width:200,cssClass:"photoPlayerLabelText",visible:false});this._rootSVGRef=this._container.getRootSVGRef();if(a){a.addChild(this);}}$N.gui.Util.extend(ImageBanner,BaseBanner);ImageBanner.prototype.hideAllIcons=function(){this._playPauseContainer.hide();this._playPauseIcon.hide();this._ffwContainer.hide();this._ffwIcon.hide();this._rewContainer.hide();this._rewIcon.hide();this._progress.hide();this._slideshowContainer.hide();this._slideshowIcon.hide();this._backIconContainer.hide();this._backIcon.hide();this._currentTrackLabel.hide();this._totalTracksLabel.hide();this._imageNameLabel.hide();this._folderNameLabel.hide();};ImageBanner.prototype.showAllIcons=function(){this._slideshowContainer.show();this._slideshowIcon.show();this._backIconContainer.show();this._backIcon.show();this._backgroundBox.show();};ImageBanner.prototype.setIconsForBanner=function(d,b){var a=$N.app.constants.TRICKPLAY_ICONS_FOR_PHOTO_AUDIO_VIDEO_PLAYBACK,c;this._items=[];this.configuredIcons=[];this.folderNameText=" ";this.hideAllIcons();this.preferredIconsListLength=d.length;if(this.preferredIconsListLength>1){for(c=0;c<this.preferredIconsListLength;c++){switch(d[c]){case a.SLIDESHOW:this._items.push(this._slideshowContainer);this.configuredIcons.push(a.SLIDESHOW);if(this.slideshowOn){this._slideshowIcon.setHref(this.SLIDESHOW_STOP);}else{this._slideshowIcon.setHref(this.SLIDESHOW_PLAY);}this._slideshowIcon.show();this._slideshowIconLabel.setText(ImageBanner.getString("slideshow"));this._slideshowIconLabel.show();break;case a.BACK:this._items.push(this._backIconContainer);this.configuredIcons.push(a.BACK);this._backIcon.show();this._backIconLabel.setText(ImageBanner.getString("back"));this._backIconLabel.show();break;}}this.showHollowArrows();for(c=0;c<this._items.length;c++){this._items[c].show();}}else{this._items.push(this._backIconContainer);this.configuredIcons.push(a.BACK);this._backIcon.show();this._backIconLabel.setText("back");this._backIconLabel.show();this._items[0].show();this.hideArrows();}};ImageBanner.prototype.showInfoText=function(){if(!this.showOnlyArrows){this._fullInfo.setText($N.app.StringUtil.join(" \u00A0",this.folderNameText," "+this.fileNameText+"  \u00A0"+this.currentTrackText+" "+ImageBanner.getString("of")+" "+this.totalTrackText));this._fullInfo.show();}};ImageBanner.prototype.show=function(){this.showOnlyArrows=false;if(this.preferredIconsListLength>1){this.showAllIcons();}ImageBanner.superClass.show.call(this);this.showInfoText();};ImageBanner.prototype.showArrows=function(){this.showOnlyArrows=true;this.hideAllIcons();this._backgroundBox.hide();this._fullInfo.hide();ImageBanner.superClass.show.call(this);this.showHollowArrows();};ImageBanner.prototype.setImageName=function(a){if(!this.showOnlyArrows){this._imageNameLabel.show();}this.fileNameText=a;this.showInfoText();};ImageBanner.prototype.setFolderName=function(a){this.folderNameText=a;this.showInfoText();};ImageBanner.prototype.clearUpdateIconTimer=function(){if(this.iconUpdateTimer){clearTimeout(this.iconUpdateTimer);this.iconUpdateTimer=null;}};ImageBanner.prototype.updateIconAfterTimeout=function(a){if(this.iconUpdateTimer){this.clearUpdateIconTimer();}this.iconUpdateTimer=setTimeout(a,1000);};ImageBanner.prototype.unHighlightLeftArrow=function(){this._leftArrowSolidIcon.hide();this._leftArrowHollowIcon.show();};ImageBanner.prototype.unHighlightRightArrow=function(){this._rightArrowSolidIcon.hide();this._rightArrowHollowIcon.show();};ImageBanner.prototype.highlightRightArrow=function(){var a=this,b=function(){a._rightArrowSolidIcon.hide();a._rightArrowHollowIcon.show();};this.clearUpdateIconTimer();this.unHighlightLeftArrow();this._rightArrowHollowIcon.hide();this._rightArrowSolidIcon.hide();this._rightArrowSolidIcon.show();this.updateIconAfterTimeout(b);};ImageBanner.prototype.highlightLeftArrow=function(){var b=this,a=function(){b._leftArrowSolidIcon.hide();b._leftArrowHollowIcon.show();};this.clearUpdateIconTimer();this.unHighlightRightArrow();this._leftArrowHollowIcon.hide();this._leftArrowSolidIcon.hide();this._leftArrowSolidIcon.show();this.updateIconAfterTimeout(a);};ImageBanner.prototype.hideArrows=function(){this._leftArrowSolidIcon.hide();this._rightArrowSolidIcon.hide();this._leftArrowHollowIcon.hide();this._rightArrowHollowIcon.hide();};ImageBanner.prototype.showHollowArrows=function(){this.clearUpdateIconTimer();this._leftArrowSolidIcon.hide();this._rightArrowSolidIcon.hide();this._leftArrowHollowIcon.show();this._rightArrowHollowIcon.show();};ImageBanner.prototype.setCurrentTrackLabel=function(a){this._currentTrackLabel.setText(a);};ImageBanner.prototype.setTotalTracksLabel=function(a){this._totalTracksLabel.setText(a);};ImageBanner.prototype.showTracksLabel=function(){this._currentTrackLabel.show();this._totalTracksLabel.show();this.showInfoText();};ImageBanner.prototype.setCurrentAndTotalTracks=function(b,a){this.currentTrackText=b;this.totalTrackText=a;this.setCurrentTrackLabel(b);this.setTotalTracksLabel(ImageBanner.getString("of")+" "+a);};ImageBanner.prototype.updateCurrentTrack=function(a){this.setCurrentTrackLabel(a);this.currentTrackText=a;this.showInfoText();};ImageBanner.prototype.toggleSlideShowIcon=function(a){var b=a?this.SLIDESHOW_STOP:this.SLIDESHOW_PLAY;this.slideshowOn=a;this._slideshowIcon.setHref(b);};ImageBanner.prototype.getSelectedIndex=function(){return this._selectedItemIndex;};ImageBanner.prototype.getIndexForIcon=function(c){var a,b=this.configuredIcons.length;for(a=0;a<b;a++){if(this.configuredIcons[a]===c){return a;}}return null;};ImageBanner.prototype.updateFocusForIcon=function(b){var a;a=this.getIndexForIcon(b);if(a!==null){this.deFocusSelectedIcon();this.selectIconAtIndex(a);}};ImageBanner.prototype.deFocusSelectedIcon=function(){var a=this._items[this._selectedItemIndex];if(a){a.setCssClass("timeShiftButton");}};ImageBanner.prototype.selectIconAtIndex=function(a){var d=this._items[a],c=this._items.length,b;for(b=0;b<c;b++){if(d){d.setCssClass("timeShiftButton");}}if(d){this._selectedItemIndex=a;d.setCssClass("timeShiftButton_highlight");}};ImageBanner.prototype.select=function(a){var b=this._items[this._selectedItemIndex];if(a===this._selectedItemIndex){return;}if(b){b.setCssClass("timeShiftButton");}b=this._items[a];if(b){this._selectedItemIndex=a;b.setCssClass("timeShiftButton_highlight");}};ImageBanner.prototype.selectNext=function(){if(this._selectedItemIndex<this._items.length-1){this.select(this._selectedItemIndex+1);}};ImageBanner.prototype.selectPrevious=function(){if(this._selectedItemIndex>0){this.select(this._selectedItemIndex-1);}};ImageBanner.prototype.toString=function(){return"ImageBanner";};var $N=window.parent.$N,BaseBanner=BaseBanner||{};function MediaPlaybackBanner(b,a){$N.apps.core.Language.adornWithGetString(MediaPlaybackBanner,"apps/mediaPlayer/common/");MediaPlaybackBanner.superConstructor.call(this,b);this._log=new $N.apps.core.Log("MediaPlayer","MediaPlaybackBanner");this.ICON_POSITION_Y=250;this.CONTAINER_WIDTH=60;this.SPACE_BETWEEN_ICONS=30;this.PROGRESS_WIDTH=393;this.playing=false;this.shuffleOn=false;this.repeatOn=false;this.trickKeysLabelText=null;this.availableIconsForBanner=$N.app.constants.TRICKPLAY_ICONS_FOR_PHOTO_AUDIO_VIDEO_PLAYBACK;this.configuredIcons=[];this.preferredIconsListLength=null;this._backgroundBox.setCssClass("miniguideBackground");this._stopContainer=new $N.gui.Container(b,this._container);this._stopIcon=new $N.gui.SVGlink(b,this._stopContainer);this._stopIcon.iconUrl="../../../customise/resources/svg/icons.svg#playbackSTOP";this._replayContainer=new $N.gui.Container(b,this._container);this._replayIcon=new $N.gui.SVGlink(b,this._replayContainer);this._replayIcon.iconUrl="../../../customise/resources/svg/icons.svg#playbackREPLAY";this._previousIconContainer=new $N.gui.Container(b,this._container);this._previousIcon=new $N.gui.Image(b,this._previousIconContainer);this.PREVIOUS_ICON_URL="../../../customise/resources/images/%RES/icons/previous.png";this._shuffleContainer=new $N.gui.Container(b,this._container);this._shuffleIcon=new $N.gui.Image(b,this._shuffleContainer);this.SHUFFLE_ICON_URL="../../../customise/resources/images/%RES/icons/Icn_shuffle.png";this.SHUFFLE_SELECTED_ICON_URL="../../../customise/resources/images/%RES/icons/shuffle_highlight.png";this._nextIconContainer=new $N.gui.Container(b,this._container);this._nextIcon=new $N.gui.Image(b,this._nextIconContainer);this.NEXT_ICON_URL="../../../customise/resources/images/%RES/icons/next.png";this._repeatIconContainer=new $N.gui.Container(b,this._container);this._repeatIcon=new $N.gui.Image(b,this._repeatIconContainer);this.REPEAT_ICON_URL="../../../customise/resources/images/%RES/icons/repeat.png";this.REPEAT_SELECTED_ICON_URL="../../../customise/resources/images/%RES/icons/repeat_highlighted.png";this._iconLabel=new $N.gui.Label(b,this._container);this._currentTrackLabel=new $N.gui.Label(b,this._container);this._totalTracksLabel=new $N.gui.Label(b,this._container);this._okIcon=new $N.gui.Image(b,this._container);this._okIcon.iconUrl="../../../customise/resources/images/%RES/icons/botao_ok_branco.png";this._okIconPressLabel=new $N.gui.Label(b,this._container);this._okIconBackLabel=new $N.gui.Label(b,this._container);this._items=[];this._selectedItemIndex=0;this._bannerTimeout=null;this._iconLabel.configure({y:230,height:20,width:100,cssClass:"playbackIconLabelText",visible:false});this._currentTrackLabel.configure({x:870,y:360,height:20,width:57,cssClass:"playbackIconLabelTextRightAlign",visible:false});this._totalTracksLabel.configure({x:935,y:360,height:20,width:50,cssClass:"playbackIconLabelTextLeftAlign",visible:false});this._stopContainer.configure({y:this.ICON_POSITION_Y,height:60,width:this.CONTAINER_WIDTH,rounding:2,cssClass:"timeShiftButton",visible:false});this._stopIcon.configure({x:18,y:18,href:this._stopIcon.iconUrl,visible:false});this._replayContainer.configure({y:this.ICON_POSITION_Y,height:60,width:this.CONTAINER_WIDTH,rounding:2,cssClass:"timeShiftButton",visible:false});this._replayIcon.configure({x:-6,y:-6,href:this._replayIcon.iconUrl,visible:false});this._previousIconContainer.configure({y:this.ICON_POSITION_Y,height:60,width:this.CONTAINER_WIDTH,rounding:2,cssClass:"timeShiftButton",visible:false});this._previousIcon.configure({x:15,y:15,height:30,width:30,href:this.PREVIOUS_ICON_URL,visible:false});this._playPauseContainer.configure({x:950,y:this.ICON_POSITION_Y,visible:false});this._shuffleContainer.configure({y:this.ICON_POSITION_Y,height:60,width:this.CONTAINER_WIDTH,rounding:2,cssClass:"timeShiftButton",visible:false});this._shuffleIcon.configure({x:10,y:10,height:40,width:40,href:this.SHUFFLE_ICON_URL,visible:false});this._nextIconContainer.configure({y:this.ICON_POSITION_Y,height:60,width:this.CONTAINER_WIDTH,rounding:2,cssClass:"timeShiftButton",visible:false});this._nextIcon.configure({x:15,y:15,height:30,width:30,href:this.NEXT_ICON_URL,visible:false});this._repeatIconContainer.configure({y:this.ICON_POSITION_Y,height:60,width:this.CONTAINER_WIDTH,rounding:2,cssClass:"timeShiftButton",visible:false});this._repeatIcon.configure({x:10,y:10,height:40,width:40,href:this.REPEAT_ICON_URL,visible:false});this._progress.configure({y:this.ICON_POSITION_Y+10,width:this.PROGRESS_WIDTH,progressOuterCssClass:"timeShiftProgressOuter",progressInnerCssClass:"timeShiftProgressInner",progressBarProperties:{x:0,y:2,height:15,width:this.PROGRESS_WIDTH},startLabelProperties:{x:0,y:50,cssClass:"timeShiftProgressStartLabel"},endLabelProperties:{x:this.PROGRESS_WIDTH,y:50,cssClass:"timeShiftProgressEndLabel"}});this._rewContainer.configure({y:this.ICON_POSITION_Y,visible:false});this._ffwContainer.configure({y:this.ICON_POSITION_Y,visible:false});this._okIcon.configure({x:900,y:275,height:30,width:30,href:this._okIcon.iconUrl,visible:false});this._okIconPressLabel.configure({x:830,y:300,height:30,width:50,cssClass:"playbackIconLabelTextRightAlign",visible:false});this._okIconBackLabel.configure({x:975,y:300,height:30,width:100,cssClass:"playbackIconLabelText",visible:false});this._rootSVGRef=this._container.getRootSVGRef();if(a){a.addChild(this);}}$N.gui.Util.extend(MediaPlaybackBanner,BaseBanner);MediaPlaybackBanner.prototype.hideAllIcons=function(){this._playPauseContainer.hide();this._playPauseIcon.hide();this._stopContainer.hide();this._stopIcon.hide();this._ffwContainer.hide();this._ffwIcon.hide();this._rewContainer.hide();this._rewIcon.hide();this._nextIconContainer.hide();this._nextIcon.hide();this._previousIconContainer.hide();this._previousIcon.hide();this._shuffleContainer.hide();this._shuffleIcon.hide();this._replayContainer.hide();this._replayIcon.hide();this._iconLabel.hide();this._okIconPressLabel.hide();this._okIconBackLabel.hide();this._okIcon.hide();this._repeatIconContainer.hide();this._repeatIcon.hide();this._progress.hide();};MediaPlaybackBanner.prototype.setIconsForBanner=function(f,h){var j=$N.app.constants.TRICKPLAY_ICONS_FOR_PHOTO_AUDIO_VIDEO_PLAYBACK,c=1920,g,d,e,b=0,a=false;this.preferredIconsListLength=f.length;this.playing=false;this.shuffleOn=false;this.repeatOn=false;this._items=[];this.configuredIcons=[];this.hideAllIcons();if(this.preferredIconsListLength>=1){if(f[this.preferredIconsListLength-1]===(j.PROGRESSBAR)){b=330;a=true;}g=((this.preferredIconsListLength-1)*(this.CONTAINER_WIDTH+this.SPACE_BETWEEN_ICONS))+b;d=(c-g)/2;for(e=0;e<this.preferredIconsListLength;e++){switch(f[e]){case j.PLAY:this._items.push(this._playPauseContainer);this.configuredIcons.push(j.PLAY);this._playPauseContainer.setX(d+(e*(this.CONTAINER_WIDTH+this.SPACE_BETWEEN_ICONS)));this._playPauseIcon.setHref(this.PLAY_ICON_URL);this._playPauseIcon.show();break;case j.STOP:this._items.push(this._stopContainer);this.configuredIcons.push(j.STOP);this._stopContainer.setX(d+(e*(this.CONTAINER_WIDTH+this.SPACE_BETWEEN_ICONS)));this._stopIcon.show();break;case j.FWD:this._items.push(this._ffwContainer);this.configuredIcons.push(j.FWD);this._ffwContainer.setX(d+(e*(this.CONTAINER_WIDTH+this.SPACE_BETWEEN_ICONS)));this._ffwIcon.show();break;case j.RWD:this._items.push(this._rewContainer);this.configuredIcons.push(j.RWD);this._rewContainer.setX(d+(e*(this.CONTAINER_WIDTH+this.SPACE_BETWEEN_ICONS)));this._rewIcon.show();break;case j.NEXT:this._items.push(this._nextIconContainer);this.configuredIcons.push(j.NEXT);this._nextIconContainer.setX(d+(e*(this.CONTAINER_WIDTH+this.SPACE_BETWEEN_ICONS)));this._nextIcon.show();break;case j.PREVIOUS:this._items.push(this._previousIconContainer);this.configuredIcons.push(j.PREVIOUS);this._previousIconContainer.setX(d+(e*(this.CONTAINER_WIDTH+this.SPACE_BETWEEN_ICONS)));this._previousIcon.show();break;case j.SHUFFLE:this._items.push(this._shuffleContainer);this.configuredIcons.push(j.SHUFFLE);this._shuffleContainer.setX(d+(e*(this.CONTAINER_WIDTH+this.SPACE_BETWEEN_ICONS)));this.shuffleOn=(h&&h.shuffleModeEnabled)?true:false;if(this.shuffleOn){this._shuffleIcon.setHref(this.SHUFFLE_SELECTED_ICON_URL);}else{this._shuffleIcon.setHref(this.SHUFFLE_ICON_URL);}this._shuffleIcon.show();break;case j.REPLAY:this._items.push(this._replayContainer);this.configuredIcons.push(j.REPLAY);this._replayContainer.setX(d+(e*(this.CONTAINER_WIDTH+this.SPACE_BETWEEN_ICONS)));this._replayIcon.show();break;case j.PROGRESSBAR:this._items.push(this._progress);this.configuredIcons.push(j.PROGRESSBAR);this._progress.setX(d+(e*(this.CONTAINER_WIDTH+this.SPACE_BETWEEN_ICONS)));break;case j.REPEAT:this._items.push(this._repeatIconContainer);this.configuredIcons.push(j.REPEAT);this._repeatIconContainer.setX(d+(e*(this.CONTAINER_WIDTH+this.SPACE_BETWEEN_ICONS)));this._repeatIcon.setHref(this.REPEAT_ICON_URL);this._repeatIcon.show();break;}}for(e=0;e<this._items.length;e++){this._items[e].show();}if(a){this._items.pop();}}else{this._okIconPressLabel.setText(MediaPlaybackBanner.getString("pressLabel"));this._okIconBackLabel.setText(MediaPlaybackBanner.getString("okToGoBackLabel"));this._okIconPressLabel.show();this._okIconBackLabel.show();this._okIcon.show();}};MediaPlaybackBanner.prototype.show=function(){MediaPlaybackBanner.superClass.show.call(this);this.showTracksLabel();};MediaPlaybackBanner.prototype.setCurrentTrackLabel=function(a){this._currentTrackLabel.setText(a);};MediaPlaybackBanner.prototype.setTotalTracksLabel=function(a){this._totalTracksLabel.setText(a);};MediaPlaybackBanner.prototype.showCurrentTrackLabel=function(){this._currentTrackLabel.show();};MediaPlaybackBanner.prototype.showTotalTracksLabel=function(){this._totalTracksLabel.show();};MediaPlaybackBanner.prototype.showTracksLabel=function(){this.showCurrentTrackLabel();this.showTotalTracksLabel();};MediaPlaybackBanner.prototype.setCurrentAndTotalTracks=function(b,a){this.setCurrentTrackLabel(b);this.setTotalTracksLabel(MediaPlaybackBanner.getString("of")+" "+a);};MediaPlaybackBanner.prototype.updateCurrentTrack=function(a){this.setCurrentTrackLabel(a);this._currentTrackLabel.show();};MediaPlaybackBanner.prototype.setIconLabelXCoordinate=function(b){var a=0,c=20;switch(this.configuredIcons[b]){case this.availableIconsForBanner.STOP:a=this._stopContainer.getTrueX()-c;this._iconLabel.setText(MediaPlaybackBanner.getString("stop"));break;case this.availableIconsForBanner.REPLAY:a=this._replayContainer.getTrueX()-c;this._iconLabel.setText(MediaPlaybackBanner.getString("restart"));break;case this.availableIconsForBanner.PREVIOUS:a=this._previousIconContainer.getTrueX()-c;this._iconLabel.setText(MediaPlaybackBanner.getString("previous"));break;case this.availableIconsForBanner.PLAY:a=this._playPauseContainer.getTrueX()-c;if(this.playing){this._iconLabel.setText(MediaPlaybackBanner.getString("pause"));}else{this._iconLabel.setText(MediaPlaybackBanner.getString("play"));}break;case this.availableIconsForBanner.SHUFFLE:a=this._shuffleContainer.getTrueX()-c;if(this.shuffleOn){this._iconLabel.setText(MediaPlaybackBanner.getString("shuffleOff"));}else{this._iconLabel.setText(MediaPlaybackBanner.getString("shuffleOn"));}break;case this.availableIconsForBanner.NEXT:a=this._nextIconContainer.getTrueX()-c;this._iconLabel.setText(MediaPlaybackBanner.getString("next"));break;case this.availableIconsForBanner.REPEAT:a=this._repeatIconContainer.getTrueX()-c;if(this.repeatOn){this._iconLabel.setText(MediaPlaybackBanner.getString("repeatOff"));}else{this._iconLabel.setText(MediaPlaybackBanner.getString("repeatOn"));}break;case this.availableIconsForBanner.FWD:a=this._ffwContainer.getTrueX()-c;if(this.playing){this._iconLabel.setText(MediaPlaybackBanner.getString("forward"));}else{if(parseInt(this.trickKeysLabelText,10)>0){this._iconLabel.setText(this.trickKeysLabelText);}else{this._iconLabel.setText(MediaPlaybackBanner.getString("forward"));}}break;case this.availableIconsForBanner.RWD:a=this._rewContainer.getTrueX()-c;if(this.playing){this._iconLabel.setText(MediaPlaybackBanner.getString("rewind"));}else{if(parseInt(this.trickKeysLabelText,10)<0){this._iconLabel.setText(this.trickKeysLabelText);}else{this._iconLabel.setText(MediaPlaybackBanner.getString("rewind"));}}break;default:break;}this._iconLabel.setX(a);};MediaPlaybackBanner.prototype.setIconLabelText=function(a){this._iconLabel.setText(a);};MediaPlaybackBanner.prototype.showIconLabel=function(){this._iconLabel.show();};MediaPlaybackBanner.prototype.hideIconLabel=function(){this._iconLabel.hide();};MediaPlaybackBanner.prototype.getSelectedIndex=function(){return this._selectedItemIndex;};MediaPlaybackBanner.prototype.getIndexForIcon=function(c){var a,b=this.configuredIcons.length;for(a=0;a<b;a++){if(this.configuredIcons[a]===c){return a;}}return null;};MediaPlaybackBanner.prototype.updateFocusForIcon=function(b){var a;a=this.getIndexForIcon(b);if(a!==null){this.deFocusSelectedIcon();this.selectIconAtIndex(a);}};MediaPlaybackBanner.prototype.deFocusSelectedIcon=function(){var a=this._items[this._selectedItemIndex];if(a){a.setCssClass("timeShiftButton");}};MediaPlaybackBanner.prototype.selectIconAtIndex=function(a){var d=this._items[a],c=this._items.length,b;for(b=0;b<c;b++){if(d){d.setCssClass("timeShiftButton");}}if(d){this._selectedItemIndex=a;d.setCssClass("timeShiftButton_highlight");}};MediaPlaybackBanner.prototype.select=function(a){var b=this._items[this._selectedItemIndex];if(a===this._selectedItemIndex){return;}if(b){b.setCssClass("timeShiftButton");}b=this._items[a];if(b){this._selectedItemIndex=a;b.setCssClass("timeShiftButton_highlight");}};MediaPlaybackBanner.prototype.selectNext=function(){if(this._selectedItemIndex<this._items.length-1){this.select(this._selectedItemIndex+1);}};MediaPlaybackBanner.prototype.selectPrevious=function(){if(this._selectedItemIndex>0){this.select(this._selectedItemIndex-1);}};MediaPlaybackBanner.prototype.togglePlayPauseIcon=function(a){var b=a?this.PAUSE_ICON_URL:this.PLAY_ICON_URL;this.playing=a;this._playPauseIcon.setHref(b);};MediaPlaybackBanner.prototype.togglePlayPauseIconLabel=function(b){if(this.configuredIcons[this.getSelectedIndex()]===this.availableIconsForBanner.PLAY){var a=b?MediaPlaybackBanner.getString("pause"):MediaPlaybackBanner.getString("play");this.playing=b;this.setIconLabelText(a);this.showIconLabel();}};MediaPlaybackBanner.prototype.toggleShuffleIconAndLabel=function(b){var a;if(b){this._shuffleIcon.setHref(this.SHUFFLE_SELECTED_ICON_URL);a=MediaPlaybackBanner.getString("shuffleOff");}else{this._shuffleIcon.setHref(this.SHUFFLE_ICON_URL);a=MediaPlaybackBanner.getString("shuffleOn");}this.shuffleOn=b;};MediaPlaybackBanner.prototype.toggleRepeatIconAndLabel=function(b){var a;if(b){this._repeatIcon.setHref(this.REPEAT_SELECTED_ICON_URL);a=MediaPlaybackBanner.getString("repeatOff");}else{this._repeatIcon.setHref(this.REPEAT_ICON_URL);a=MediaPlaybackBanner.getString("repeatOn");}this.repeatOn=b;};MediaPlaybackBanner.prototype.setTrickKeysLabel=function(b,c){var a=this.configuredIcons[this.getSelectedIndex()],d=100;this.trickKeysLabelText=(String((b)/100)+"x");if(b===d){this.deFocusSelectedIcon();this.selectIconAtIndex(this.getIndexForIcon(c));this.trickKeysLabelText=MediaPlaybackBanner.getString("forward");this.hideIconLabel();return;}if(b!==d){this.deFocusSelectedIcon();this.selectIconAtIndex(this.getIndexForIcon(c));this.setIconLabelXCoordinate(this.getIndexForIcon(c));this.setIconLabelText(this.trickKeysLabelText);this.showIconLabel();}};MediaPlaybackBanner.prototype.setProgressBarStartEnd=function(b,a){this._progress.setProgressBarLabels(b,a);};MediaPlaybackBanner.prototype.toString=function(){return"MediaPlaybackBanner";};var $N=window.parent.$N,BaseBanner=BaseBanner||{};function PlaybackBanner(b,a){$N.apps.core.Language.adornWithGetString(PlaybackBanner,"apps/mediaPlayer/common/");PlaybackBanner.superConstructor.call(this,b);this._log=new $N.apps.core.Log("MediaPlayer","PlaybackBanner");this._radialGradient=new $N.gui.BackgroundBox(b,this._container);this._stopContainer=new $N.gui.Container(b,this._container);this._stopIcon=new $N.gui.SVGlink(b,this._stopContainer);this._stopIcon.iconUrl="../../../customise/resources/svg/icons.svg#playbackSTOP";this._replayContainer=new $N.gui.Container(b,this._container);this._replayIcon=new $N.gui.SVGlink(b,this._replayContainer);this._replayIcon.iconUrl="../../../customise/resources/svg/icons.svg#playbackREPLAY";this._items=[this._stopContainer,this._replayContainer,this._rewContainer,this._playPauseContainer,this._ffwContainer];this._radialGradient.configure({x:96,y:360,width:1728,height:240,cssClass:"nowFullAssetRadialGradient"});this._stopContainer.configure({x:330,y:299,height:60,width:60,rounding:2,cssClass:"timeShiftButton"});this._stopIcon.configure({x:18,y:18,href:this._stopIcon.iconUrl});this._replayContainer.configure({x:420,y:299,height:60,width:60,rounding:2,cssClass:"timeShiftButton"});this._replayIcon.configure({x:-6,y:-6,href:this._replayIcon.iconUrl});this._rootSVGRef=this._container.getRootSVGRef();if(a){a.addChild(this);}}$N.gui.Util.extend(PlaybackBanner,BaseBanner);PlaybackBanner.prototype.setProgressBarStartEnd=function(b,a){this._progress.setProgressBarLabels(b,a);};PlaybackBanner.prototype.toString=function(){return"PlaybackBanner";};var MediaPlayer=(function(b){var e=new b.apps.core.Log("MediaPlayer","MediaPlayer"),k={},l=null,o=null,a=null,n=null,f=null,g={},m=null,i=null,j=null,d=null,c=null,h=null;return{load:function(){b.gui.ResolutionManager.initialiseContext(document);b.apps.core.Language.importLanguageBundleForObject(MediaPlayer,MediaPlayer.init,"apps/mediaPlayer/common/","LanguageBundle.js",null,window);},init:function(){b.gui.FrameworkCore.loadGUIFromXML("apps/mediaPlayer/view/mediaPlayer.xml",document.getElementById("content"),k,window);l=new b.app.players.OnDemandPlayer(MediaPlayer,k.playbackBanner,k.videoFullScreen,k.loadingBar);l.initialise();o=new b.app.players.HLSPlayer(MediaPlayer,k.playbackBanner,k.videoFullScreen);o.initialise();a=new b.app.players.PvrPlayer(MediaPlayer,k.pvrPlaybackBanner,k.videoFullScreen,k.parentalLockIcon);a.initialise();n=new b.app.players.TimeShiftPlayer(MediaPlayer,k.timeShiftBanner,k.videoFullScreen);n.initialise();f=new b.app.players.AudioPlayer(MediaPlayer,k.audioBanner,k.videoFullScreen);f.initialise();c=new b.app.players.MusicPlayer(MediaPlayer,k.mediaPlaybackBanner,k.thumbnailImage,k.videoFullScreen);c.initialise();h=new b.app.players.VideoPlayerUSBDLNA(MediaPlayer,k.mediaPlaybackBanner,k.videoFullScreen,k.loadingBar);h.initialise();d=k.imageViewer;d.initialise();k.backLabelContainer.backLabel.setText(MediaPlayer.getString("pressBack"));k.backLabelContainer.backLabel.setSpanCssClass("green");k.backLabelContainer.backLabel.setSpanOnText(MediaPlayer.getString("pressBackHighlight"));b.apps.core.ContextManager.initialisationComplete(MediaPlayer);},showBackLabel:function(){k.backLabelContainer.show();},hideBackLabel:function(){k.backLabelContainer.hide();},activate:function(q){var p;g=q||g;g.context=g.context||MediaPlayer.toString();m=g.customKeyHandler;b.app.ClockDisplay.hide();b.app.MessageUtil.activateMessageIndicator(true);b.app.fullScreenPlayer.setBufferIcon(k.bufferingIcon);switch(g.type){case"ASSET":i=l;b.common.helper.FrontPanelManager.setFrontPanelDisplay(b.app.constants.FRONTPANEL_DISPLAY_MODES.VOD);break;case"CATCHUP":i=l;b.common.helper.FrontPanelManager.setFrontPanelDisplay(b.app.constants.FRONTPANEL_DISPLAY_MODES.CATCHUP_STARTOVER,q.contentObj.serviceId);break;case"STARTOVER":i=l;p=k.timeShiftBanner;b.common.helper.FrontPanelManager.setFrontPanelDisplay(b.app.constants.FRONTPANEL_DISPLAY_MODES.CATCHUP_STARTOVER,q.contentObj.serviceId);break;case"HLS":i=o;break;case"PVR":i=a;b.common.helper.FrontPanelManager.setFrontPanelDisplay(b.app.constants.FRONTPANEL_DISPLAY_MODES.PVR_PLAY_BACK);break;case"TIMESHIFT":i=n;break;case"AUDIO":i=f;break;case"PHOTO":i=d;p=k.imageBanner;break;case"MUSIC":i=c;break;case"VIDEO":i=h;break;default:i=j;}i.activate(g,p);},passivate:function(){j=i;b.app.fullScreenPlayer.setBufferIconToLive();b.app.MessageUtil.deactivateMessageIndicator();i.passivate();b.common.helper.FrontPanelManager.setFrontPanelDisplay(b.app.constants.FRONTPANEL_DISPLAY_MODES.DEFAULT);},unload:function(){b.apps.core.Language.unloadLanguageBundle("apps/mediaPlayer/common/");},focus:function(){b.app.MessageUtil.activateMessageIndicator(true);if(i.focus){i.focus();}},defocus:function(){b.app.MessageUtil.deactivateMessageIndicator();if(i.defocus){i.defocus();}},toString:function(){return"MEDIAPLAYER";},keyHandler:function(p){var q=b.apps.core.KeyInterceptor.getKeyMap(),r=false;if(m){r=m(p);}if(!r){return i.keyHandler(p);}return r;}};}(window.parent.$N));var $N=window.parent.$N;function PVRPlaybackBanner(b,a){$N.apps.core.Language.adornWithGetString(PVRPlaybackBanner,"apps/mediaPlayer/common/");PVRPlaybackBanner.superConstructor.call(this,b);this._log=new $N.apps.core.Log("MediaPlayer","PVRPlaybackBanner");this._AUDIO_SUBTITLE_CHANGE_TIMEOUT=3000;this.PROGRESS_WIDTH=593.5;this.BUTTON_UPDATE_TIMEOUT=1000;this.PVR_BANNER_TIMEOUT=null;this._playerBannerTimer=null;this._buttonGroup=new $N.gui.ButtonGroup(b,this._container);this.resetBannerTimeoutOnAudioSubtitleChange=function(){};this.callbackCycleAudioTrack=$N.app.fullScreenPlayer.tracks.cycleAudioTracks;this.callbacktoggleSubtitles=$N.app.TracksUtil.toggleSubtitles;this.audioSequenceFunction=null;this._tempSubtitleTrackCode=null;this.subtitleSequenceFunction=null;this.cycleAudio=null;this.isAudioSubtitleTogglingMode=null;this.toggleSubtitle=null;this.dictionary={};this.isBannerActive=false;this._audioChangeTimeout=null;this._buttonTimeout=null;this._buttonGroup.configure({x:1325,y:300});this._progress.configure({x:695,y:314,width:this.PROGRESS_WIDTH,progressOuterCssClass:"timeShiftProgressOuter",progressInnerCssClass:"timeShiftProgressInner",progressBarProperties:{x:0,y:2,height:15,width:this.PROGRESS_WIDTH},startLabelProperties:{x:0,y:50,cssClass:"timeShiftProgressStartLabel"},endLabelProperties:{x:this.PROGRESS_WIDTH,y:50,cssClass:"timeShiftProgressEndLabel"}});this._stopContainer.configure({x:220});this._replayContainer.configure({x:310});this._rewContainer.configure({x:400});this._playPauseContainer.configure({x:490});this._ffwContainer.configure({x:580});this.updateIcons=function(){var c=this;if(this._buttonTimeout){clearTimeout(this._buttonTimeout);this._buttonTimeout=null;}this._buttonTimeout=setTimeout(function(){c.setAudioStateIcon($N.app.TracksUtil.isAudioTrackSelectable());c.setSubtitleStateIcon($N.app.TracksUtil.isSubtitleTrackSelectable());},this.BUTTON_UPDATE_TIMEOUT);};this.updateAudioAndSubtitleButtons=function(){this.updateIcons();this.importLanguageBundle();this.audioSequenceFunction=this.setActiveAudioTitle;this.subtitleSequenceFunction=this.setSubtitleStatus;this.setAudioCycleFunction(this.callbackEmpty);this.setToggleSubtitlesFunction(this.callbackEmpty);this._buttonGroup.setAudioTrackLabel(this.dictionary.menuAudio);this._buttonGroup.setSubtitleLabel(this.dictionary.menuSubtitles);this._buttonGroup.setOptionsLabel(this.dictionary.options);this._buttonGroup.hideInfoAndOptionsIcons();this._buttonGroup.setSubtitleCssClass("miniguideButtonText");this._buttonGroup.setAudioCssClass("miniguideButtonText");this._buttonGroup.show();this._buttonGroup.showButtons();};this.exitPVRPlaybackBanner=function(){this.setAudioStateIcon(false);this.setSubtitleStateIcon(false);};this.activateAudioSubtitleOnKeyPress=function(){var c=this._buttonGroup.getAudioTrackText(),d=this._buttonGroup.getSubtitleText();if(this.isAudioSubtitleTogglingMode&&this.isVisible()){if(c!==(PVRPlaybackBanner.getString("menuAudio"))){this._buttonGroup.activateAudio();}if(d!==(PVRPlaybackBanner.getString("menuSubtitles"))){this._buttonGroup.activateSubtitle();}this.setAudioSubtitleTogglingMode(false);return true;}return false;};this.getAudioSubtitleTogglingMode=function(){return this.isAudioSubtitleTogglingMode;};this.getNextSubtitleText=function(e){var d=$N.app.TracksUtil.getSubtitleTrackList(),c,f;if(d.indexOf(e)>-1){c=d.indexOf(e);if(d[c+1]){f=d[c+1];this._tempSubtitleTrackCode=f;return this.dictionary.audioLanguage[f];}else{this._tempSubtitleTrackCode=this.dictionary.off;return this.dictionary.off;}}else{if(e===this.dictionary.off){f=d[0];this._tempSubtitleTrackCode=f;return this.dictionary.audioLanguage[f];}}};this.toggleSubtitleTitle=function(){var c=this._buttonGroup.getSubtitleText();if(c===this.dictionary.menuSubtitles){this.setSubtitleStatus();}else{this._buttonGroup.setSubtitleCssClass("miniguideButtonTextChange");this._buttonGroup.setSubtitleLabel(this.getNextSubtitleText(this._tempSubtitleTrackCode));this.resetSubtitleTimeout();}};this.setToggleSubtitleTitle=function(){var c=null;if(($N.app.TracksUtil.isSubtitleTrackSelectable())){c=$N.app.fullScreenPlayer.tracks.getActiveSubtitleTrack();this._buttonGroup.setSubtitleCssClass("miniguideButtonTextChange");this._buttonGroup.setSubtitleLabel((c&&c.language)?this.dictionary.audioLanguage[c.language]:this.dictionary.off);this.noSubtitleTracks=false;this._tempSubtitleTrackCode=(c&&c.language)?c.language:this.dictionary.off;}else{this._buttonGroup.setSubtitleLabel(this.dictionary.unavailable);this._buttonGroup.setSubtitleCssClass("miniguideNoOptionsText");this.noSubtitleTracks=true;this._tempSubtitleTrackCode=null;}};this.resetSubtitleTimeout=function(){var c=null;this.clearSubtitleTimeout();c=this;this._subtitleChangeTimeout=setTimeout(function(){c.activateSubtitle();if(c._buttonGroup.getAudioTrackText()===c.dictionary.menuAudio){c.setAudioSubtitleTogglingMode(false);}},this._AUDIO_SUBTITLE_CHANGE_TIMEOUT);};this.clearSubtitleTimeout=function(){if(this._subtitleChangeTimeout){clearTimeout(this._subtitleChangeTimeout);this._subtitleChangeTimeout=null;}};this._showCurrentAudioStateAndToggle=function(){this.showCurrentAudioStateAndToggle();};this.clearAudioTimeout=function(){if(this._audioChangeTimeout){clearTimeout(this._audioChangeTimeout);this._audioChangeTimeout=null;}};this.resetAudioTimeout=function(){var c=null;this.clearAudioTimeout();c=this;this._audioChangeTimeout=setTimeout(function(){c.activateAudio();if(c._buttonGroup.getSubtitleText()===c.dictionary.menuSubtitles){c.setAudioSubtitleTogglingMode(false);}},this._AUDIO_SUBTITLE_CHANGE_TIMEOUT);};this.activateAudio=function(){var c=null;$N.app.fullScreenPlayer.tracks.activateAudioTrackByLanguage(this._audiolanguage);this._buttonGroup.setAudioTrackLabel(this.dictionary.menuAudio);this._buttonGroup.setAudioCssClass("miniguideButtonText");c=this._buttonGroup.getSubtitleText();if(c===this.dictionary.menuSubtitles){this.resetBannerTimeoutOnAudioSubtitleChange();}this.clearAudioTimeout();};this.setActiveAudioTitle=function(){this.audioSequenceFunction=this.toggleAudioTrackText;this.setAudioLanguageTitle();this.resetAudioTimeout();this.setAudioSubtitleTogglingMode(true);};this.setAudioLanguageTitle=function(){var e=$N.app.fullScreenPlayer.tracks.getActiveAudioTrack(),f=$N.app.TracksUtil.isInvalidAudioTrackAvailable(),d=0,c=null;if(e){this._buttonGroup.setAudioTrackLabel(this.dictionary.audioLanguage[e.language]||this.dictionary.audioLanguage.por);c=$N.app.fullScreenPlayer.tracks.getAudioTracks();d=c.length;if((d===1)||f){this._buttonGroup.setAudioCssClass("miniguideNoOptionsText");}else{this._buttonGroup.setAudioCssClass("miniguideButtonTextChange");}}};this._rootSVGRef=this._container.getRootSVGRef();if(a){a.addChild(this);}}$N.gui.Util.extend(PVRPlaybackBanner,PlaybackBanner);function getBannerTimeOut(){var a=$N.platform.system.Preferences.get($N.app.constants.PREF_PLAYBACK_PLAYER_TIMEOUT)||$N.app.constants.SURFER_DURATION_DEFAULT;return parseInt(a,10);}PVRPlaybackBanner.prototype.setBannerTimeout=function(b){var a=this;if(b===undefined){b=true;}this.PVR_BANNER_TIMEOUT=getBannerTimeOut();if(this._playerBannerTimer){clearTimeout(this._playerBannerTimer);}if(this.PVR_BANNER_TIMEOUT>0&&b){this._playerBannerTimer=setTimeout(function(){a.hide();},this.PVR_BANNER_TIMEOUT);}};PVRPlaybackBanner.prototype.show=function(a){if(a===undefined){a=true;}this.updateAudioAndSubtitleButtons();this.setBannerTimeout(a);this.isBannerActive=true;PVRPlaybackBanner.superClass.show.call(this);};PVRPlaybackBanner.prototype.hide=function(a){if(this._playerBannerTimer||a){clearTimeout(this._playerBannerTimer);this._playerBannerTimer=null;this._buttonGroup.hide();this.isBannerActive=false;PVRPlaybackBanner.superClass.hide.call(this);}};PVRPlaybackBanner.prototype.setResetBannerTimeout=function(a){this.resetBannerTimeoutOnAudioSubtitleChange=a;};PVRPlaybackBanner.prototype.setAudioSubtitleTogglingMode=function(a){this.isAudioSubtitleTogglingMode=a;};PVRPlaybackBanner.prototype.importLanguageBundle=function(){this.dictionary.menuAudio=PVRPlaybackBanner.getString("menuAudio");this.dictionary.menuSubtitles=PVRPlaybackBanner.getString("menuSubtitles");this.dictionary.audioLanguage=PVRPlaybackBanner.getString("audioLanguage");this.dictionary.options=PVRPlaybackBanner.getString("options");this.dictionary.on=PVRPlaybackBanner.getString("on");this.dictionary.off=PVRPlaybackBanner.getString("off");this.dictionary.unavailable=PVRPlaybackBanner.getString("unavailable");};PVRPlaybackBanner.prototype.isBannerActive=function(){return this.isBannerActive;};PVRPlaybackBanner.prototype.setSubtitleStatus=function(){this.subtitleSequenceFunction=this.toggleSubtitleTitle;this.setToggleSubtitleTitle();this.resetSubtitleTimeout();this.setAudioSubtitleTogglingMode(true);};PVRPlaybackBanner.prototype.showCurrentSubtitleStateAndToggle=function(){if($N.app.TracksUtil.isSubtitleTrackSelectable()){this.toggleSubtitleTitle();}};PVRPlaybackBanner.prototype.setSubtitleStateIcon=function(b){var a=b?$N.app.constants.ACTIVE_SUBTITLE_BUTTON_PATH:$N.app.constants.INACTIVE_SUBTITLE_BUTTON_PATH;this._buttonGroup.setSubtitleIcon(a);};PVRPlaybackBanner.prototype.showCurrentAudioTrackAndToggle=function(){if(this.audioSequenceFunction&&$N.app.TracksUtil.isAudioTrackSelectable()){this.audioSequenceFunction();}};PVRPlaybackBanner.prototype.setToggleSubtitlesFunction=function(a){this.toggleSubtitle=a;};PVRPlaybackBanner.prototype.activateSubtitle=function(){var b=this._buttonGroup.getSubtitleText(),a=null;if(b!==this.dictionary.off){$N.app.fullScreenPlayer.tracks.activateSubtitleTrackByLanguage(this._tempSubtitleTrackCode);}else{$N.app.TracksUtil.deactivateCurrentSubtitleTrack();}this._buttonGroup.setSubtitleLabel(this.dictionary.menuSubtitles);this._buttonGroup.setSubtitleCssClass("miniguideButtonText");a=this._buttonGroup.getAudioTrackText();if(a===this.dictionary.menuAudio){this.resetBannerTimeoutOnAudioSubtitleChange();}this.clearSubtitleTimeout();};PVRPlaybackBanner.prototype.setAudioStateIcon=function(b){var a=b?$N.app.constants.ACTIVE_LANGUAGE_BUTTON_PATH:$N.app.constants.INACTIVE_LANGUAGE_BUTTON_PATH;this._buttonGroup.setAudioTrackIcon(a);};PVRPlaybackBanner.prototype.setAudioCycleFunction=function(a){this.cycleAudio=a;};PVRPlaybackBanner.prototype.setAudioStateIcon=function(b){var a=b?$N.app.constants.ACTIVE_LANGUAGE_BUTTON_PATH:$N.app.constants.INACTIVE_LANGUAGE_BUTTON_PATH;this._buttonGroup.setAudioTrackIcon(a);};PVRPlaybackBanner.prototype.toggleAudioTrackText=function(){var a=$N.app.fullScreenPlayer.tracks.getAudioTracks(),b=a.length,c,f=this._buttonGroup.getAudioTrackText(),e=$N.app.TracksUtil.isInvalidAudioTrackAvailable(),g,j,h=0,d;if(f===this.dictionary.menuAudio){this.setActiveAudioTitle();}else{for(c=0;c<b;c++){d=c+1;g=this.dictionary.audioLanguage[a[c].language]||a[c].language;if(!e&&g===f){if(a[d]&&a[d].language){j=this.dictionary.audioLanguage[a[d].language]||a[d].language;this._audiolanguage=a[d].language;}else{j=this.dictionary.audioLanguage[a[h].language]||a[h].language;this._audiolanguage=a[h].language;}this._buttonGroup.setAudioTrackLabel(j);break;}}}this.resetAudioTimeout();};PVRPlaybackBanner.prototype.toString=function(){return"PVRPlaybackBanner";};