var $N=window.parent.$N;$N.app.NowNavigation=(function(){var i=new $N.apps.core.Log("NOW","NowNavigation"),r=[],b=function(){},y,w,c=true,x,H={},p=function(){};function e(I){H=I;}function m(K){var I,J=$N.app.MDSUtil.CONTENT_TYPE.ASSETS;I=H[K];if(I){if(I.isClube){J=$N.app.MDSUtil.CONTENT_TYPE.CLUBE;}return{data:I,type:J};}return null;}function t(L,N,I,J,M){var K;if(M||L!==N.contentUID){K=m(L);$N.app.MDSUtil.getContent(L,I,b,K,J);}else{I({type:null,content:null});}}function G(K,J,I){c=!c;r.push(K.id);I(K,J);}function A(L,I,K){var J,M=r[r.length-1];c=!c;r.pop();J=r.length;I(M,r[J-1],r[J-2],L,K);}function C(J){var I=$N.app.MDSUtil.assetDataMapper.getRatingValue(J);return(I>=$N.app.ParentalControlUtil.PARENTAL_RATING_ADULT_VALUE);}function h(J){var I=$N.app.MDSUtil.assetDataMapper.getRatingValue(J);return(!$N.platform.ca.ParentalControl.isCurrentUserMaster()&&I>$N.app.SettingsAPI.getMoralityLevel());}function B(I){return(C(I)&&!$N.platform.ca.ParentalControl.isCurrentUserMaster());}function j(I,J){x.setAuthenticationSuccessCallback(function(){setTimeout(I,1);});x.setAuthenticationCancelCallback(J);x.customiseDialog({title:$N.app.MDSUtil.getString("enterPasswordToUnblockAsset"),description:""});x.showPinDialog("master",true);}function o(){if(c){return y;}else{return w;}}function n(){if(c){return w;}else{return y;}}function v(K,I,J){y=K;w=I;x=J;}function D(I){r=[null];c=true;t(null,y,I,false,true);}function s(J,I){if(B(J)||h(J)){j(function(){I(J);});}else{I(J);}}function q(J,I){$N.app.PVRUtil.checkResources($N.app.PVRUtil.VOD_PLAYBACK_CONFLICT,function(){I(J);});}function u(J,I){var K=J&&J.type&&(J.type===$N.app.constants.VOD_ASSET_TYPE.CATCHUP||J.type===$N.app.constants.VOD_ASSET_TYPE.STARTOVER),L=K?$N.app.ParentalControlUtil.isChannelOrProgramLocked(J):false;if(L){j(function(){q(J,I);});}else{q(J,I);}}function z(){var I=$N.app.MDSUtil.getString("assetNotFoundText"),K=$N.app.MDSUtil.getString("assetNotFoundTitle"),L=$N.app.errorCodes.NOW.MDS_ASSET_NOT_FOUND,J=[{name:$N.app.MDSUtil.getString("cancel")}];$N.app.DialogueHelper.showNowDialog(K,I,J,null,L,p);}function d(J,I){var K=function(M){var L=(M===0);t(r[r.length-1],o(),function(N){if(c){I(J,N);}else{t(r[r.length-2],y,function(O){I(J,N,O);},false);}},L?true:false,true);};$N.apps.util.EventManager.fire("mdsContentLoading",true);if(J.directToAsset){r=[];$N.services.sdp.VOD.getDetailedAssetByUid(J.target,I,z);}else{r=J.idPath.slice(0);if(r.length%2){c=true;}else{c=false;}$N.app.MDSUtil.getNodeAssetCount(r[r.length-1],K);}}function F(K,I){var J=K.children&&K.children.length>0?true:false;t(K.id,n(),function(L){I(K,L);},J);}function E(L,I,K){var J=L.children&&L.children.length>0?true:false;if(C(L)){j(function(){t(L.id,n(),function(M){G(L,M,I);},J);},K);}else{t(L.id,n(),function(M){G(L,M,I);},J);}}function a(I){t(r[r.length-2],n(),function(J){if(c){t(r[r.length-3],y,function(K){A(J,I,K);},true);}else{A(J,I);}},true);}function l(I){b=I;}function g(I){p=I;}function k(){return r.length;}function f(){return c;}return{setSupplementaryCategoryData:e,getFocusPane:o,getDefocusPane:n,initialise:v,reset:D,showFullAssetInfo:s,confirmPlaybackPermissions:u,jumpToContent:d,previewNext:F,navigateDeeper:E,navigateBack:a,setFailureCallback:l,setErrorDialogKeyHandler:g,getDepth:k,isMasterInFocus:f};}());var $N=window.parent.$N;(function(b){var a=function(d,c){this.parent=null;this.children=[];this._data=d;this.assetCount=0;if(c){this.parent=c;this.parent.children.push(this);}};b.gui.NowNode=a;}($N||{}));var $N=window.parent.$N;$N.app.NowPlayback=(function(){var g=new $N.apps.core.Log("NOW","NowPlayback"),e,k,j=function(){},b=function(){},c=$N.app.MDSUtil,l=$N.app.TraxisUtil;function m(s,v,r){var q,w,u,x,t;if(r){q=1;w=2;u=[{name:c.getString("resumeRecordingDialogueWatch"),action:q},{name:c.getString("resumeRecordingDialogueRestart"),action:w}];x=function(y){if(y&&(y.action===w||y.action===q)){if(y.action===w){v(true);}else{v();}}};t=new $N.apps.dialog.ConfirmationDialogue("startoverResumeOrStartOverDialog",c.assetDataMapper.getTitle(s),c.getString("resumeOrStartOverText"),u,x,null,null,"VERTICAL");t.customise({defaultButton:q});$N.app.DialogueHelper.displayDialogue(t,$N.app.constants.DLG_STARTOVER_RESUME_OR_STARTOVER);}else{u=[{name:c.getString("resumeOption"),action:v},{name:c.getString("startOverOption"),action:function(){v(true);}}];j(c.assetDataMapper.getTitle(s),c.getString("resumeOrStartOverText"),u);}}function d(r,q,s){var t;if(s){t={title:c.getString("subscribeTo")+c.assetDataMapper.getProductName(r)+"?",description:c.assetDataMapper.getPriceText(r,true)+". "+c.getString("purchaseConfirmation")};}else{t={title:c.getString("purchaseConfirmation"),description:""};}k.customiseDialog(t);k.setAuthenticationSuccessCallback(q);k.showPinDialog("purchase",true);}function p(q,r,s){e=q;k=r;j=s;}function n(u,s,v,q,r){var t={url:u,type:s.type||$N.app.constants.VOD_ASSET_TYPE.VOD,title:c.assetDataMapper.getTitle(s),promoUrl:c.assetDataMapper.getHref(s),isMusic:false,bookmark:v,skip:true,trickplay:true,contentObj:s,successCallback:function(){if($N.platform.system.Preferences.get($N.app.constants.PREF_SEND_DESCRIBE,true)!==true){$N.platform.system.Preferences.set($N.app.constants.PREF_SEND_DESCRIBE,true,true);}if(q){q();}},failureCallback:function(w){if($N.platform.system.Preferences.get($N.app.constants.PREF_SEND_DESCRIBE,true)!==true){$N.platform.system.Preferences.set($N.app.constants.PREF_SEND_DESCRIBE,true,true);}$N.app.ContextHelper.closeContext();if(!$N.app.Conflicts.isConflictError(w)){b();}},retryCallback:function(){$N.app.ContextHelper.openContext("MEDIAPLAYER",{activationContext:t});},playbackCompleteCallback:function(w){if(r){if(w>$N.app.constants.TEN_SECONDS){l.setBookmark(c.assetDataMapper.getFilename(s),w-$N.app.constants.TEN_SECONDS);}else{l.setBookmark(c.assetDataMapper.getFilename(s),0);}}},moreInfoCallback:function(){$N.app.ContextHelper.openContext("SYNOPSIS",{activationContext:{data:s,type:t.type===$N.app.constants.VOD_ASSET_TYPE.VOD?"vod":"epg",playing:true,showBackgroundGradient:false}});},playErrorCallback:function(w){g("playErrorCallback",JSON.stringify(w));b(w.contentErrorInfo.reason);}};e.confirmPlaybackPermissions(s,function(){$N.app.ContextHelper.openContext("MEDIAPLAYER",{activationContext:t});});}function a(t,x,q,y,v,r){var s=q,u=l.getPlaybackUrl(c.assetDataMapper.getFilename(t),x),w;if(y){s=function(){l.confirmPurchase(x,q,function(){b($N.app.errorCodes.NOW.CANNOT_COMPLETE_PURCHASE);});};}if(r===true){$N.platform.system.Preferences.set($N.app.constants.PREF_SEND_DESCRIBE,false,true);}if(v===true){n(u,t,0,s,true);}else{l.getBookmark(c.assetDataMapper.getFilename(t),function(z){w=function(A){if(A){z=0;}n(u,t,z,s,true);};if(z>0){m(t,w,r);}else{w(true);}});}}function h(s,q,t){var u,r=function(v){var y,z,x,w;if(v&&v.promotions&&v.promotions.length){x=v.promotions[0];if(x.technicals&&x.technicals.length){w=x.technicals[0];if(w.media&&w.media.AV_EncryptedTS){y=w.media.AV_EncryptedTS.fileName;}}}else{if(t){t();}}if(y){z=l.getPlaybackUrl(y);}if(z){n(z,s,0,q);}};u=c.assetDataMapper.getTrailerRef(s);c.getTrailerByTechnicalId(u,r,t);}function f(r,t,q,s){if(t){d(r,function(){l.purchaseProduct(t,function(u){if(s){l.confirmPurchase(u.entitlementid,q,function(){b($N.app.errorCodes.NOW.CANNOT_COMPLETE_PURCHASE);});}else{a(r,u.entitlementid,q,true);}},function(){b($N.app.errorCodes.NOW.CANNOT_START_PURCHASE);});},s);}else{b($N.app.errorCodes.NOW.CANNOT_START_PURCHASE);}}function i(s,t,q){var r;if(t){if(c.assetDataMapper.isAvailableToSubscribe(s)){r=[{name:c.getString("subscribe"),action:function(){f(s,t,q,true);}},{name:c.getString("cancel")}];j(c.getString("notSubscribed")+"'"+c.assetDataMapper.getProductName(s)+"'",c.assetDataMapper.getProductDescription(s),r,c.assetDataMapper.getPriceText(s,true));}else{r=[{name:c.getString("launchSubscriptionApp"),action:function(){return;}},{name:c.getString("cancel")}];j(c.getString("notSubscribed")+"'"+c.assetDataMapper.getProductName(s)+"'",c.assetDataMapper.getProductDescription(s)+"\n"+c.getString("externalSubscriptionMessage"),r);}}else{b($N.app.errorCodes.NOW.CANNOT_START_PURCHASE);}}function o(q){b=q;}return{initialise:p,playAsset:a,playTrailer:h,purchaseProduct:f,subscribeToProduct:i,setFailureCallback:o};}());var $N=window.parent.$N;(function(a){var b=function(d,c){b.superConstructor.call(this,d);a.apps.core.Language.importLanguageBundleForObject(b,null,"apps/now/common/","LanguageBundle.js",null,window);this._dataMapper={};this._data=null;this._container=new a.gui.Group(this._docRef);this._title=new a.gui.TextArea(this._docRef,this._container);this._subtitle=new a.gui.TextArea(this._docRef,this._container);this._price=new a.gui.SpanLabel(this._docRef,this._container);this._ratingIcon=new a.gui.Image(this._docRef,this._container);this._genres=new a.gui.Label(this._docRef,this._container);this._episodes=new a.gui.Label(this._docRef,this._container);this._synopsis=new a.gui.TextArea(this._docRef,this._container);this._actors=new a.gui.TextArea(this._docRef,this._container);this._directors=new a.gui.TextArea(this._docRef,this._container);this._flags=new a.gui.AudioVideoFlags(this._docRef,this._container);this._okIcon=new a.gui.Image(this._docRef,this._container);this._moreInfoLabel=new a.gui.Label(this._docRef,this._container);this._title.configure({width:537,maxHeight:99,cssClass:"nowAssetInfoTitle"});this._subtitle.configure({width:537,maxHeight:99,cssClass:"nowAssetInfoSubtitle"});this._price.configure({x:0,cssClass:"nowAssetInfoMisc",spanCssClass:"nowFullAssetInfoPrice"});this._ratingIcon.configure({x:0});this._genres.configure({x:52.5,cssClass:"nowAssetInfoSynopsis"});this._episodes.configure({x:0,cssClass:"nowAssetInfoMisc"});this._synopsis.configure({x:0,width:537,cssClass:"nowAssetInfoSynopsis"});this._actors.configure({x:0,width:537,cssClass:"nowAssetInfoSynopsis",maxHeight:84});this._directors.configure({x:0,width:537,cssClass:"nowAssetInfoSynopsis",maxHeight:42});this._flags.configure({x:0,y:546});this._okIcon.configure({x:0,y:646.5,href:"../../../customise/resources/images/%RES/icons/botao_ok_azul.png"});this._moreInfoLabel.configure({x:48,y:676.5,cssClass:"nowAssetInfoMoreLabel"});this._traxisProductUpdatedListenerId=a.apps.util.EventManager.subscribe("traxisProductsUpdated",this.traxisProductUpdatedListener,this);this._rootSVGRef=this._container.getRootSVGRef();if(c){c.addChild(this);}};a.gui.Util.extend(b,a.gui.GUIObject);b.prototype.traxisProductUpdatedListener=function(e){var d=e.data.productId,c,f;if(this._data&&(this._dataMapper.getProductId(this._data)===d)){c=this._dataMapper.getPriceText(this._data);f=c.indexOf(a.app.MDSUtil.getString("priceNow"));this._price.setVisible(false);this._price.setText(c);if(f>0){this._price.setSpanOnText(c.substring(f));}this._price.setVisible(true);}};b.prototype.setDataMapper=function(c){this._dataMapper=c;};b.prototype._repositionComponents=function(e){var d=(e)?0:60,c=this._title.getTrueHeight();if(this._subtitle.isVisible()){this._subtitle.setY(c+10);this._price.setY(c+this._subtitle.getTrueHeight()+5+d);}else{this._price.setY(c+d);}this._ratingIcon.setY(this._price.getTrueY()+33);this._genres.setY(this._ratingIcon.getTrueY()+30);if(this._episodes.isVisible()){this._episodes.setY(this._ratingIcon.getTrueY()+88.5);this._synopsis.setY(this._episodes.getTrueY()+36);}else{this._synopsis.setY(this._ratingIcon.getTrueY()+64.5);}this._directors.setY(533-this._directors.getTrueHeight()-9);this._actors.setY(this._directors.getTrueY()-this._actors.getTrueHeight()-9);this._synopsis.setMaxHeight(this._actors.getTrueY()-this._synopsis.getTrueY()-9);};b.prototype.update=function(g){var i,f=this._dataMapper.getActors(g),c=this._dataMapper.getDirectors(g),e=this._dataMapper.getProductId(g),h=false,d;if(e){a.app.TraxisUtil.updateProductDetails(e,g);}else{h=true;}this._data=g;this._title.setText(this._dataMapper.getTitle(g));d=a.app.StringUtil.join(" \u00A0",this._dataMapper.getSubtitle(g),this._dataMapper.getSeriesInfo(g));if(d){this._subtitle.setText(d);this._subtitle.show();}else{this._subtitle.hide();}this._price.setText(this._dataMapper.getPriceText(g));this._ratingIcon.setHref(this._dataMapper.getRatingIcon(g));this._genres.setText(this._dataMapper.getGenres(g));i=this._dataMapper.getEpisodes(g);if(i){this._episodes.show();this._episodes.setText(i);}else{this._episodes.hide();}this._synopsis.setText(this._dataMapper.getDescription(g));this._actors.setText(f||"");this._directors.setText(c?b.getString("director")+": "+c:"");this._flags.update(this._dataMapper.getFlags(g));this._moreInfoLabel.setText(b.getString("moreInformation"));this._repositionComponents(h);};a.gui.NowAssetInfo=b;}($N||{}));var $N=window.parent.$N;(function(b){var a=function(e,c){a.superConstructor.call(this,e);b.apps.core.Language.importLanguageBundleForObject(a,null,"apps/now/common/","LanguageBundle.js",null,window);this._itemSelectedCallback=function(){};this._container=new b.gui.Group(this._docRef);this._gallery=new b.gui.PageableMosaic(this._docRef,this._container);this._detailsGroup=new b.gui.Group(this._docRef,this._container);this._upArrow=new b.gui.SVGlink(this._docRef,this._detailsGroup);this._downArrow=new b.gui.SVGlink(this._docRef,this._detailsGroup);this._assetInfo=new b.gui.NowClubeInfo(this._docRef,this._detailsGroup);var d=this;this._container.configure({x:-193});this._gallery.configure({x:0,y:-62,width:457.5,height:630,columns:1,rows:3,itemTemplate:b.gui.NowClubeItem,dataMapper:b.app.MDSUtil.assetDataMapper,listPagedCallback:function(){d._upArrow.setVisible(!d._gallery.isAtFirstPage());d._downArrow.setVisible(!d._gallery.isAtLastPage());},itemHighlightedImmediateCallback:function(f){b.app.MDSUtil.clearRequest();d._assetInfo.update(f);},itemSelectedCallback:function(f){var g=b.app.MDSUtil.assetDataMapper.getTicketId(f);b.app.MDSUtil.clearRequest();if(g&&!b.app.MDSUtil.assetDataMapper.getEntitlementId(f)){b.app.NowPlayback.purchaseProduct(f,g,function(){b.app.TraxisUtil.updateProductDetails(b.app.MDSUtil.assetDataMapper.getProductId(f),f);},true);}else{d._itemSelectedCallback(f);}}});this._gallery.initialise();this._upArrow.configure({x:439.5,y:-54,href:"../../../customise/resources/svg/icons.svg#guideUpArrowIcon"});this._downArrow.configure({x:439.5,y:619.5,href:"../../../customise/resources/svg/icons.svg#guideDownArrowIcon"});this._assetInfo.configure({x:725,y:-10.5,dataMapper:b.app.MDSUtil.assetDataMapper});this._rootSVGRef=this._container.getRootSVGRef();if(c){c.addChild(this);}};b.gui.Util.extend(a,b.gui.GUIObject);a.prototype.selectRowByValidation=function(c){this._gallery.selectRowByValidation(c);};a.prototype.setItemSelectedCallback=function(c){this._itemSelectedCallback=c;};a.prototype.setData=function(c){this._gallery.setData(c);};a.prototype.getSelectedItem=function(){return this._gallery.getSelectedItem();};a.prototype.displayData=function(d,c){this._gallery.displayData(d,c);this._upArrow.setVisible(!this._gallery.isAtFirstPage());this._downArrow.setVisible(!this._gallery.isAtLastPage());};a.prototype.select=function(){this._gallery.select();};a.prototype.focus=function(){this._detailsGroup.show();this._gallery.focus();};a.prototype.defocus=function(){this._gallery.defocus();this._detailsGroup.hide();};a.prototype.keyHandler=function(c){var d=b.apps.core.KeyInterceptor.getKeyMap(),e=this._gallery.keyHandler(c);if(!e&&(c===d.KEY_RIGHT)){this._itemSelectedCallback(this.getSelectedItem());}return e;};b.gui.NowClube=a;}($N||{}));var $N=window.parent.$N;(function(a){var b=function(d,c){b.superConstructor.call(this,d);a.apps.core.Language.importLanguageBundleForObject(b,null,"apps/now/common/","LanguageBundle.js",null,window);this._data=null;this._dataMapper={};this._container=new a.gui.Group(this._docRef);this._title=new a.gui.Label(this._docRef,this._container);this._prompt=new a.gui.Label(this._docRef,this._container);this._synopsis=new a.gui.TextArea(this._docRef,this._container);this._labelContainer=new a.gui.Group(this._docRef,this._container);this._browseIcon=new a.gui.SVGlink(this._docRef,this._labelContainer);this._browseLabel=new a.gui.Label(this._docRef,this._labelContainer);this._okIcon=new a.gui.Image(this._docRef,this._labelContainer);this._subscribeLabel=new a.gui.Label(this._docRef,this._labelContainer);this._title.configure({x:0,y:43.5,width:620,cssClass:"nowAssetInfoTitle"});this._prompt.configure({x:0,y:109.5,cssClass:"nowAssetInfoMisc"});this._synopsis.configure({x:0,y:148.5,width:620,maxHeight:388.5,cssClass:"nowAssetInfoMisc"});this._labelContainer.configure({x:0,y:564});this._browseIcon.configure({x:9,href:"../../../customise/resources/svg/icons.svg#nowLearnMoreIcon"});this._browseLabel.configure({x:46.5,y:28.5,cssClass:"nowAssetInfoMoreLabel"});this._okIcon.configure({y:51,href:"../../../customise/resources/images/%RES/icons/botao_ok_azul.png",visible:false});this._subscribeLabel.configure({x:46.5,y:79.5,cssClass:"nowAssetInfoMoreLabel",visible:false});this._traxisProductUpdatedListenerId=a.apps.util.EventManager.subscribe("traxisProductsUpdated",this.traxisProductUpdatedListener,this);this._rootSVGRef=this._container.getRootSVGRef();if(c){c.addChild(this);}};a.gui.Util.extend(b,a.gui.GUIObject);b.prototype.traxisProductUpdatedListener=function(d){var c=d.data.productId;if(this._data&&(this._dataMapper.getProductId(this._data)===c)){this._okIcon.hide();this._subscribeLabel.hide();if(this._dataMapper.getEntitlementId(this._data)){this._prompt.setText(b.getString("currentlySubscribed"));}else{this._prompt.setText(this._dataMapper.getPriceText(this._data,true,true));this._okIcon.show();this._subscribeLabel.setText(b.getString("menuSubscribe").toLowerCase());this._subscribeLabel.show();}}};b.prototype.setDataMapper=function(c){this._dataMapper=c;};b.prototype.update=function(c){a.app.TraxisUtil.updateProductDetails(this._dataMapper.getProductId(c),c);this._data=c;this._title.setText(this._dataMapper.getTitle(c));this._okIcon.hide();this._subscribeLabel.hide();if(this._dataMapper.getEntitlementId(c)){this._prompt.setText(b.getString("currentlySubscribed"));}else{if(c.price){this._prompt.setText(this._dataMapper.getPriceText(c,true,true));this._okIcon.show();this._subscribeLabel.setText(b.getString("menuSubscribe").toLowerCase());this._subscribeLabel.show();}else{this._prompt.setText("");}}this._synopsis.setText(this._dataMapper.getDescription(c));this._browseLabel.setText(b.getString("browse"));this._labelContainer.setY(this._synopsis.getTrueY()+this._synopsis.getTrueHeight()+40.5);};a.gui.NowClubeInfo=b;}($N||{}));var $N=window.parent.$N;(function(b){var a=function(d,c){a.superConstructor.call(this,d);this.isFocused=true;this.isHighlighted=false;this._container=new b.gui.Group(d);this._image=new b.gui.FadingImage(this._docRef,this._container);this._highlight=new b.gui.Container(this._docRef,this._container);this._image.configure({width:456,height:186,imageConfig:{preserveAspect:true},underImageConfig:{visible:false}});this._highlight.configure({width:456,height:186,cssClass:"nowGalleryItemHighlight",rounding:1,visible:false});this._rootSVGRef=this._container.getRootSVGRef();if(c){c.addChild(this);}};b.gui.Util.extend(a,b.gui.AbstractMosaicTile);a.prototype.updateHighlight=function(){if(this.isHighlighted&&this.isFocused){this._highlight.show();}else{this._highlight.hide();}};a.prototype.highlight=function(){this.isHighlighted=true;this.updateHighlight();};a.prototype.unHighlight=function(){this.isHighlighted=false;this.updateHighlight();};a.prototype.focus=function(){this.isFocused=true;this.updateHighlight();};a.prototype.defocus=function(){this.isFocused=false;this.updateHighlight();};a.prototype.update=function(c){this._image.setHref(this._dataMapper.getHref(c));};b.gui.NowClubeItem=a;}($N||{}));var $N=window.parent.$N;(function(b){var a=function(d,c){a.superConstructor.call(this,d);this._callbackData=null;this.VERTICAL_CHAR_COUNT=20;this._useRealMessageHeight=true;this._dialogueBackground.setCssClass("nowDialogBackground");this._backplateUpperGlow.setCssClass("nowFullAssetUniformGradient");this._backplateLowerGlow.setCssClass("nowFullAssetUniformGradientInvert");this._dialogueBackplate.setCssClass("");this._solidLineTop=new b.gui.BackgroundBox(this._docRef,this._dialogueBackplate);this._solidLineBottom=new b.gui.BackgroundBox(this._docRef,this._dialogueBackplate);this._radialGradientTop=new b.gui.BackgroundBox(this._docRef,this._dialogueBackplate);this._radialGradientBottom=new b.gui.BackgroundBox(this._docRef,this._dialogueBackplate);this._barBackground=new b.gui.BackgroundBox(this._docRef,this._dialogueBackplate);this._solidLineTop.configure({x:0,y:-1.5,width:1920,height:4.5,cssClass:"loadingBarSolidDivider"});this._solidLineBottom.configure({x:0,y:601.5,width:1920,height:4.5,cssClass:"loadingBarSolidDivider"});this._radialGradientTop.configure({x:0,y:-150,width:1920,height:463.5,cssClass:"nowFullAssetRadialGradient"});this._radialGradientBottom.configure({x:0,y:258,width:1920,height:463.5,cssClass:"nowFullAssetRadialGradient"});this._barBackground.configure({x:0,y:3,width:1920,height:598.5,cssClass:"blackFill"});this._priceText=new b.gui.Label(d,this._container);this._priceText.configure({x:this.INDENTATION,cssClass:"nowFullAssetInfoPrice",visible:false});this._errorCode=new b.gui.Label(d,this._container);this._errorCode.configure({x:1920-this.INDENTATION,cssClass:"errorCode",visible:false});this._menu.getItemConfig().cssClass="nowDialogCellBackground";this._menu.getItemConfig().cssHighlightClass="nowDialogCellBackgroundHighlighted";};b.gui.Util.extend(a,b.gui.ConfirmationDialog);a.prototype.setPriceText=function(c){if(c){this._priceText.setText(c);this._priceText.show();}else{this._priceText.hide();}};a.prototype.setMessage=function(d){var c="";if(this._priceText.isVisible()){c="\n";}a.superClass.setMessage.call(this,c+d);this._priceText.setY(this._messageText.getTrueY()+28.5);};a.prototype.setButtonPressedCallback=function(d){var c=this;this._menu.setItemSelectedCallback(function(e){d(e,c._callbackData);});};a.prototype.setExitCallback=function(c){this._callback=c;};a.prototype.setCallbackData=function(c){this._callbackData=c;};a.prototype.setErrorCode=function(c){if(c){this._errorCode.setText(b.app.MDSUtil.getString("errorCode")+c);this._errorCode.show();}else{this._errorCode.hide();}};a.prototype.layoutDialogue=function(c){a.superClass.layoutDialogue.call(this,c);this._errorCode.setY(this._menu.getTrueY()+25.5);};b.gui.NowConfirmationDialog=a;}($N||{}));var $N=window.parent.$N;(function(b){var a=function(e,c){this._log=new b.apps.core.Log("NOW","NowDisclaimer");a.superConstructor.call(this,e);var d=this;b.apps.core.Language.importLanguageBundleForObject(a,null,"apps/now/common/","LanguageBundle.js",function(){d._resetText();},window);this.acceptCallback=function(){};this._container=new b.gui.Group(e);this._background=new b.gui.BackgroundBox(this._docRef,this._container);this._title=new b.gui.Label(this._docRef,this._container);this._okIcon=new b.gui.Image(this._docRef,this._container);this._okText=new b.gui.Label(this._docRef,this._container);this._exitIcon=new b.gui.Image(this._docRef,this._container);this._exitText=new b.gui.Label(this._docRef,this._container);this._text=new b.gui.TextArea(this._docRef,this._container);this._background.configure({width:1920,height:1080,cssClass:"blackFill"});this._title.configure({x:370.5,y:171,cssClass:"nowDisclaimerTitle"});this._okIcon.configure({x:382.5,y:963,href:"../../../customise/resources/images/%RES/icons/botao_ok_azul.png"});this._okText.configure({x:432,y:991.5,cssClass:"nowDisclaimerButtonText"});this._exitIcon.configure({x:685.5,y:963,href:"../../../customise/resources/images/%RES/icons/botao_misc_azul.png"});this._exitText.configure({x:735,y:991.5,cssClass:"nowDisclaimerButtonText"});this._text.configure({x:372,y:208.5,width:1176,cssClass:"nowDisclaimerText"});this._resetText();this._rootSVGRef=this._container.getRootSVGRef();if(c){c.addChild(this);}};b.gui.Util.extend(a,b.gui.GUIObject);a.prototype._resetText=function(){this._title.setText(a.getString("disclaimerTitle"));this._okText.setText(a.getString("disclaimerContinue"));this._exitText.setText(a.getString("textExit"));this._text.setText(a.getString("disclaimerText"));};a.prototype.setAcceptCallback=function(c){this.acceptCallback=c;};a.prototype.keyHandler=function(c){var d=b.apps.core.KeyInterceptor.getKeyMap(),e=false;switch(c){case d.KEY_OK:b.platform.system.Preferences.set(b.app.constants.PREF_NOW_DISCLAIMER_ACCEPTED,"true");this.acceptCallback();e=true;break;case d.KEY_LEFT:case d.KEY_RIGHT:e=true;break;}return e;};b.gui.NowDisclaimer=a;}($N||{}));var $N=window.parent.$N;(function(a){var b=function(d,c){b.superConstructor.call(this,d);a.apps.core.Language.importLanguageBundleForObject(b,null,"apps/now/common/","LanguageBundle.js",null,window);this._container=new a.gui.Group(this._docRef);this._message=new a.gui.TextArea(this._docRef,this._container);this._message.configure({x:120,y:100.5,width:990,height:300,cssClass:"nowMyContentItemText"});this._rootSVGRef=this._container.getRootSVGRef();if(c){c.addChild(this);}};a.gui.Util.extend(b,a.gui.GUIObject);b.prototype.setMessage=function(c){this._message.setText(c);};b.prototype.setData=function(c){};b.prototype.displayData=function(d,c){};b.prototype.focus=function(){};b.prototype.defocus=function(){};b.prototype.keyHandler=function(c){return false;};a.gui.NowEmptyPane=b;}($N||{}));var $N=window.parent.$N;(function(a){var b=function(d,c){b.superConstructor.call(this,d);a.apps.core.Language.importLanguageBundleForObject(b,null,"apps/now/common/","LanguageBundle.js",null,window);this._dataMapper=a.app.MDSUtil.assetDataMapper;this._data=null;this._serverFailureCallback=function(){};this._assetFailureCallback=function(){};this._exitCallback=function(){};this._favouriteSetOnEntry=false;this._container=new a.gui.Group(this._docRef);this._title=new a.gui.Label(this._docRef,this._container);this._subtitle=new a.gui.Label(this._docRef,this._container);this._expiryDate=new a.gui.Label(this._docRef,this._container);this._scrollingContent=new a.gui.ScrollingGroupWithFade(this._docRef,this._container);this._ratingIcon=new a.gui.Image(this._docRef,this._scrollingContent);this._miscInfo=new a.gui.Label(this._docRef,this._scrollingContent);this._price=new a.gui.Label(this._docRef,this._scrollingContent);this._rentalDuration=new a.gui.Label(this._docRef,this._scrollingContent);this._actors=new a.gui.Label(this._docRef,this._scrollingContent);this._director=new a.gui.Label(this._docRef,this._scrollingContent);this._synopsis=new a.gui.TextArea(this._docRef,this._scrollingContent);this._title.configure({x:103.5,y:261,width:1315.5,cssClass:"nowFullAssetInfoTitle"});this._subtitle.configure({x:103.5,y:309,width:1315.5,cssClass:"nowFullAssetInfoSubtitle"});this._expiryDate.configure({x:103.5,y:309,width:1315.5,cssClass:"nowFullAssetInfoExpiry"});this._scrollingContent.configure({x:103.5,y:303,width:1320,height:450,innerHeight:450,scrollSpeed:450,upArrowProperties:{y:-96}});this._ratingIcon.configure({x:4.5,y:0});this._miscInfo.configure({x:61.5,y:30,width:1254,cssClass:"nowFullAssetInfoMisc"});this._price.configure({x:0,y:103.5,cssClass:"nowFullAssetInfoPrice"});this._rentalDuration.configure({x:0,y:103.5,cssClass:"nowFullAssetInfoRentalDuration"});this._actors.configure({x:0,y:154.5,width:1315.5,cssClass:"nowFullAssetInfoActors"});this._director.configure({x:0,y:205.5,width:1315.5,cssClass:"nowFullAssetInfoActors"});this._synopsis.configure({x:0,y:238.5,width:1315.5,cssClass:"nowAssetInfoSynopsis"});this._image=new a.gui.FadingImage(this._docRef,this._container);this._flags=new a.gui.AudioVideoFlags(this._docRef,this._container);this._options=new a.gui.OptionsBar(this._docRef,this._container);this._backArrow=new a.gui.SVGlink(this._docRef,this._container);this._image.configure({x:1488,y:174,width:364.5,height:510,underImageConfig:{visible:false}});this._flags.configure({x:1488,y:703.5});this._options.configure({x:105,y:900,itemSelectedCallback:function(e){if(e.action){e.action();}}});this._options.initialise();this._backArrow.configure({x:64.5,y:477,href:"../../../customise/resources/svg/icons.svg#guideLeftArrowIcon"});this._divider=new a.gui.Layer(this._docRef,this._container);this._basicGradient=new a.gui.BackgroundBox(this._docRef,this._divider);this._solidLine=new a.gui.BackgroundBox(this._docRef,this._divider);this._radialGradient=new a.gui.BackgroundBox(this._docRef,this._divider);this._divider.configure({x:0,y:717,width:1920,height:120});this._basicGradient.configure({x:0,y:78,width:1920,height:39,cssClass:"nowFullAssetUniformGradient"});this._solidLine.configure({x:0,y:117,width:1920,height:3,cssClass:"nowFullAssetSolidDivider"});this._radialGradient.configure({x:96,y:0,width:1728,height:240,cssClass:"nowFullAssetRadialGradient"});a.apps.util.EventManager.subscribe("traxisProductsUpdated",this.traxisProductUpdatedListener,this);this._rootSVGRef=this._container.getRootSVGRef();if(c){c.addChild(this);}};a.gui.Util.extend(b,a.gui.GUIObject);b.prototype.traxisProductUpdatedListener=function(d){var c=d.data.productId;if(this._data&&(this._dataMapper.getProductId(this._data)===c)){this._price.setText(this._dataMapper.getPriceText(this._data));this._updateRentalText();this._updateExpiryText();this._redrawOptions(this._data);}};b.prototype._updateRentalText=function(){var d=21,f=this._dataMapper.getRentalExpiry(this._data),c="",g=a.app.MDSUtil,e=a.app.DateTimeUtil;if(!f){f=new Date();f.setDate(f.getDate()+2);}if(f&&f>Date.now()){c=g.getString("rentalTimePrefix")+e.getFormattedTimeString(f,a.app.constants.TWENTY_FOUR_HOUR_TIME_FORMAT);c+=g.getString("rentalDatePrefix")+e.getDayMonthStringFromDate(f);}this._rentalDuration.setX(this._price.getTrueX()+this._price.getTrueTextLength()+d);this._rentalDuration.setText(c);};b.prototype._updateExpiryText=function(){var c=this._dataMapper.getAssetExpiry(this._data),e="",f=a.app.MDSUtil,d=a.app.DateTimeUtil;if(c&&c>Date.now()){e=f.getString("myContentAssetExpiryTitle")+" "+d.getFormattedDateString(c);}this._expiryDate.setText(e);};b.prototype.hide=function(){if(this._favouriteSetOnEntry&&!a.app.TraxisUtil.favourites.isInFavourites(this._dataMapper.getFilename(this._data))){a.apps.util.EventManager.fire("nowFavouriteRemoved",this._data);}b.superClass.hide.call(this);};b.prototype.setDataMapper=function(c){this._dataMapper=c;};b.prototype.setServerFailureCallback=function(c){this._serverFailureCallback=c;};b.prototype.setAssetFailureCallback=function(c){this._assetFailureCallback=c;};b.prototype.setExitCallback=function(c){this._exitCallback=c;};b.prototype._repositionComponents=function(){var c=359;if(this._subtitle.isVisible()){this._expiryDate.configure({y:351});this._scrollingContent.configure({y:399,height:c,upArrowProperties:{y:-192}});}else{c=305;this._expiryDate.configure({y:307});this._scrollingContent.configure({y:355,height:c,upArrowProperties:{y:-148}});}if(this._actors.isVisible()){this._director.setY(this._actors.getTrueY()+51);}else{this._director.setY(this._actors.getTrueY());}if(this._director.isVisible()){this._synopsis.setY(this._director.getTrueY()+33);}else{if(this._actors.isVisible()){this._synopsis.setY(this._actors.getTrueY()+33);}else{this._synopsis.setY(this._price.getTrueY()+33);}}this._scrollingContent.setInnerHeight(Math.max(c+1.5,this._synopsis.getTrueY()+this._synopsis.getTrueHeight()));this._scrollingContent.resetScroll();};b.prototype._getOptionsData=function(e,i){var f=this,g=[],c=this._dataMapper.getTicketId(e),d=this._dataMapper.getEntitlementId(e),h=this._dataMapper.getFilename(e);if(c||d){if(d){g.push({title:b.getString("menuWatch"),url:"../../../customise/resources/images/%RES/icons/optionIcons/watch_icon.png",action:function(){a.app.NowPlayback.playAsset(e,d);}});}else{if(this._dataMapper.isSubscription(e)){g.push({title:b.getString("menuInfo"),url:"../../../customise/resources/images/%RES/icons/optionIcons/info_icon.png",action:function(){a.app.NowPlayback.subscribeToProduct(e,c,function(){a.app.TraxisUtil.updateProductDetails(f._dataMapper.getProductId(e),e);});}});}else{g.push({title:(f._dataMapper.getDefinition(e)==="HD")?b.getString("menuRentHD"):b.getString("menuRent"),url:"../../../customise/resources/images/%RES/icons/optionIcons/rent_icon.png",action:function(){a.app.NowPlayback.purchaseProduct(e,c,function(){a.app.TraxisUtil.updateProductDetails(f._dataMapper.getProductId(e),e);});}});}}if(this._dataMapper.getTrailerRef(e)){g.push({title:b.getString("menuTrailer"),url:"../../../customise/resources/images/%RES/icons/optionIcons/trailer_icon.png",action:function(){a.app.NowPlayback.playTrailer(e,null,function(){f._assetFailureCallback(a.app.errorCodes.NOW.MDS_DATA_FAILURE);});}});}if(a.app.TraxisUtil.favourites.isInFavourites(this._dataMapper.getFilename(this._data))===true){g.push({title:b.getString("menuRemoveFavourite"),url:"../../../customise/resources/images/%RES/icons/optionIcons/vod_remove_favorite.png",type:"smallerText",action:function(){a.app.TraxisUtil.favourites.removeFavouriteByFileName(h,function(j){f._redrawOptions(f._data);},function(j){});}});}else{g.push({title:b.getString("menuAddFavourite"),url:"../../../customise/resources/images/%RES/icons/optionIcons/vod_add_favorite.png",type:"smallerText",action:function(){a.app.TraxisUtil.favourites.addFavouriteByFileName(h,function(j){f._redrawOptions(f._data);},function(j){});}});}if(a.app.SocialActivityFactory.getSocialAccountObject(a.app.SocialAccount.FACEBOOK).isAccountAvailable()){g.push({title:b.getString("menuFacebookPost"),url:"../../../customise/resources/images/%RES/icons/optionIcons/fb_icon.png",action:function(){a.app.SocialActivityFactory.getSocialAccountObject(a.app.SocialAccount.FACEBOOK).showPostToSocialAccountDialog({title:f._title.getText()},"NOW");a.app.SocialActivityFactory.getSocialAccountObject(a.app.SocialAccount.FACEBOOK).setAccountRemovalListener(function(){f._redrawOptions(f._data);});}});}}g.push({title:b.getString("menuBack"),url:"../../../customise/resources/images/%RES/icons/optionIcons/back_icon.png",action:this._exitCallback});i(g);};b.prototype._updateOptions=function(e,d){var c=this._options.getSelectedItemIndex();this._options.setData(e);if(!d){this._options.selectItemAtIndex(c);}this._options.displayData();};b.prototype._redrawOptions=function(c,e){var d=this;this._getOptionsData(c,function(f){d._updateOptions(f,e);});};b.prototype.update=function(e){var h=this,d=this._dataMapper.getHref(e),f,g=this._dataMapper.getActors(e),c=this._dataMapper.getDirectors(e);a.app.TraxisUtil.updateProductDetails(this._dataMapper.getProductId(e),e,function(){if(h.isVisible()){h._serverFailureCallback(a.app.errorCodes.NOW.TRAXIS_DATA_FAILURE);}});this._favouriteSetOnEntry=a.app.TraxisUtil.favourites.isInFavourites(this._dataMapper.getFilename(e));this._data=e;this._image.setHref(d);this._flags.update(this._dataMapper.getFlags(e));this._title.setText(this._dataMapper.getTitle(e));f=a.app.StringUtil.join(" \u00A0",this._dataMapper.getSubtitle(e),this._dataMapper.getSeriesInfo(e));if(f){this._subtitle.setText(f);this._subtitle.show();}else{this._subtitle.hide();}this._ratingIcon.setHref(this._dataMapper.getRatingIcon(e));this._miscInfo.setText(a.app.StringUtil.join(" \u00A0",this._dataMapper.getGenres(e),this._dataMapper.getYear(e),this._dataMapper.getDuration(e),this._dataMapper.getCountries(e)));this._price.setText(this._dataMapper.getPriceText(e));this._updateRentalText();this._updateExpiryText();if(g){this._actors.show();this._actors.setText(g);}else{this._actors.hide();}if(c){this._director.show();this._director.setText(a.app.MDSUtil.getString("director")+": "+c);}else{this._director.hide();}this._synopsis.setText(this._dataMapper.getSynopsis(e));this._repositionComponents();this._redrawOptions(e,true);};b.prototype.keyHandler=function(c){var d=a.apps.core.KeyInterceptor.getKeyMap(),e=false;e=this._options.keyHandler(c);if(!e){e=this._scrollingContent.keyHandler(c);}if(!e){switch(c){case d.KEY_OK:case d.KEY_BACK:case d.KEY_LEFT:this._exitCallback();e=true;break;}}return e;};a.gui.NowFullAssetInfo=b;}($N||{}));var $N=window.parent.$N;(function(a){var b=function(e,c){b.superConstructor.call(this,e);a.apps.core.Language.importLanguageBundleForObject(b,null,"apps/now/common/","LanguageBundle.js",null,window);this._itemSelectedCallback=function(){};this._container=new a.gui.Group(this._docRef);this._gallery=new a.gui.PageableMosaic(this._docRef,this._container);this._detailsGroup=new a.gui.Group(this._docRef,this._container);this._upArrow=new a.gui.SVGlink(this._docRef,this._detailsGroup);this._downArrow=new a.gui.SVGlink(this._docRef,this._detailsGroup);this._selectionPosition=new a.gui.Label(this._docRef,this._detailsGroup);this._assetInfo=new a.gui.NowAssetInfo(this._docRef,this._container);var d=this;this._gallery.configure({y:-111,width:1140,height:621,columns:5,rows:2,hSpace:24,vSpace:25.5,itemTemplate:a.gui.NowGalleryItem,dataMapper:a.app.MDSUtil.assetDataMapper,listPagedCallback:function(){d._upArrow.setVisible(!d._gallery.isAtFirstPage());d._downArrow.setVisible(!d._gallery.isAtLastPage());},itemHighlightedImmediateCallback:function(f){a.app.MDSUtil.clearRequest();d._selectionPosition.setText(this.getSelectedItemIndex()+b.getString("xOfY")+this.getSize());d._assetInfo.update(f);},itemSelectedCallback:function(f){a.app.MDSUtil.clearRequest();d._itemSelectedCallback(f);}});this._gallery.initialise();this._upArrow.configure({x:573,y:-46.5,href:"../../../customise/resources/svg/icons.svg#guideUpArrowIcon"});this._downArrow.configure({x:573,y:609,href:"../../../customise/resources/svg/icons.svg#guideDownArrowIcon"});this._selectionPosition.configure({x:1147.5,y:631.5,cssClass:"nowGalleryPosition"});this._assetInfo.configure({x:1203,y:-48,dataMapper:a.app.MDSUtil.assetDataMapper});this._rootSVGRef=this._container.getRootSVGRef();if(c){c.addChild(this);}};a.gui.Util.extend(b,a.gui.GUIObject);b.prototype.selectRowByValidation=function(c){this._gallery.selectRowByValidation(c);};b.prototype.setItemSelectedCallback=function(c){this._itemSelectedCallback=c;};b.prototype.setData=function(c){this._gallery.setData(c);this._upArrow.hide();this._downArrow.setVisible(!this._gallery.isAtLastPage());};b.prototype.getSelectedItem=function(){return this._gallery.getSelectedItem();};b.prototype.displayData=function(d,c){this._gallery.displayData(d,c);};b.prototype.select=function(){this._gallery.select();};b.prototype.focus=function(){this._detailsGroup.show();this._assetInfo.show();this._gallery.focus();};b.prototype.defocus=function(){this._gallery.defocus();this._detailsGroup.hide();this._assetInfo.hide();};b.prototype.keyHandler=function(c){return this._gallery.keyHandler(c);};a.gui.NowGallery=b;}($N||{}));var $N=window.parent.$N;(function(a){var b=function(d,c){b.superConstructor.call(this,d);this.isFocused=true;this.isHighlighted=false;this._container=new a.gui.Group(d);this._image=new a.gui.FadingImage(this._docRef,this._container);this._highlight=new a.gui.Container(this._docRef,this._container);this._image.configure({width:204,height:285});this._highlight.configure({width:204,height:285,cssClass:"nowGalleryItemHighlight",rounding:1,visible:false});this._rootSVGRef=this._container.getRootSVGRef();if(c){c.addChild(this);}};a.gui.Util.extend(b,a.gui.AbstractMosaicTile);b.prototype.updateHighlight=function(){if(this.isHighlighted&&this.isFocused){this._highlight.show();}else{this._highlight.hide();}};b.prototype.highlight=function(){this.isHighlighted=true;this.updateHighlight();};b.prototype.unHighlight=function(){this.isHighlighted=false;this.updateHighlight();};b.prototype.focus=function(){this.isFocused=true;this.updateHighlight();};b.prototype.defocus=function(){this.isFocused=false;this.updateHighlight();};b.prototype.update=function(c){this._image.setHref(this._dataMapper.getHref(c));};a.gui.NowGalleryItem=b;}($N||{}));var $N=window.parent.$N;(function(a){var b=function(d,c){b.superConstructor.call(this,d);this._container=new a.gui.Group(this._docRef);this._table=new a.gui.DynamicTable(this._docRef,this._container);this._table.configure({x:0,y:13.5,width:1177.5,height:577.5,itemTemplate:a.gui.EventPromotionItem,dataMapper:a.app.DataMappers.getServiceDataMapper()});this._rootSVGRef=this._container.getRootSVGRef();if(c){c.addChild(this);}};a.gui.Util.extend(b,a.gui.GUIObject);b.prototype.setData=function(c){this._table.setData(c);};b.prototype.setItemConfig=function(c){this._table.setItemConfig(c);};b.prototype.initialise=function(){this._table.initialise();};b.prototype.focus=function(){this._table.activate();};b.prototype.defocus=function(){this._table.passivate();};b.prototype.keyHandler=function(c){return this._table.keyHandler(c);};a.gui.NowHighlights=b;}($N||{}));(function(b){var a=function(d,c){this._log=new b.apps.core.Log("CommonGUI","LoadingBar");a.superConstructor.call(this,d);this._loadingTimeout=b.app.LoadingTimeout(this);this._container=new b.gui.Group(d);this._background=new b.gui.BackgroundBox(this._docRef,this._container);this._text=new b.gui.TextArea(this._docRef,this._container);this._background.setRounding(12);this._container.configure({x:755,y:500,width:400,height:75});this._background.configure({x:0,y:0,width:400,height:75,cssClass:"nowLoadingBackground"});this._text.configure({x:0,y:15,width:400,height:40,cssClass:"nowLoadingText"});this._rootSVGRef=this._container.getRootSVGRef();if(c){c.addChild(this);}};b.gui.Util.extend(a,b.gui.GUIObject);a.prototype.setText=function(c){this._text.setText(c);};a.prototype.setTextX=function(c){this._text.setX(c);};a.prototype.setLoading=function(c){this._loadingTimeout.setLoading(c);};b.gui=b.gui||{};b.gui.NowLoading=a;}($N||{}));var $N=window.parent.$N;(function(b){var a=function(d,c){a.superConstructor.call(this,d);this.isMaster=true;this._title.setCssClass("nowMenuItem");};b.gui.Util.extend(a,b.gui.LongMenuItem);a.prototype.setWidth=function(c){this._width=c;this._title.setWidth(c);};a.prototype.setIsMaster=function(c){this.isMaster=c;};a.prototype.updateHighlight=function(){if(this.isHighlighted){if(this.isFocused){this._title.setCssClass("nowMenuItemHighlighted");this._title.setY(4.5);}else{if(this.isMaster){this._title.setCssClass("nowMenuItemDefocusHighlighted");this._title.setY(4.5);}else{this._title.setCssClass("nowMenuItem");this._title.setY(0);}}}else{this._title.setCssClass("nowMenuItem");this._title.setY(0);}};b.gui.NowMenuItem=a;}($N||{}));var $N=window.parent.$N;(function(b){var a=function(e,c){a.superConstructor.call(this,e);b.apps.core.Language.importLanguageBundleForObject(a,null,"apps/now/common/","LanguageBundle.js",null,window);this._data=[];this._itemSelectedCallback=function(){};this._favouriteRemovedSubscriptionId=null;this._contentType=null;this._container=new b.gui.Group(this._docRef);this._content=new b.gui.Group(this._docRef,this._container);this._list=new b.gui.PageableListWithArrows(this._docRef,this._content);this._rentalExpiryTitle=new b.gui.Label(this._docRef,this._content);this._assetExpiryTitle=new b.gui.Label(this._docRef,this._content);this._okIcon=new b.gui.Image(this._docRef,this._content);this._moreInfoLabel=new b.gui.Label(this._docRef,this._content);this._itemCount=new b.gui.Label(this._docRef,this._content);this._emptyMessageGroup=new b.gui.Group(this._docRef,this._container);this._emptyRentalsMessage=new b.gui.TextArea(this._docRef,this._emptyMessageGroup);this._emptyFavouritesMessage=new b.gui.TextArea(this._docRef,this._emptyMessageGroup);this._favouritesInfo=new b.gui.Group(this._docRef,this._content);this._ratingIcon=new b.gui.Image(this._docRef,this._favouritesInfo);this._image=new b.gui.FadingImage(this._docRef,this._favouritesInfo);this._flags=new b.gui.AudioVideoFlags(this._docRef,this._favouritesInfo);var d=this;this._list.configure({x:3,y:18,itemHeight:61.5,itemTemplate:b.gui.NowMyContentMenuItem,visibleItemCount:9,dataMapper:b.app.MDSUtil.assetDataMapper,itemHighlightedCallback:function(g){var f=b.app.MDSUtil.assetDataMapper.getHref(g);d._ratingIcon.setHref(b.app.MDSUtil.assetDataMapper.getRatingIcon(g));d._image.setHref(f);d._flags.update(b.app.MDSUtil.assetDataMapper.getFlags(g));},itemSelectedCallback:function(f){b.app.MDSUtil.clearRequest();d._itemSelectedCallback(f);},upArrowProperties:{x:1644,y:-37.5},downArrowProperties:{x:1644,y:558}});this._list.initialise();this._rentalExpiryTitle.configure({x:1374,y:0,cssClass:"nowAssetInfoSynopsis"});this._assetExpiryTitle.configure({x:942,y:0,cssClass:"nowAssetInfoSynopsis"});this._okIcon.configure({x:28.5,y:592.5,href:"../../../customise/resources/images/%RES/icons/botao_ok_azul.png"});this._moreInfoLabel.configure({x:76.5,y:622.5,cssClass:"nowAssetInfoMoreLabel"});this._itemCount.configure({x:1374,y:622.5,cssClass:"nowAssetInfoMoreLabel"});this._emptyRentalsMessage.configure({x:120,y:100.5,width:990,height:300,cssClass:"nowMyContentItemText",visible:false});this._emptyFavouritesMessage.configure({x:120,y:100.5,width:990,height:300,cssClass:"nowMyContentItemText",visible:false});this._ratingIcon.configure({x:1708.5,y:-30});this._image.configure({x:1380,y:18,width:364.5,height:510,underImageConfig:{href:"../../../customise/resources/images/%RES/thumbnails/Icn_showCardTitle_large.png"}});this._flags.configure({x:1380,y:547.5});this._rootSVGRef=this._container.getRootSVGRef();if(c){c.addChild(this);}};b.gui.Util.extend(a,b.gui.GUIObject);a.prototype.setRentalExpiryText=function(c){this._rentalExpiryTitle.setText(c);};a.prototype.setAssetExpiryText=function(c){this._assetExpiryTitle.setText(c);};a.prototype.setEmptyRentalsText=function(c){this._emptyRentalsMessage.setText(c);};a.prototype.setEmptyFavouritesText=function(c){this._emptyFavouritesMessage.setText(c);};a.prototype.setMoreInfoText=function(c){this._moreInfoLabel.setText(c);};a.prototype._toggleInfoPane=function(c){if(c){this._rentalExpiryTitle.hide();this._list.configure({upArrowProperties:{x:1212},downArrowProperties:{x:1212}});this._itemCount.setX(942);this._list.doForAllItems(function(d){d.setWidth(1296);});this._favouritesInfo.show();this._assetExpiryTitle.show();}else{this._assetExpiryTitle.hide();this._favouritesInfo.hide();this._list.configure({upArrowProperties:{x:1644},downArrowProperties:{x:1644}});this._itemCount.setX(1374);this._list.doForAllItems(function(d){d.setWidth(1728);});this._rentalExpiryTitle.show();}};a.prototype.setData=function(c){this._contentType=c.dataType;this._data=c.assets;this._list.setData(this._data);if(this._contentType==="favourites"){this._toggleInfoPane(false);this._rentalExpiryTitle.hide();this._itemCount.setText(this._data.length+" "+a.getString("textFavourites"));this._emptyRentalsMessage.hide();this._emptyFavouritesMessage.show();}else{this._toggleInfoPane(false);this._itemCount.setText(this._data.length+" "+a.getString("textRentals"));this._emptyFavouritesMessage.hide();this._emptyRentalsMessage.show();}this._moreInfoLabel.show();};a.prototype.displayData=function(d,c){if(this._list.isEmpty()){this._content.hide();this._emptyMessageGroup.show();}else{this._emptyMessageGroup.hide();this._list.displayData(d,c);this._content.show();}};a.prototype.setItemSelectedCallback=function(c){this._itemSelectedCallback=c;};a.prototype._favouriteRemovedListener=function(f){var h=this._list.getData(),c=b.app.MDSUtil.assetDataMapper.getProductId,g=(this._contentType==="favourites")?"textFavourites":"textRentals",d="",e=[];e=h.filter(function(i){return(c(i)!==c(f.data));});this._list.setData(e);this.displayData();d=(e.length)?e.length+" "+a.getString(g):"";this._itemCount.setText(d);};a.prototype.focus=function(){var c=this;this._list.focus();if(this._favouriteRemovedSubscriptionId){b.apps.util.EventManager.unSubscribe(this._favouriteRemovedSubscriptionId);}this._favouriteRemovedSubscriptionId=b.apps.util.EventManager.subscribe("nowFavouriteRemoved",this._favouriteRemovedListener,this);b.platform.ca.ParentalControl.setUserChangedCallback(function(){c._list.setData(c._data);c._list.displayData();});};a.prototype.defocus=function(){this._list.defocus();if(this._favouriteRemovedSubscriptionId){b.apps.util.EventManager.unSubscribe(this._favouriteRemovedSubscriptionId);this._favouriteRemovedSubscriptionId=null;}b.platform.ca.ParentalControl.setUserChangedCallback(function(){});};a.prototype.keyHandler=function(c){if(!this._list.isEmpty()){return this._list.keyHandler(c);}return false;};b.gui.NowMyContent=a;}($N||{}));var $N=window.parent.$N;(function(a){var b=function(d,c){b.superConstructor.call(this,d);this.isFocused=true;this.isHighlighted=false;this._container=new a.gui.Group(this._docRef);this._background=new a.gui.Container(this._docRef,this._container);this._highlight=new a.gui.Container(this._docRef,this._container);this._title=new a.gui.SpanLabel(this._docRef,this._container);this._expiry=new a.gui.Label(this._docRef,this._container);this._width=1728;this._EXPIRY_BUFFER=429;this._EXPIRY_WIDTH=355.5;this._background.configure({width:this._width,height:50,cssClass:"nowMyContentItemBackground"});this._highlight.configure({width:this._width,height:50,cssClass:"nowMyContentItemHighlight",rounding:1,visible:false});this._title.configure({x:24,y:37.5,width:this._width-this._EXPIRY_BUFFER,cssClass:"nowMyContentItemText",spanCssClass:"nowMyContentSeriesText"});this._expiry.configure({x:this._width-this._EXPIRY_WIDTH,y:37.5,width:331.5,cssClass:"nowMyContentItemText"});this._rootSVGRef=this._container.getRootSVGRef();if(c){c.addChild(this);}};a.gui.Util.extend(b,a.gui.AbstractListItem);b.prototype.setWidth=function(c){this._background.setWidth(c);this._highlight.setWidth(c);this._title.setWidth(c-this._EXPIRY_BUFFER);this._expiry.setX(c-this._EXPIRY_WIDTH);this._width=c;};b.prototype.updateHighlight=function(){if(this.isHighlighted&&this.isFocused){this._highlight.show();}else{this._highlight.hide();}};b.prototype.highlight=function(){this.isHighlighted=true;this.updateHighlight();};b.prototype.unHighlight=function(){this.isHighlighted=false;this.updateHighlight();};b.prototype.focus=function(){this.isFocused=true;this.updateHighlight();};b.prototype.defocus=function(){this.isFocused=false;this.updateHighlight();};b.prototype.update=function(g){var f,d,c,e="";if(g){this.unHighlight();f=a.app.StringUtil.join(" \u00A0",this._dataMapper.getSubtitle(g),this._dataMapper.getSeriesInfo(g));this._title.setText(a.app.StringUtil.join(" ",this._dataMapper.getFilteredTitle(g),f));this._title.setSpanOnText(f);d=this._dataMapper.getRentalExpiry(g);if(d){c=d-Date.now();if(c<=a.app.constants.DAY_IN_MS*180){e=a.app.DateTimeUtil.getWeekdayDayMonthTimeStringFromDate(d);}else{e="-";}}this._expiry.setText(e);}};a.gui.NowMyContentMenuItem=b;}($N||{}));var $N=window.parent.$N;(function(b){var a=function(e,c){a.superConstructor.call(this,e);b.apps.core.Language.importLanguageBundleForObject(a,null,"apps/now/common/","LanguageBundle.js",null,window);this._data=[];this._itemSelectedCallback=function(){};this._container=new b.gui.Group(this._docRef);this._content=new b.gui.Group(this._docRef,this._container);this._list=new b.gui.PageableListWithArrows(this._docRef,this._content);this._okIcon=new b.gui.Image(this._docRef,this._content);this._subscriptionMoreInfoLabel=new b.gui.Label(this._docRef,this._content);this._itemCount=new b.gui.Label(this._docRef,this._content);this._emptyMessageGroup=new b.gui.Group(this._docRef,this._container);this._emptyRentalsMessage=new b.gui.TextArea(this._docRef,this._emptyMessageGroup);var d=this;this._list.configure({x:3,y:18,itemHeight:61.5,itemTemplate:b.gui.NowMySubscriptionsMenuItem,visibleItemCount:9,dataMapper:b.app.MDSUtil.productDataMapper,itemHighlightedCallback:function(f){},itemSelectedCallback:function(f){b.app.MDSUtil.clearRequest();d._itemSelectedCallback(f);},upArrowProperties:{x:1644,y:-37.5},downArrowProperties:{x:1644,y:558}});this._list.initialise();this._okIcon.configure({x:28.5,y:592.5,href:"../../../customise/resources/images/%RES/icons/botao_ok_azul.png"});this._subscriptionMoreInfoLabel.configure({x:76.5,y:622.5,cssClass:"nowAssetInfoMoreLabel",visible:false});this._itemCount.configure({x:1374,y:622.5,cssClass:"nowAssetInfoMoreLabel"});this._emptyRentalsMessage.configure({x:120,y:100.5,width:990,height:300,cssClass:"nowMySubscriptionsItemText",visible:true});this._rootSVGRef=this._container.getRootSVGRef();if(c){c.addChild(this);}};b.gui.Util.extend(a,b.gui.GUIObject);a.prototype.setEmptyRentalsText=function(c){this._emptyRentalsMessage.setText(c);};a.prototype.setSubscriptionMoreInfoText=function(c){this._subscriptionMoreInfoLabel.setText(c);};a.prototype.setData=function(c){var d=c.dataType;this._data=c.assets;this._list.setData(this._data);this._subscriptionMoreInfoLabel.hide();this._okIcon.hide();this._itemCount.setText(this._data.length+" "+a.getString("textSubscriptions"));};a.prototype.displayData=function(d,c){if(this._list.isEmpty()){this._content.hide();this._emptyMessageGroup.show();}else{this._emptyMessageGroup.hide();this._list.displayData(d,c);this._content.show();}};a.prototype.setItemSelectedCallback=function(c){this._itemSelectedCallback=c;};a.prototype.focus=function(){var c=this;this._list.focus();b.platform.ca.ParentalControl.setUserChangedCallback(function(){c._list.setData(c._data);c._list.displayData();});};a.prototype.defocus=function(){this._list.defocus();b.platform.ca.ParentalControl.setUserChangedCallback(function(){});};a.prototype.keyHandler=function(c){if(!this._list.isEmpty()){return this._list.keyHandler(c);}return false;};b.gui.NowMySubscriptions=a;}($N||{}));var $N=window.parent.$N;(function(a){var b=function(d,c){b.superConstructor.call(this,d);this.isFocused=true;this.isHighlighted=false;this._container=new a.gui.Group(this._docRef);this._background=new a.gui.Container(this._docRef,this._container);this._highlight=new a.gui.Container(this._docRef,this._container);this._title=new a.gui.SpanLabel(this._docRef,this._container);this._expiry=new a.gui.Label(this._docRef,this._container);this._width=1728;this._EXPIRY_BUFFER=429;this._EXPIRY_WIDTH=355.5;this._background.configure({width:this._width,height:50,cssClass:"nowMySubscriptionsItemBackground"});this._highlight.configure({width:this._width,height:50,cssClass:"nowMySubscriptionsItemHighlight",rounding:1,visible:false});this._title.configure({x:24,y:37.5,width:this._width-this._EXPIRY_BUFFER,cssClass:"nowMySubscriptionsItemText",spanCssClass:"nowMySubscriptionsSeriesText"});this._expiry.configure({x:this._width-this._EXPIRY_WIDTH,y:37.5,width:331.5,cssClass:"nowMySubscriptionsItemText"});this._rootSVGRef=this._container.getRootSVGRef();if(c){c.addChild(this);}};a.gui.Util.extend(b,a.gui.AbstractListItem);b.prototype.setWidth=function(c){this._background.setWidth(c);this._highlight.setWidth(c);this._title.setWidth(c-this._EXPIRY_BUFFER);this._expiry.setX(c-this._EXPIRY_WIDTH);this._width=c;};b.prototype.updateHighlight=function(){if(this.isHighlighted&&this.isFocused){this._highlight.show();}else{this._highlight.hide();}};b.prototype.highlight=function(){this.isHighlighted=true;this.updateHighlight();};b.prototype.unHighlight=function(){this.isHighlighted=false;this.updateHighlight();};b.prototype.focus=function(){this.isFocused=true;this.updateHighlight();};b.prototype.defocus=function(){this.isFocused=false;this.updateHighlight();};b.prototype.update=function(d){var c="";if(d){this.unHighlight();this._title.setText(this._dataMapper.getTitle(d));this._expiry.setText(c);}};a.gui.NowMySubscriptionsMenuItem=b;}($N||{}));var $N=window.parent.$N;(function(a){var b=function(d,c){this._log=new a.apps.core.Log("NOW","NowPane");b.superConstructor.call(this,d);this._container=new a.gui.Group(d);this._type=null;this._component=null;this.contentUID=-1;this._focusState=true;this._rootSVGRef=this._container.getRootSVGRef();if(c){c.addChild(this);}};a.gui.Util.extend(b,a.gui.GUIObject);b.prototype._updateComponent=function(d,c){if(c&&this._component!==c){if(this._component){this._component.removeFromParent();}this.addChild(c);this._type=d;this._component=c;}};b.prototype._selectItemByChildUID=function(c){if(this._component.selectRowByValidation){this._component.selectRowByValidation(function(d){return(d.id===c);});}};b.prototype._updateData=function(d,e,c){if(d){this.contentUID=e;this._component.setData(d);}this._selectItemByChildUID(c);if(this._focusState){this._component.focus();}else{this._component.defocus();}if(this._component.displayData){this._component.displayData(!this._focusState,!this._focusState);}};b.prototype.update=function(d,c,f,g,e){this._updateComponent(d,c);this._updateData(f,g,e);};b.prototype.getType=function(){return this._type;};b.prototype.select=function(){if(this._component&&this._component.select){this._component.select();}};b.prototype.focus=function(){if(this._component&&this._component.focus){this._component.focus();}this._focusState=true;};b.prototype.defocus=function(){if(this._component&&this._component.defocus){this._component.defocus();}this._focusState=false;};b.prototype.keyHandler=function(c){var d=false;if(this._component&&this._component.keyHandler){d=this._component.keyHandler(c);}return d;};a.gui.NowPane=b;}($N||{}));var $N=window.parent.$N;(function(a){var b=function(f,d){b.superConstructor.call(this,f);this._dialogBackground.setCssClass("nowDialogBackground");this._backplateUpperGlow.setCssClass("nowFullAssetUniformGradient");this._backplateLowerGlow.setCssClass("nowFullAssetUniformGradientInvert");this._dialogueBackplate.setCssClass("");this._solidLineTop=new a.gui.BackgroundBox(this._docRef,this._dialogueBackplate);this._solidLineBottom=new a.gui.BackgroundBox(this._docRef,this._dialogueBackplate);this._radialGradientTop=new a.gui.BackgroundBox(this._docRef,this._dialogueBackplate);this._radialGradientBottom=new a.gui.BackgroundBox(this._docRef,this._dialogueBackplate);this._barBackground=new a.gui.BackgroundBox(this._docRef,this._dialogueBackplate);this._solidLineTop.configure({x:0,y:-1.5,width:1920,height:4.5,cssClass:"loadingBarSolidDivider"});this._solidLineBottom.configure({x:0,y:601.5,width:1920,height:4.5,cssClass:"loadingBarSolidDivider"});this._radialGradientTop.configure({x:0,y:-150,width:1920,height:463.5,cssClass:"nowFullAssetRadialGradient"});this._radialGradientBottom.configure({x:0,y:258,width:1920,height:463.5,cssClass:"nowFullAssetRadialGradient"});this._barBackground.configure({x:0,y:3,width:1920,height:598.5,cssClass:"blackFill"});this._eventImage.configure({x:1430,y:510,id:"pineventimg",visible:true,href:"customise/resources/images/%RES/icons/DVR_controle_parental.png"});var c,e=this._pinBoxArray.length;for(c=0;c<e;c++){this._pinBoxArray[c].setCssClass("nowDialogCellBackground");}};a.gui.Util.extend(b,a.gui.PinDialog);b.prototype.setTitle=function(c){this._title.setText(c);};b.prototype.setDescription=function(c){if(this._title.getText()===""){this.setTitle(c);this._description.setText("");}else{this._description.setText(c);}};b.prototype.setParentalIconVisible=function(c){this._eventImage.setVisible(c);};a.gui.NowPinDialog=b;}($N||{}));var $N=window.parent.$N||{};$N.app.NowNodeUtil=(function(){var h=new $N.apps.core.Log("NOW","NowNodeUtil"),c,j={},n={},p=[],b=[],q,r,e,k={title:"root",children:[]},f={MaxDepth:0,LeafCount:0,NodeCount:0,MaxChildren:0,MaxChildrenId:null,NodesDeleted:0,EmptyNodeCount:0},o=(function(){var t=[],s,v;function w(){var y,z,x=function(B){if(B===0){f.EmptyNodeCount++;}y.assetCount=B;s=setTimeout(w,1);},A=function(B){$N.app.MDSUtil.getNodeAssetCount(z,x,A);};if(t.length>0){y=t.pop();if(y){if(y.children.length>0){z=y._data.descendants;$N.app.MDSUtil.getNodeAssetCount(z,x,A);}else{z=y._data.id;$N.app.MDSUtil.getNodeAssetCount(z,x,A);}}}else{v();}}function u(x,y){t=x;v=y;s=setTimeout(w,1);}return{setWorkQueue:u};}());function a(u,w){var t,s=u.children,v=s.length,x;w++;if(w>f.MaxDepth){f.MaxDepth=w;}if(v===0){f.LeafCount++;}else{if(v>f.MaxChildren){f.MaxChildren=v;f.MaxChildrenId=u._data.id;}}f.NodeCount++;for(t=0;t<v;t++){x=s[t];a(x,w);}}function i(u){var t,s=u.children,w=s.length,x,v=u.assetCount;for(t=0;t<w;t++){x=s[t];if(x.children.length>0){v+=i(x);}else{v+=x.assetCount;}}u.assetCount=v;return v;}function l(u){var t,s=u.children,v=s.length,w;for(t=0;t<v;t++){w=s[t];if(w.assetCount===0){b.push(w);n[w._data.id]=true;}else{l(w);}}}function m(s,t){t=t||"";t=s._data.title+"/"+t;if(s.parent){return m(s.parent,t);}else{return t;}}function g(w,s){var v,u=w.children,x=u.length,y,t;s=s||k;t={id:w._data.id,title:w._data.title,children:[],path:m(w)};s.children.push(t);for(v=0;v<x;v++){y=u[v];g(y,t);}}function d(){$N.app.DebugUtil.cyan(">>>> getNodes!");var u=function(){a(c,0);i(c);l(c);},t=function(){o.setWorkQueue(p,u);},s=function(){q(t);};c=new $N.gui.NowNode({id:"root"});r(s);}r=function(s){var u=function(v){$N.app.DebugUtil.red("FAILED :( - Reason"+v);},t=function(z){var v=z.nodes,A=v.length,w,y,x;for(x=0;x<A;x++){w=v[x];y=new $N.gui.NowNode(w,c);}s();};$N.app.MDSUtil.getNodes(true,t,u);};q=function(s){var u=function(v){$N.app.DebugUtil.red("FAILED :( - Reason"+v);},t=function(z){var w=z.nodes,A=w.length,v=c.children,y=v.length,x;j={};p=[];for(x=0;x<A;x++){j[w[x].id]=w[x];}for(x=0;x<y;x++){e(v[x]);}s();};$N.app.MDSUtil.getNodes(false,t,u);};e=function(s){var v=s._data.children,y=v.length,w,u,x,t;for(t=0;t<y;t++){w=j[v[t]];x=w.descendants.length;u=new $N.gui.NowNode(w,s);if(u._data.children.length){e(u);}else{p.push(u);}}};return{getNodes:d};}());var Now=(function(G){var i=new G.apps.core.Log("NOW","Now"),c={},A,N,I,r,ao,t,k,ai,S,M,u,p,aq,Y,ad,x,n,V,aj,b,E,O={NAVIGATION:1,FULL_ASSET_INFO:2,DISCLAIMER:3},C=O.NAVIGATION,ag,U,ac=null,J=690,af=103.5;function m(ay,at){var aw,ax=ay.length,au,av;for(aw=0;aw<ax;aw++){au=ay[aw];av=at[au.title];if(av){au.image=av.image;au.Synopsis=av.synopsis;if(av.productId){au.technicals=[{products:[{id:av.productId}]}];}}}if(ax){return true;}return false;}function z(){b.configure({rentalExpiryText:Now.getString("myContentRentalExpiryTitle"),assetExpiryText:Now.getString("myContentAssetExpiryTitle"),emptyRentalsText:Now.getString("myContentRentalsEmpty"),emptyFavouritesText:Now.getString("myContentFavouritesEmpty"),moreInfoText:Now.getString("moreInformation")});n.setMessage(Now.getString("emptyMessage"));}function an(){E.configure({emptyRentalsText:Now.getString("myContentRentalsEmpty"),subscriptionMoreInfoText:Now.getString("subscriptionGallery")});}function a(){if(A.isMasterInFocus()){S.defocus();ai.focus();}else{ai.defocus();S.focus();S.show();}}function ap(aA,aw,ay,ax){var av=aw.type,az=null,au=G.app.MDSUtil.CONTENT_TYPE,at;switch(av){case au.CATALOGUES:if(aA===ai){az=aq;}else{az=Y;}break;case au.ASSETS:if(aw.isAugmented){at=U;}else{at=ag;}if(aA===ai){az=ad;ad.setItemSelectedCallback(at);}else{az=x;x.setItemSelectedCallback(at);}break;case au.CLUBE:az=V;break;case au.HIGHLIGHTS:az=aj;break;case au.MYCONTENT:az=b;break;case au.MYSUBSCRIPTIONS:az=E;break;case au.EMPTY:az=n;break;}aA.update(av,az,aw.content,ay,ax);}function T(){ai.hide();M.hide();S.setX(af);u.show();}function D(){if(A.getDepth()<=2){u.hide();}S.setX(J);M.show();ai.show();}function X(at){c.navigationGroup.hide();p.show();p.update(at);C=O.FULL_ASSET_INFO;G.apps.util.EventManager.fire("mdsContentLoading",false);}function f(at){A.showFullAssetInfo(at,X);}function L(){p.hide();c.navigationGroup.show();C=O.NAVIGATION;}function h(at){var au=function(){r.hide();k.show();C=O.NAVIGATION;at();};c.navigationGroup.hide();k.hide();C=O.DISCLAIMER;r.setAcceptCallback(au);r.show();}function w(at){ap(ai,at,null);c.navigationGroup.show();}function R(){if(A.getDepth()>1){L();}else{if((G.apps.core.ContextManager.getLastContext().getId()==="SEARCH")){L();A.reset(w);G.app.ContextHelper.closeContext();}else{G.app.ContextHelper.closeContext();}}}function y(at,av,au){var ax=at.idPath,aw=ax.length;k.setPath(at.stringPath);if(A.isMasterInFocus()){ap(ai,av,ax[aw-1],at.target);}else{ai.defocus();S.focus();ap(ai,au,ax[aw-2],ax[aw-1]);ap(S,av,ax[aw-1],at.target);if(S.getType()===G.app.MDSUtil.CONTENT_TYPE.ASSETS){T();}else{if(S.getType()!==G.app.MDSUtil.CONTENT_TYPE.HIGHLIGHTS){M.show();}}S.show();}if(A.getFocusPane().getType()===G.app.MDSUtil.CONTENT_TYPE.ASSETS||A.getFocusPane().getType()===G.app.MDSUtil.CONTENT_TYPE.MYCONTENT||A.getFocusPane().getType()===G.app.MDSUtil.CONTENT_TYPE.MYSUBSCRIPTIONS){c.navigationGroup.menuFadeGradientLayer.hide();}if(A.getDepth()>2){u.show();}if(at.navigateToAsset){if(A.isMasterInFocus()){X(ad.getSelectedItem());}else{X(x.getSelectedItem());}}else{c.navigationGroup.show();}}function P(au,at){if(A.isMasterInFocus()){ap(S,at,au.id);if(S.getType()!==G.app.MDSUtil.CONTENT_TYPE.HIGHLIGHTS){M.show();}else{M.hide();}S.show();}}function v(av,at){var au=av.id;k.push(av.title);a();if(A.isMasterInFocus()){if(!ai.isVisible()){D();}u.show();M.hide();S.hide();ap(ai,at,au);}else{ap(S,at,au);if(S.getType()===G.app.MDSUtil.CONTENT_TYPE.ASSETS){T();}else{if(S.getType()!==G.app.MDSUtil.CONTENT_TYPE.HIGHLIGHTS){M.show();}else{M.hide();}}}if(A.getFocusPane().getType()===G.app.MDSUtil.CONTENT_TYPE.ASSETS||A.getFocusPane().getType()===G.app.MDSUtil.CONTENT_TYPE.MYCONTENT||A.getFocusPane().getType()===G.app.MDSUtil.CONTENT_TYPE.MYSUBSCRIPTIONS){c.navigationGroup.menuFadeGradientLayer.hide();}else{c.navigationGroup.menuFadeGradientLayer.show();}if(A.getFocusPane().getType()===G.app.MDSUtil.CONTENT_TYPE.CLUBE){c.nowLogo.hide();k.pop();k.setX(708);c.nowClubeLogo.show();}}function j(aw,ax,av,au,at){k.pop();a();if(A.isMasterInFocus()){if(A.getDepth()<=1){c.nowClubeLogo.hide();k.setX(364.5);c.nowLogo.show();}if(!ai.isVisible()){D();}ap(ai,au,ax,aw);}else{if(A.getDepth()<=2){u.hide();}ap(S,au,ax,aw);ap(ai,at,av,ax);if(S.getType()===G.app.MDSUtil.CONTENT_TYPE.ASSETS){T();}else{if(S.getType()!==G.app.MDSUtil.CONTENT_TYPE.HIGHLIGHTS){M.show();}else{M.hide();}}}if(A.getFocusPane().getType()!==G.app.MDSUtil.CONTENT_TYPE.ASSETS&&A.getFocusPane().getType()!==G.app.MDSUtil.CONTENT_TYPE.MYCONTENT&&A.getFocusPane().getType()!==G.app.MDSUtil.CONTENT_TYPE.MYSUBSCRIPTIONS){c.navigationGroup.menuFadeGradientLayer.show();}else{c.navigationGroup.menuFadeGradientLayer.hide();}}function ae(){c.nowClubeLogo.hide();k.setX(364.5);c.nowLogo.show();r.hide();L();D();c.navigationGroup.hide();c.navigationGroup.menuFadeGradientLayer.show();M.hide();u.hide();S.hide();k.show();k.reset();ai.focus();S.defocus();ai.show();}function Q(au,at){var av=G.apps.core.KeyInterceptor.getKeyMap();if(at===av.KEY_EXIT){G.app.ContextHelper.exitContext();}else{G.app.ContextHelper.closeContext();}}function aa(av,au){var at=[{name:G.app.MDSUtil.getString("retry"),action:function(){if(av){av();}},simpleExit:true},{name:G.app.MDSUtil.getString("cancel")}];au=au||G.app.errorCodes.NOW.MDS_DATA_FAILURE;G.app.DialogueHelper.showNowDialog(Now.getString("noNetworkTitle"),Now.getString("noNetworkText"),at,null,au,Q);}function o(av,at){var au=[{name:G.app.MDSUtil.getString("cancel")}];av=av||G.app.errorCodes.NOW.PLAYBACK_FAILURE;G.app.DialogueHelper.showNowDialog(Now.getString("noTraxisTitle"),Now.getString("noTraxisText"),au,null,av,at);}function d(at){o(at,Q);}function F(at){o(at);}function H(at){G.app.MDSUtil.clearRequest();}function g(at){G.app.MDSUtil.clearRequest();if(at&&at.id){A.previewNext(at,P);}else{if(A.isMasterInFocus()){M.hide();S.hide();}}}function W(au){var at=function(){if(A.isMasterInFocus){g(aq.getSelectedItem());}};G.app.MDSUtil.clearRequest();if(au){if(au.action){au.action();}if(au.id){A.navigateDeeper(au,v,at);}}}function ah(){G.app.ClockDisplay.hide();G.app.ContextHelper.exitContext();}function B(){G.app.DialogueHelper.showNowDialog(Now.getString("attention"),Now.getString("confirmExitMessage"),[{name:Now.getString("yes"),action:G.app.ContextHelper.closeContext},{name:Now.getString("no")}]);}function s(au,at){var av=new G.gui.PageableListWithArrows(document.getElementById("content").ownerDocument);av.configure({itemHeight:87,itemTemplate:G.gui.NowMenuItem,itemSelectedCallback:W,visibleItemCount:7,itemConfig:au,itemHighlightedImmediateCallback:H,dataMapper:G.app.MDSUtil.assetDataMapper});if(at){av.configure(at);}av.initialise();return av;}function am(at){if(G.platform.system.Preferences.get(G.app.constants.PREF_NOW_DISCLAIMER_ACCEPTED)!=="true"){h(at);}else{at();}}function q(at){var au=function(){var aw=at?at.target:null,av=at?at.idPath:null;if(aw||(av&&av.length>0)){if(at.directToAsset===true){A.jumpToContent(at,f);}else{A.jumpToContent(at,y);}}else{A.reset(w);}};c.navigationGroup.hide();G.app.ClockDisplay.show();G.app.BrandHelper.hideAll();ae();G.app.TraxisUtil.favourites.getFavourites();am(au);}function Z(){var au=document.getElementById("content").ownerDocument,at=false;k=c.breadcrumb;I=c.loadingBar;r=c.disclaimer;G.apps.util.EventManager.create("nowFavouriteRemoved");G.apps.dialog.PinDialog.GUITemplateObject=G.gui.NowPinDialog;ao=new G.app.PinHelper(null,null,null,null,0,at);ao.setDialogProperties({x:0,y:0,width:1920,height:1080,id:"now",parentalIconVisible:true});t=new G.app.PinHelper(null,null,null,null,0);t.setDialogProperties({x:0,y:0,width:1920,height:1080,id:"now",parentalIconVisible:false});G.apps.dialog.PinDialog.GUITemplateObject=G.gui.PinDialog;ai=c.navigationGroup.masterPane;S=c.navigationGroup.slavePane;M=c.navigationGroup.menuSeparator;u=c.navigationGroup.navigateBackArrow;p=c.fullAssetInfo;p.configure({dataMapper:G.app.MDSUtil.assetDataMapper,serverFailureCallback:d,assetFailureCallback:F,exitCallback:R});aq=s({width:575});aq.setItemHighlightedCallback(g);Y=s({isMaster:false,width:1120},{x:40});V=new G.gui.NowClube(au);V.setItemSelectedCallback(W);aj=new G.gui.NowHighlights(au);aj.setItemConfig({itemSelectedCallback:function(av){av.activationObject.idPath.splice(0,0,null);q(av.activationObject);}});aj.initialise();ag=f;U=W;ad=new G.gui.NowGallery(au);ad.setItemSelectedCallback(ag);x=new G.gui.NowGallery(au);x.setItemSelectedCallback(ag);n=new G.gui.NowEmptyPane(au);b=new G.gui.NowMyContent(au);b.setItemSelectedCallback(f);z();E=new G.gui.NowMySubscriptions(au);E.setItemSelectedCallback(function(){});an();G.apps.util.EventManager.subscribe("mdsContentLoading",function(av){if(av){I.setText(Now.getString("loading"));}I.setLoading(av.data);},this);}function ar(){var au=G.platform.system.Preferences.get("/network/siconfig/CustomDescriptorTags/netMdsServer",true),at=null,av=function(){if(ac){clearTimeout(ac);}ac=setTimeout(function(){ar();ac=null;},G.app.constants.MINUTE_IN_MS*0.5);};if(G.app.Config.getConfigValue("mds.developer.mode")==="on"){au=G.app.Config.getConfigValue("mds.developer.server");}at=au+G.app.Config.getConfigValue("now.catalogue.override.url");if(at&&G.app.NetworkUtil.isNetworkAvailable()){G.app.NetworkUtil.ajaxRequest(at,function(aw){var ax,ay=[];aw=JSON.parse(aw);for(ax in aw){if(aw.hasOwnProperty(ax)){ay.push(encodeURIComponent(ax));}}G.app.MDSUtil.getNodesByNameArray(ay,function(aC){var aB,aD=aC.length,aA,az={};for(aB=0;aB<aD;aB++){aA=aC[aB];az[aA.id]=aw[aA.title];}A.setSupplementaryCategoryData(az);},av);},av);}}function ak(){G.app.MDSUtil.setDefaultNOWCatalogues([{id:G.app.constants.VOD_MENU_SEARCH,title:Now.getString("textSearch"),Rating:{code:1}},{id:G.app.constants.VOD_MENU_MY_VIDEOS,title:Now.getString("textMyContent"),Rating:{code:1}},{id:G.app.constants.VOD_MENU_EXIT,title:Now.getString("textExit"),action:function(){ah();},Rating:{code:1}}]);G.app.MDSUtil.setMyContentCatalogues([{id:G.app.constants.VOD_MENU_MY_VIDEOS_RENTED,title:Now.getString("textRentals"),Rating:{code:1}},{id:G.app.constants.VOD_MENU_MY_VIDEOS_SUBSCRIPTIONS,title:Now.getString("textSubscriptions"),Rating:{code:1}},{id:G.app.constants.VOD_MENU_MY_VIDEOS_ADULT,title:Now.getString("textAdultContent"),Rating:{code:G.app.ParentalControlUtil.PARENTAL_RATING_ADULT_VALUE}},{id:G.app.constants.VOD_MENU_MY_VIDEOS_FAVORITES,title:Now.getString("textFavourites"),Rating:{code:1}}]);G.app.MDSUtil.setSearchCatalogues([{id:"",title:Now.getString("textSearchByTitle"),action:function(){G.app.ContextHelper.openContext("SEARCH",{activationContext:{isVodSearch:true,searchType:"title",confirmLeftExit:false}});},Rating:{code:1}},{id:"",title:Now.getString("textSearchByActorDir"),action:function(){G.app.ContextHelper.openContext("SEARCH",{activationContext:{isVodSearch:true,searchType:"actors",confirmLeftExit:false}});},Rating:{code:1}}]);}function ab(){G.gui.ResolutionManager.initialiseContext(document);G.apps.core.Language.importLanguageBundleForObject(Now,Now.init,"apps/now/common/","LanguageBundle.js",function(){z();ak();},window);}function al(){G.gui.FrameworkCore.loadGUIFromXML("apps/now/view/now.xml",document.getElementById("content"),c,window);G.services.sdp.MetadataService.setVODSortOrder([["voditem.DisplayPriority",1]]);G.services.sdp.MetadataService.setVODNodeSortOrder([["nodeOrder",1]]);Z();A=G.app.NowNavigation;A.setFailureCallback(aa);A.setErrorDialogKeyHandler(Q);A.initialise(ai,S,ao);N=G.app.NowPlayback;N.setFailureCallback(d);N.initialise(A,t,G.app.DialogueHelper.showNowDialog);ak();ar();G.app.MDSUtil.setDataAugmentFunction(m);G.apps.core.ContextManager.initialisationComplete(Now);}function K(){G.app.MDSUtil.clearRequest();G.app.ClockDisplay.hide();}function l(at){var au=G.apps.core.KeyInterceptor.getKeyMap(),av=false;G.app.MemoryUtil.setOrUpdateGarbageCollectTimeoutAndInterval();switch(C){case O.NAVIGATION:av=A.getFocusPane().keyHandler(at);break;case O.FULL_ASSET_INFO:av=p.keyHandler(at);break;case O.DISCLAIMER:av=r.keyHandler(at);break;}if(!av){switch(at){case au.KEY_LEFT:if(A.getDepth()>1){G.app.MDSUtil.clearRequest();A.navigateBack(j);}else{B();}av=true;break;case au.KEY_BACK:if(A.getDepth()>1){G.app.MDSUtil.clearRequest();A.navigateBack(j);}else{G.app.ContextHelper.closeContext();}av=true;break;case au.KEY_VOD:case au.KEY_VIEW:case au.KEY_EXIT:ah();av=true;break;}}return av;}function e(){return"NOW";}return{load:ab,init:al,activate:q,passivate:K,keyHandler:l,toString:e};}(window.parent.$N));